[2022-06-18 11:09:22,357] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:09:22,380] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:09:22,381] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:09:22,381] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:09:22,381] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:09:22,411] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:09:22,421] {standard_task_runner.py:52} INFO - Started process 199636 to run task
[2022-06-18 11:09:22,427] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1390', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpsqxyqlwr', '--error-file', '/tmp/tmp5an6o4kk']
[2022-06-18 11:09:22,427] {standard_task_runner.py:80} INFO - Job 1390: Subtask load_DMs
[2022-06-18 11:09:22,514] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:09:22,629] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:09:22,700] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 11:09:22,726] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T140922, end_date=20220618T140922
[2022-06-18 11:09:22,758] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 11:09:22,818] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 11:34:06,268] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:34:06,288] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:34:06,288] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:34:06,289] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:34:06,289] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:34:06,311] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:34:06,324] {standard_task_runner.py:52} INFO - Started process 208419 to run task
[2022-06-18 11:34:06,330] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '26', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmprbrbnpm2', '--error-file', '/tmp/tmpmdihfuyp']
[2022-06-18 11:34:06,330] {standard_task_runner.py:80} INFO - Job 26: Subtask load_DMs
[2022-06-18 11:34:06,410] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:34:06,523] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:34:06,591] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 11:34:06,614] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T143406, end_date=20220618T143406
[2022-06-18 11:34:06,661] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 11:34:06,744] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 11:42:00,712] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:42:00,733] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:42:00,733] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:42:00,733] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:42:00,733] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:42:00,753] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:42:00,765] {standard_task_runner.py:52} INFO - Started process 211946 to run task
[2022-06-18 11:42:00,770] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '44', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmptuv4bopv', '--error-file', '/tmp/tmpv9sgcqu1']
[2022-06-18 11:42:00,771] {standard_task_runner.py:80} INFO - Job 44: Subtask load_DMs
[2022-06-18 11:42:00,861] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:42:00,992] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:42:01,010] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "stg_customers" does not exist
LINE 1: select * from stg_customers
                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 96, in load_DMs
    df_cost = pd.read_sql_query("select * from stg_customers", con=engine)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "stg_customers" does not exist
LINE 1: select * from stg_customers
                      ^

[SQL: select * from stg_customers]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-18 11:42:01,032] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T144200, end_date=20220618T144201
[2022-06-18 11:42:01,054] {standard_task_runner.py:92} ERROR - Failed to execute job 44 for task load_DMs ((psycopg2.errors.UndefinedTable) relation "stg_customers" does not exist
LINE 1: select * from stg_customers
                      ^

[SQL: select * from stg_customers]
(Background on this error at: http://sqlalche.me/e/14/f405); 211946)
[2022-06-18 11:42:01,102] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 11:42:01,155] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 11:45:25,509] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:45:25,530] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:45:25,531] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:45:25,531] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:45:25,531] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:45:25,559] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:45:25,573] {standard_task_runner.py:52} INFO - Started process 213768 to run task
[2022-06-18 11:45:25,578] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '59', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp4xgqoykb', '--error-file', '/tmp/tmph_pgc6yb']
[2022-06-18 11:45:25,579] {standard_task_runner.py:80} INFO - Job 59: Subtask load_DMs
[2022-06-18 11:45:25,662] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:45:25,779] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:45:25,795] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedTable: relation "stg_customers" does not exist
LINE 1: select * from Stg_customers
                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 96, in load_DMs
    df_cost = pd.read_sql_query("select * from Stg_customers", con=engine)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedTable) relation "stg_customers" does not exist
LINE 1: select * from Stg_customers
                      ^

[SQL: select * from Stg_customers]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-18 11:45:25,815] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T144525, end_date=20220618T144525
[2022-06-18 11:45:25,835] {standard_task_runner.py:92} ERROR - Failed to execute job 59 for task load_DMs ((psycopg2.errors.UndefinedTable) relation "stg_customers" does not exist
LINE 1: select * from Stg_customers
                      ^

[SQL: select * from Stg_customers]
(Background on this error at: http://sqlalche.me/e/14/f405); 213768)
[2022-06-18 11:45:25,873] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 11:45:25,951] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 11:58:01,092] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:58:01,104] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:58:01,105] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:58:01,105] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:58:01,105] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:58:01,118] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:58:01,126] {standard_task_runner.py:52} INFO - Started process 219543 to run task
[2022-06-18 11:58:01,129] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '91', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpc8hvspv8', '--error-file', '/tmp/tmp9q20klru']
[2022-06-18 11:58:01,130] {standard_task_runner.py:80} INFO - Job 91: Subtask load_DMs
[2022-06-18 11:58:01,199] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:58:01,285] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:58:01,366] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 11:58:01,387] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T145801, end_date=20220618T145801
[2022-06-18 11:58:01,421] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 11:58:01,473] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 12:19:20,794] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 12:19:20,805] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 12:19:20,805] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 12:19:20,805] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 12:19:20,805] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 12:19:20,817] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 12:19:20,823] {standard_task_runner.py:52} INFO - Started process 227891 to run task
[2022-06-18 12:19:20,827] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1422', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmplm2zbad7', '--error-file', '/tmp/tmp46dto0ms']
[2022-06-18 12:19:20,828] {standard_task_runner.py:80} INFO - Job 1422: Subtask load_DMs
[2022-06-18 12:19:20,900] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 12:19:20,991] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 12:19:21,060] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 12:19:21,081] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T151920, end_date=20220618T151921
[2022-06-18 12:19:21,118] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 12:19:21,168] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:00:03,144] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:00:03,167] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:00:03,167] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:00:03,167] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:00:03,168] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:00:03,191] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:00:03,200] {standard_task_runner.py:52} INFO - Started process 9181 to run task
[2022-06-18 13:00:03,207] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1438', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpqtb3zgco', '--error-file', '/tmp/tmpjh59pjt2']
[2022-06-18 13:00:03,207] {standard_task_runner.py:80} INFO - Job 1438: Subtask load_DMs
[2022-06-18 13:00:03,296] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:00:03,412] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:00:03,480] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "lastname" of relation "DM_Products" does not exist
LINE 1: INSERT INTO "DM_Products" (lastname, firstname, email, jobti...
                                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 106, in load_DMs
    df_prod.to_sql('DM_Products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "lastname" of relation "DM_Products" does not exist
LINE 1: INSERT INTO "DM_Products" (lastname, firstname, email, jobti...
                                   ^

[SQL: INSERT INTO "DM_Products" (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Thompson', 'firstname': 'Leslie', 'email': 'lthompson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Fixter', 'firstname': 'Andy', 'email': 'afixter@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bott', 'firstname': 'Larry', 'email': 'lbott@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Castillo', 'firstname': 'Pamela', 'email': 'pcastillo@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Marsh', 'firstname': 'Peter', 'email': 'pmarsh@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'Steve', 'email': 'spatterson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-18 13:00:03,508] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T160003, end_date=20220618T160003
[2022-06-18 13:00:03,530] {standard_task_runner.py:92} ERROR - Failed to execute job 1438 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "lastname" of relation "DM_Products" does not exist
LINE 1: INSERT INTO "DM_Products" (lastname, firstname, email, jobti...
                                   ^

[SQL: INSERT INTO "DM_Products" (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Thompson', 'firstname': 'Leslie', 'email': 'lthompson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Fixter', 'firstname': 'Andy', 'email': 'afixter@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bott', 'firstname': 'Larry', 'email': 'lbott@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Castillo', 'firstname': 'Pamela', 'email': 'pcastillo@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Marsh', 'firstname': 'Peter', 'email': 'pmarsh@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'Steve', 'email': 'spatterson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'})]
(Background on this error at: http://sqlalche.me/e/14/f405); 9181)
[2022-06-18 13:00:03,577] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:00:03,657] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:02:37,848] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:02:37,868] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:02:37,868] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:02:37,868] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:02:37,868] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:02:37,891] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:02:37,902] {standard_task_runner.py:52} INFO - Started process 10896 to run task
[2022-06-18 13:02:37,908] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1453', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp7wyylmas', '--error-file', '/tmp/tmp7668srjj']
[2022-06-18 13:02:37,909] {standard_task_runner.py:80} INFO - Job 1453: Subtask load_DMs
[2022-06-18 13:02:37,988] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:02:38,106] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:02:38,167] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "lastname" of relation "DM_Products" does not exist
LINE 1: INSERT INTO "DM_Products" (lastname, firstname, email, jobti...
                                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 106, in load_DMs
    df_prod.to_sql('DM_Products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "lastname" of relation "DM_Products" does not exist
LINE 1: INSERT INTO "DM_Products" (lastname, firstname, email, jobti...
                                   ^

[SQL: INSERT INTO "DM_Products" (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Thompson', 'firstname': 'Leslie', 'email': 'lthompson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Fixter', 'firstname': 'Andy', 'email': 'afixter@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bott', 'firstname': 'Larry', 'email': 'lbott@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Castillo', 'firstname': 'Pamela', 'email': 'pcastillo@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Marsh', 'firstname': 'Peter', 'email': 'pmarsh@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'Steve', 'email': 'spatterson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-18 13:02:38,189] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T160237, end_date=20220618T160238
[2022-06-18 13:02:38,209] {standard_task_runner.py:92} ERROR - Failed to execute job 1453 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "lastname" of relation "DM_Products" does not exist
LINE 1: INSERT INTO "DM_Products" (lastname, firstname, email, jobti...
                                   ^

[SQL: INSERT INTO "DM_Products" (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Thompson', 'firstname': 'Leslie', 'email': 'lthompson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Fixter', 'firstname': 'Andy', 'email': 'afixter@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bott', 'firstname': 'Larry', 'email': 'lbott@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Castillo', 'firstname': 'Pamela', 'email': 'pcastillo@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Marsh', 'firstname': 'Peter', 'email': 'pmarsh@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'Steve', 'email': 'spatterson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'})]
(Background on this error at: http://sqlalche.me/e/14/f405); 10896)
[2022-06-18 13:02:38,241] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:02:38,311] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:13:49,675] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:13:49,697] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:13:49,698] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:13:49,698] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:13:49,698] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:13:49,722] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:13:49,734] {standard_task_runner.py:52} INFO - Started process 14129 to run task
[2022-06-18 13:13:49,741] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1470', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpp3agsr5t', '--error-file', '/tmp/tmp49z9e0f_']
[2022-06-18 13:13:49,741] {standard_task_runner.py:80} INFO - Job 1470: Subtask load_DMs
[2022-06-18 13:13:49,828] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:13:49,965] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:13:50,049] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 13:13:50,077] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T161349, end_date=20220618T161350
[2022-06-18 13:13:50,151] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 13:13:50,218] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:22:29,118] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:22:29,142] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:22:29,142] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:22:29,142] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:22:29,143] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:22:29,168] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:22:29,179] {standard_task_runner.py:52} INFO - Started process 17025 to run task
[2022-06-18 13:22:29,185] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1487', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp8dtz9tqg', '--error-file', '/tmp/tmpltbsobyh']
[2022-06-18 13:22:29,186] {standard_task_runner.py:80} INFO - Job 1487: Subtask load_DMs
[2022-06-18 13:22:29,271] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:22:29,388] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:22:29,445] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:22:29,469] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T162229, end_date=20220618T162229
[2022-06-18 13:22:29,488] {standard_task_runner.py:92} ERROR - Failed to execute job 1487 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 17025)
[2022-06-18 13:22:29,517] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:22:29,595] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:24:23,037] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:24:23,058] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:24:23,059] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:24:23,059] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:24:23,059] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:24:23,080] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:24:23,091] {standard_task_runner.py:52} INFO - Started process 18852 to run task
[2022-06-18 13:24:23,097] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1502', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp_6d1xm_e', '--error-file', '/tmp/tmpcbkqavlu']
[2022-06-18 13:24:23,098] {standard_task_runner.py:80} INFO - Job 1502: Subtask load_DMs
[2022-06-18 13:24:23,185] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:24:23,299] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:24:23,351] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:24:23,374] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T162423, end_date=20220618T162423
[2022-06-18 13:24:23,395] {standard_task_runner.py:92} ERROR - Failed to execute job 1502 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 18852)
[2022-06-18 13:24:23,429] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:24:23,501] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:28:26,250] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:28:26,272] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:28:26,272] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:28:26,272] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:28:26,272] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:28:26,294] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:28:26,305] {standard_task_runner.py:52} INFO - Started process 21381 to run task
[2022-06-18 13:28:26,311] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1518', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp4gopocqm', '--error-file', '/tmp/tmpqy7j7gpu']
[2022-06-18 13:28:26,312] {standard_task_runner.py:80} INFO - Job 1518: Subtask load_DMs
[2022-06-18 13:28:26,401] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:28:26,523] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:28:26,582] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:28:26,604] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T162826, end_date=20220618T162826
[2022-06-18 13:28:26,628] {standard_task_runner.py:92} ERROR - Failed to execute job 1518 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 21381)
[2022-06-18 13:28:26,644] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:28:26,712] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:33:00,371] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:33:00,395] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:33:00,396] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:33:00,396] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:33:00,396] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:33:00,419] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:33:00,432] {standard_task_runner.py:52} INFO - Started process 23829 to run task
[2022-06-18 13:33:00,437] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1533', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpaa5adlpw', '--error-file', '/tmp/tmp3zxe_kbg']
[2022-06-18 13:33:00,438] {standard_task_runner.py:80} INFO - Job 1533: Subtask load_DMs
[2022-06-18 13:33:00,519] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:33:00,630] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:33:00,683] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:33:00,707] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T163300, end_date=20220618T163300
[2022-06-18 13:33:00,726] {standard_task_runner.py:92} ERROR - Failed to execute job 1533 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 23829)
[2022-06-18 13:33:00,769] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:33:00,843] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:40:06,020] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:40:06,047] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:40:06,047] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:40:06,047] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:40:06,047] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:40:06,070] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:40:06,082] {standard_task_runner.py:52} INFO - Started process 27402 to run task
[2022-06-18 13:40:06,088] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1549', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmptmrztdyn', '--error-file', '/tmp/tmpku54w26c']
[2022-06-18 13:40:06,088] {standard_task_runner.py:80} INFO - Job 1549: Subtask load_DMs
[2022-06-18 13:40:06,169] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:40:06,293] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:40:06,346] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:40:06,372] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T164006, end_date=20220618T164006
[2022-06-18 13:40:06,394] {standard_task_runner.py:92} ERROR - Failed to execute job 1549 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 27402)
[2022-06-18 13:40:06,419] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:40:06,484] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:42:02,012] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:42:02,035] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:42:02,036] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:42:02,036] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:42:02,036] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:42:02,059] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:42:02,072] {standard_task_runner.py:52} INFO - Started process 29216 to run task
[2022-06-18 13:42:02,079] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1564', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpkx754bzh', '--error-file', '/tmp/tmp1ooa6djp']
[2022-06-18 13:42:02,080] {standard_task_runner.py:80} INFO - Job 1564: Subtask load_DMs
[2022-06-18 13:42:02,166] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:42:02,285] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:42:02,339] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:42:02,361] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T164202, end_date=20220618T164202
[2022-06-18 13:42:02,381] {standard_task_runner.py:92} ERROR - Failed to execute job 1564 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 29216)
[2022-06-18 13:42:02,411] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:42:02,481] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:43:40,321] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:43:40,342] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:43:40,342] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:43:40,342] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:43:40,342] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:43:40,364] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:43:40,377] {standard_task_runner.py:52} INFO - Started process 30887 to run task
[2022-06-18 13:43:40,383] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1579', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp8hrukqoy', '--error-file', '/tmp/tmpan227ak1']
[2022-06-18 13:43:40,384] {standard_task_runner.py:80} INFO - Job 1579: Subtask load_DMs
[2022-06-18 13:43:40,470] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:43:40,584] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:43:40,643] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 105, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:43:40,669] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T164340, end_date=20220618T164340
[2022-06-18 13:43:40,689] {standard_task_runner.py:92} ERROR - Failed to execute job 1579 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 30887)
[2022-06-18 13:43:40,715] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:43:40,781] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:46:32,250] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:46:32,269] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:46:32,270] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:46:32,270] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:46:32,270] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:46:32,294] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:46:32,304] {standard_task_runner.py:52} INFO - Started process 32475 to run task
[2022-06-18 13:46:32,309] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1594', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp18coukee', '--error-file', '/tmp/tmpt84ha3r7']
[2022-06-18 13:46:32,310] {standard_task_runner.py:80} INFO - Job 1594: Subtask load_DMs
[2022-06-18 13:46:32,392] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:46:32,503] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:46:32,557] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 111, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:46:32,580] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T164632, end_date=20220618T164632
[2022-06-18 13:46:32,598] {standard_task_runner.py:92} ERROR - Failed to execute job 1594 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 32475)
[2022-06-18 13:46:32,642] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:46:32,717] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:52:09,603] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:52:09,624] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:52:09,624] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:52:09,624] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:52:09,624] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:52:09,645] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:52:09,658] {standard_task_runner.py:52} INFO - Started process 34528 to run task
[2022-06-18 13:52:09,663] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1609', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp4kxr9mcd', '--error-file', '/tmp/tmp0vb1_xuc']
[2022-06-18 13:52:09,664] {standard_task_runner.py:80} INFO - Job 1609: Subtask load_DMs
[2022-06-18 13:52:09,748] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:52:09,865] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:52:09,897] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 111, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
NameError: name 'df_cost' is not defined
[2022-06-18 13:52:09,915] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T165209, end_date=20220618T165209
[2022-06-18 13:52:09,936] {standard_task_runner.py:92} ERROR - Failed to execute job 1609 for task load_DMs (name 'df_cost' is not defined; 34528)
[2022-06-18 13:52:09,955] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:52:10,024] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:56:35,889] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:56:35,911] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:56:35,911] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:56:35,911] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:56:35,911] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:56:35,934] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:56:35,946] {standard_task_runner.py:52} INFO - Started process 36961 to run task
[2022-06-18 13:56:35,951] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1625', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpo1vctd8g', '--error-file', '/tmp/tmp6urpgge5']
[2022-06-18 13:56:35,952] {standard_task_runner.py:80} INFO - Job 1625: Subtask load_DMs
[2022-06-18 13:56:36,043] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:56:36,160] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:56:36,221] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 111, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 13:56:36,246] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T165635, end_date=20220618T165636
[2022-06-18 13:56:36,266] {standard_task_runner.py:92} ERROR - Failed to execute job 1625 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 36961)
[2022-06-18 13:56:36,283] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:56:36,351] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:03:05,092] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:03:05,113] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:03:05,113] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:03:05,113] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:03:05,113] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:03:05,133] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:03:05,142] {standard_task_runner.py:52} INFO - Started process 41404 to run task
[2022-06-18 14:03:05,148] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '31', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpc43e4aqc', '--error-file', '/tmp/tmpl4z6fd7f']
[2022-06-18 14:03:05,148] {standard_task_runner.py:80} INFO - Job 31: Subtask load_DMs
[2022-06-18 14:03:05,241] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:03:05,358] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:03:05,417] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 111, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 14:03:05,444] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T170305, end_date=20220618T170305
[2022-06-18 14:03:05,464] {standard_task_runner.py:92} ERROR - Failed to execute job 31 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 41404)
[2022-06-18 14:03:05,519] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 14:03:05,595] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:19:15,621] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:19:15,660] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:19:15,660] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:19:15,660] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:19:15,660] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:19:15,702] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:19:15,718] {standard_task_runner.py:52} INFO - Started process 46911 to run task
[2022-06-18 14:19:15,728] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '23', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpt3rr4rh_', '--error-file', '/tmp/tmp2mm4v0i0']
[2022-06-18 14:19:15,729] {standard_task_runner.py:80} INFO - Job 23: Subtask load_DMs
[2022-06-18 14:19:15,837] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:19:15,970] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:19:16,025] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 111, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 14:19:16,048] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T171915, end_date=20220618T171916
[2022-06-18 14:19:16,071] {standard_task_runner.py:92} ERROR - Failed to execute job 23 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 46911)
[2022-06-18 14:19:16,099] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 14:19:16,175] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:22:51,185] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:22:51,208] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:22:51,208] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:22:51,209] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:22:51,209] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:22:51,249] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:22:51,263] {standard_task_runner.py:52} INFO - Started process 48740 to run task
[2022-06-18 14:22:51,269] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '38', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp43_8kryw', '--error-file', '/tmp/tmpr6z_058t']
[2022-06-18 14:22:51,270] {standard_task_runner.py:80} INFO - Job 38: Subtask load_DMs
[2022-06-18 14:22:51,383] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:22:51,500] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:22:51,537] {python.py:173} INFO - Done. Returned value was: (                         customername contactlastname contactfirstname             phone  ...          state postalcode       country creditlimit
0             Tekni Collectables Inc.           Brown          William        2015559350  ...             NJ      94019           USA     43000.0
1      Canadian Gift Exchange Network          Tamuri           Yoshi     (604) 555-3392  ...             BC    V3F 2K1        Canada     90300.0
2                Osaka Souveniers Co.         Kentary             Mory  +81 06 6342 5555  ...          Osaka   530-0003         Japan     81200.0
3                Classic Legends Inc.       Hernandez            Maria        2125558493  ...             NY      10022           USA     67500.0
4                   Land of Toys Inc.             Lee             Kwai        2125557818  ...             NY      10022           USA    114900.0
5              American Souvenirs Inc          Franco            Keith        2035557845  ...             CT      97823           USA         0.0
6            Men R US Retailers, Ltd.        Chandler            Brian        2155554369  ...             CA      91003           USA     57700.0
7               Diecast Classics Inc.           Leong           Kelvin        2155551555  ...             PA      70267           USA    100600.0
8        Online Diecast Creations Co.           Young          Dorothy        6035558647  ...             NH      62005           USA    114200.0
9            Signal Collectibles Ltd.          Taylor              Sue        4155554312  ...             CA      94217           USA     60300.0
10          Souveniers And Things Co.          Huxley           Adrian   +61 2 9495 8555  ...            NSW       2067     Australia     93300.0
11         Cambridge Collectables Co.           Tseng            Jerry        6175555555  ...             MA      51247           USA     43400.0
12       Motor Mint Distributors Inc.         Salazar             Rosa        2155559857  ...             PA      71270           USA     72600.0
13                   Gift Ideas Corp.           Lewis              Dan        2035554407  ...             CT      97561           USA     49700.0
14                    Gift Depot Inc.            King            Julie        2035552570  ...             CT      97562           USA     84300.0
15                    Microscale Inc.            Choi               Yu        2125551957  ...             NY      10022           USA     39800.0
16                    Vitachrome Inc.           Frick          Michael        2125551500  ...             NY      10022           USA     76400.0
17             Annas Decorations, Ltd           OHara             Anna      02 9936 8555  ...            NSW       2060     Australia    107800.0
18       Collectable Mini Designs Co.        Thompson          Valarie        7605558146  ...             CA      91217           USA    105000.0
19                 Muscle Machine Inc           Young             Jeff        2125557413  ...             NY      10022           USA    138500.0
20                  giftsbymail.co.uk         Bennett           Helen     (198) 555-8888  ...  Isle of Wight   PO31 7PJ            UK     93900.0
21               Technics Stores Inc.       Hashimoto             Juri        6505556809  ...             CA      94217           USA     84600.0
22       Australian Collectables, Ltd        Clenahan             Sean    61-9-3844-6555  ...       Victoria       3150     Australia     60300.0
23           Corporate Gift Ideas Co.           Brown            Julie        6505551386  ...             CA      94217           USA    105000.0
24                  Boards & Toys Co.           Young             Mary        3105552373  ...             CA      92561           USA     11000.0
25            Tokyo Collectables, Ltd       Shimamura            Akiko   +81 3 3584 0555  ...          Tokyo   106-0032         Japan     94400.0
26                    Mini Wheels Co.          Murphy            Julie        6505555787  ...             CA      94217           USA     64600.0
27                   FunGiftIdeas.com         Benitez          Violeta        5085552555  ...             MA      50553           USA     85800.0
28                   Super Scale Inc.          Murphy           Leslie        2035559545  ...             CT      97823           USA     95400.0
29           Online Mini Collectables         Barajas           Miguel        6175557555  ...             MA      58339           USA     68700.0
30            Classic Gift Ideas, Inc       Cervantes        Francisca        2155554695  ...             PA      71270           USA     81100.0
31          The Sharp Gifts Warehouse           Frick              Sue        4085553659  ...             CA      94217           USA     77600.0
32        Australian Gift Network, Co        Calaghan              Ben    61-7-3844-6555  ...     Queensland       4101     Australia     51600.0
33                Mini Creations Ltd.           Huang             Wing        5085559555  ...             MA      50553           USA     94500.0
34  Royal Canadian Collectables, Ltd.         Lincoln       Elizabeth     (604) 555-4555  ...             BC    T2F 8M4        Canada     89600.0
35                Martas Replicas Co.       Hernandez            Marta        6175558555  ...             MA      51247           USA    123700.0
36         Collectables For Less Inc.          Nelson            Allen        6175558555  ...             MA      58339           USA     70700.0
37       Québec Home Shopping Network       Fresnière            Jean     (514) 555-8054  ...         Québec    H1J 1C3        Canada     48700.0
38                 Signal Gift Stores            King             Jean        7025551838  ...             NV      83030           USA     71800.0
39                  Toys4GrownUps.com           Young            Julie        6265557265  ...             CA      90003           USA     90700.0
40         Australian Collectors, Co.        Ferguson            Peter      03 9520 4555  ...       Victoria       3004     Australia    117300.0
41               SAR Distributors, Co           Kuger           Armand   +27 21 550 3555  ...       Pretoria       0028  South Africa         0.0
42                  Gifts4AllAges.com         Yoshido             Juri        6175559555  ...             MA      51003           USA     41900.0
43       Mini Gifts Distributors Ltd.          Nelson            Susan        4155551450  ...             CA      97562           USA    210500.0
44                      Mini Classics           Frick            Steve        9145554562  ...             NY      24067           USA    102700.0
45        West Coast Collectables Co.        Thompson            Steve        3105553722  ...             CA      94019           USA     55400.0
46               Diecast Collectables          Franco          Valarie        6175552555  ...             MA      51003           USA     85100.0
47            Auto-Moto Classics Inc.          Taylor           Leslie        6175558428  ...             MA      58339           USA     23000.0

[48 rows x 10 columns],      lastname firstname                            email              jobtitle
0    Thompson    Leslie   lthompson@classicmodelcars.com             Sales Rep
1      Fixter      Andy     afixter@classicmodelcars.com             Sales Rep
2        Bott     Larry       lbott@classicmodelcars.com             Sales Rep
3    Castillo    Pamela   pcastillo@classicmodelcars.com             Sales Rep
4        King       Tom       tking@classicmodelcars.com             Sales Rep
5       Marsh     Peter      pmarsh@classicmodelcars.com             Sales Rep
6   Patterson     Steve  spatterson@classicmodelcars.com             Sales Rep
7         Bow   Anthony        abow@classicmodelcars.com    Sales Manager (NA)
8       Tseng  Foon Yue      ftseng@classicmodelcars.com             Sales Rep
9      Bondur      Loui     lbondur@classicmodelcars.com             Sales Rep
10  Hernandez    Gerard   ghernande@classicmodelcars.com             Sales Rep
11  Patterson      Mary   mpatterso@classicmodelcars.com              VP Sales
12      Jones     Barry      bjones@classicmodelcars.com             Sales Rep
13      Nishi      Mami      mnishi@classicmodelcars.com             Sales Rep
14  Patterson   William  wpatterson@classicmodelcars.com  Sales Manager (APAC)
15   Jennings    Leslie   ljennings@classicmodelcars.com             Sales Rep
16     Gerard    Martin     mgerard@classicmodelcars.com             Sales Rep
17     Bondur    Gerard     gbondur@classicmodelcars.com   Sale Manager (EMEA)
18   Firrelli      Jeff   jfirrelli@classicmodelcars.com          VP Marketing
19     Vanauf    George     gvanauf@classicmodelcars.com             Sales Rep
20   Firrelli     Julie   jfirrelli@classicmodelcars.com             Sales Rep
21     Murphy     Diane     dmurphy@classicmodelcars.com             President
22       Kato   Yoshimi       ykato@classicmodelcars.com             Sales Rep,                                productname       productline              productvendor                                 productdescription
0                   1964 Mercedes Tour Bus  Trucks and Buses       Unimax Art Galleries  Exact replica. 100+ parts. working steering sy...
1                    1976 Ford Gran Torino      Classic Cars       Gearbox Collectibles  Highly detailed 1976 Ford Gran Torino \"Starsk...
2    1950s Chicago Surface Lines Streetcar            Trains       Gearbox Collectibles  This streetcar is a joy to see. It has 80 sepa...
3                1957 Corvette Convertible      Classic Cars    Classic Metal Creations  1957 die cast Corvette Convertible in Roman Re...
4                          1993 Mazda RX-7      Classic Cars   Highway 66 Mini Classics  This model features, opening hood, opening doo...
..                                     ...               ...                        ...                                                ...
105                      2001 Ferrari Enzo      Classic Cars        Second Gear Diecast  Turnable front wheels; steering function; deta...
106            1992 Ferrari 360 Spider red      Classic Cars       Unimax Art Galleries  his replica features opening doors, superb det...
107                       1995 Honda Civic      Classic Cars            Min Lin Diecast  This model features, opening hood, opening doo...
108                         1958 Setra Bus  Trucks and Buses  Welly Diecast Productions  Model features 30 windows, skylights & glare r...
109   2003 Harley-Davidson Eagle Drag Bike       Motorcycles          Red Start Diecast  Model features, official Harley Davidson logos...

[110 rows x 4 columns],       orderdate requireddate shippeddate
0    2003-11-06   2003-11-15  2003-11-10
1    2003-11-20   2003-11-29  2003-11-25
2    2005-05-09   2005-05-20  2005-05-12
3    2004-08-20   2004-08-26  2004-08-22
4    2004-05-26   2004-06-04  2004-05-29
..          ...          ...         ...
304  2004-05-04   2004-05-12  2004-05-09
305  2004-07-23   2004-08-02  2004-07-29
306  2004-12-16   2004-12-22  2004-12-18
307  2004-02-20   2004-02-29  2004-02-24
308  2003-06-03   2003-06-09  2003-06-06

[309 rows x 3 columns])
[2022-06-18 14:22:51,637] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T172251, end_date=20220618T172251
[2022-06-18 14:22:51,682] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 14:22:51,745] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:29:13,621] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:29:13,642] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:29:13,642] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:29:13,642] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:29:13,642] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:29:13,662] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:29:13,671] {standard_task_runner.py:52} INFO - Started process 50927 to run task
[2022-06-18 14:29:13,676] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '55', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpxqcgkzh9', '--error-file', '/tmp/tmpiv2jmoop']
[2022-06-18 14:29:13,677] {standard_task_runner.py:80} INFO - Job 55: Subtask load_DMs
[2022-06-18 14:29:13,764] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:29:13,880] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:29:13,955] {logging_mixin.py:115} INFO -      lastname firstname extension                            email              jobtitle
0    Thompson    Leslie     x4065   lthompson@classicmodelcars.com             Sales Rep
1      Fixter      Andy      x101     afixter@classicmodelcars.com             Sales Rep
2        Bott     Larry     x2311       lbott@classicmodelcars.com             Sales Rep
3    Castillo    Pamela     x2759   pcastillo@classicmodelcars.com             Sales Rep
4        King       Tom      x103       tking@classicmodelcars.com             Sales Rep
5       Marsh     Peter      x102      pmarsh@classicmodelcars.com             Sales Rep
6   Patterson     Steve     x4334  spatterson@classicmodelcars.com             Sales Rep
7         Bow   Anthony     x5428        abow@classicmodelcars.com    Sales Manager (NA)
8       Tseng  Foon Yue     x2248      ftseng@classicmodelcars.com             Sales Rep
9      Bondur      Loui     x6493     lbondur@classicmodelcars.com             Sales Rep
10  Hernandez    Gerard     x2028   ghernande@classicmodelcars.com             Sales Rep
11  Patterson      Mary     x4611   mpatterso@classicmodelcars.com              VP Sales
12      Jones     Barry      x102      bjones@classicmodelcars.com             Sales Rep
13      Nishi      Mami      x101      mnishi@classicmodelcars.com             Sales Rep
14  Patterson   William     x4871  wpatterson@classicmodelcars.com  Sales Manager (APAC)
15   Jennings    Leslie     x3291   ljennings@classicmodelcars.com             Sales Rep
16     Gerard    Martin     x2312     mgerard@classicmodelcars.com             Sales Rep
17     Bondur    Gerard     x5408     gbondur@classicmodelcars.com   Sale Manager (EMEA)
18   Firrelli      Jeff     x9273   jfirrelli@classicmodelcars.com          VP Marketing
19     Vanauf    George     x4102     gvanauf@classicmodelcars.com             Sales Rep
20   Firrelli     Julie     x2173   jfirrelli@classicmodelcars.com             Sales Rep
21     Murphy     Diane     x5800     dmurphy@classicmodelcars.com             President
22       Kato   Yoshimi      x102       ykato@classicmodelcars.com             Sales Rep
[2022-06-18 14:29:14,032] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(30)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 122, in load_DMS
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-18 14:29:14,055] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T172913, end_date=20220618T172914
[2022-06-18 14:29:14,076] {standard_task_runner.py:92} ERROR - Failed to execute job 55 for task load_DMs ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(30)

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Tekni Collectables Inc.', 'contactlastname': 'Brown', 'contactfirstname': 'William', 'phone': '2015559350', 'addressline1': '7476 Moss Rd.', 'city': 'Newark', 'state': 'NJ', 'postalcode': '94019', 'country': 'USA', 'creditlimit': 43000.0}, {'customername': 'Canadian Gift Exchange Network', 'contactlastname': 'Tamuri', 'contactfirstname': 'Yoshi ', 'phone': '(604) 555-3392', 'addressline1': '1900 Oak St.', 'city': 'Vancouver', 'state': 'BC', 'postalcode': 'V3F 2K1', 'country': 'Canada', 'creditlimit': 90300.0}, {'customername': 'Osaka Souveniers Co.', 'contactlastname': 'Kentary', 'contactfirstname': 'Mory', 'phone': '+81 06 6342 5555', 'addressline1': '1-6-20 Dojima', 'city': 'Kita-ku', 'state': 'Osaka', 'postalcode': ' 530-0003', 'country': 'Japan', 'creditlimit': 81200.0}, {'customername': 'Classic Legends Inc.', 'contactlastname': 'Hernandez', 'contactfirstname': 'Maria', 'phone': '2125558493', 'addressline1': '5905 Pompton St.', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 67500.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'American Souvenirs Inc', 'contactlastname': 'Franco', 'contactfirstname': 'Keith', 'phone': '2035557845', 'addressline1': '149 Spinnaker Dr.', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 0.0}, {'customername': 'Men R US Retailers, Ltd.', 'contactlastname': 'Chandler', 'contactfirstname': 'Brian', 'phone': '2155554369', 'addressline1': '6047 Douglas Av.', 'city': 'Los Angeles', 'state': 'CA', 'postalcode': '91003', 'country': 'USA', 'creditlimit': 57700.0}, {'customername': 'Diecast Classics Inc.', 'contactlastname': 'Leong', 'contactfirstname': 'Kelvin', 'phone': '2155551555', 'addressline1': '7586 Pompton St.', 'city': 'Allentown', 'state': 'PA', 'postalcode': '70267', 'country': 'USA', 'creditlimit': 100600.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 50927)
[2022-06-18 14:29:14,128] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 14:29:14,201] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:46:17,432] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:46:17,457] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:46:17,457] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:46:17,458] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:46:17,458] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:46:17,481] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:46:17,494] {standard_task_runner.py:52} INFO - Started process 54903 to run task
[2022-06-18 14:46:17,500] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '72', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpnvkp0w4v', '--error-file', '/tmp/tmpq6e3sn18']
[2022-06-18 14:46:17,500] {standard_task_runner.py:80} INFO - Job 72: Subtask load_DMs
[2022-06-18 14:46:17,592] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:46:17,718] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:46:17,781] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "lastname" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (lastname, firstname, email, jobtitl...
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 123, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "lastname" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (lastname, firstname, email, jobtitl...
                                 ^

[SQL: INSERT INTO dm_products (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Thompson', 'firstname': 'Leslie', 'email': 'lthompson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Fixter', 'firstname': 'Andy', 'email': 'afixter@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bott', 'firstname': 'Larry', 'email': 'lbott@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Castillo', 'firstname': 'Pamela', 'email': 'pcastillo@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Marsh', 'firstname': 'Peter', 'email': 'pmarsh@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'Steve', 'email': 'spatterson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-18 14:46:17,802] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T174617, end_date=20220618T174617
[2022-06-18 14:46:17,821] {standard_task_runner.py:92} ERROR - Failed to execute job 72 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "lastname" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (lastname, firstname, email, jobtitl...
                                 ^

[SQL: INSERT INTO dm_products (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Thompson', 'firstname': 'Leslie', 'email': 'lthompson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Fixter', 'firstname': 'Andy', 'email': 'afixter@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bott', 'firstname': 'Larry', 'email': 'lbott@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Castillo', 'firstname': 'Pamela', 'email': 'pcastillo@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Marsh', 'firstname': 'Peter', 'email': 'pmarsh@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'Steve', 'email': 'spatterson@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'})]
(Background on this error at: http://sqlalche.me/e/14/f405); 54903)
[2022-06-18 14:46:17,873] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 14:46:17,950] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:53:20,739] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:53:20,759] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:53:20,759] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:53:20,759] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:53:20,759] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:53:20,781] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:53:20,791] {standard_task_runner.py:52} INFO - Started process 59131 to run task
[2022-06-18 14:53:20,797] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '101', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpfa439r44', '--error-file', '/tmp/tmpo9vmmsda']
[2022-06-18 14:53:20,798] {standard_task_runner.py:80} INFO - Job 101: Subtask load_DMs
[2022-06-18 14:53:20,890] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:53:21,005] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:53:21,105] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 14:53:21,133] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T175320, end_date=20220618T175321
[2022-06-18 14:53:21,209] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 14:53:21,278] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:01:55,991] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:01:56,015] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:01:56,016] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:01:56,016] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:01:56,016] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:01:56,040] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:01:56,052] {standard_task_runner.py:52} INFO - Started process 62629 to run task
[2022-06-18 15:01:56,056] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '118', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpkgkcjkru', '--error-file', '/tmp/tmpei0p_dp3']
[2022-06-18 15:01:56,057] {standard_task_runner.py:80} INFO - Job 118: Subtask load_DMs
[2022-06-18 15:01:56,143] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:01:56,258] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:01:56,363] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:01:56,384] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T180155, end_date=20220618T180156
[2022-06-18 15:01:56,429] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:01:56,488] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:06:38,596] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:06:38,621] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:06:38,621] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:06:38,621] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:06:38,621] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:06:38,646] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:06:38,657] {standard_task_runner.py:52} INFO - Started process 65525 to run task
[2022-06-18 15:06:38,663] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '135', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp5aohk1bm', '--error-file', '/tmp/tmpgpj7oll6']
[2022-06-18 15:06:38,664] {standard_task_runner.py:80} INFO - Job 135: Subtask load_DMs
[2022-06-18 15:06:38,748] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:06:38,883] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:06:38,987] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:06:39,009] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T180638, end_date=20220618T180639
[2022-06-18 15:06:39,075] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:06:39,142] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:08:16,476] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:08:16,499] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:08:16,499] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:08:16,500] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:08:16,500] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:08:16,524] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:08:16,535] {standard_task_runner.py:52} INFO - Started process 67561 to run task
[2022-06-18 15:08:16,542] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '152', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpqthncn93', '--error-file', '/tmp/tmptgy_k_7c']
[2022-06-18 15:08:16,542] {standard_task_runner.py:80} INFO - Job 152: Subtask load_DMs
[2022-06-18 15:08:16,627] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:08:16,746] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:08:16,853] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:08:16,875] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T180816, end_date=20220618T180816
[2022-06-18 15:08:16,913] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:08:16,979] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:27:18,619] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:27:18,644] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:27:18,645] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:27:18,645] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:27:18,645] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:27:18,674] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:27:18,687] {standard_task_runner.py:52} INFO - Started process 76164 to run task
[2022-06-18 15:27:18,693] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '169', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpabvvnu6r', '--error-file', '/tmp/tmpir6ptr98']
[2022-06-18 15:27:18,693] {standard_task_runner.py:80} INFO - Job 169: Subtask load_DMs
[2022-06-18 15:27:18,777] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:27:18,901] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:27:19,007] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:27:19,030] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T182718, end_date=20220618T182719
[2022-06-18 15:27:19,066] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:27:19,135] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:29:59,638] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:29:59,675] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:29:59,676] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:29:59,676] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:29:59,676] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:29:59,699] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:29:59,712] {standard_task_runner.py:52} INFO - Started process 79561 to run task
[2022-06-18 15:29:59,718] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '186', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpvwf5bvrb', '--error-file', '/tmp/tmpplt62lvd']
[2022-06-18 15:29:59,718] {standard_task_runner.py:80} INFO - Job 186: Subtask load_DMs
[2022-06-18 15:29:59,832] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:29:59,949] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:30:00,064] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:30:00,092] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220617T000000, start_date=20220618T182959, end_date=20220618T183000
[2022-06-18 15:30:00,131] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:30:00,191] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
