[2022-06-18 11:09:23,526] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:09:23,548] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:09:23,549] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:09:23,549] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:09:23,549] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:09:23,578] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:09:23,588] {standard_task_runner.py:52} INFO - Started process 199733 to run task
[2022-06-18 11:09:23,594] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1391', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp3r6848_x', '--error-file', '/tmp/tmpa0i8eqp4']
[2022-06-18 11:09:23,595] {standard_task_runner.py:80} INFO - Job 1391: Subtask load_fato
[2022-06-18 11:09:23,685] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:09:23,809] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:09:23,856] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 11:09:23,878] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T140923, end_date=20220618T140923
[2022-06-18 11:09:23,927] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 11:09:23,982] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 11:34:07,551] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:34:07,572] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:34:07,572] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:34:07,572] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:34:07,572] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:34:07,594] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:34:07,605] {standard_task_runner.py:52} INFO - Started process 208499 to run task
[2022-06-18 11:34:07,611] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '27', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp_h3d8bgv', '--error-file', '/tmp/tmpi_kvad1u']
[2022-06-18 11:34:07,611] {standard_task_runner.py:80} INFO - Job 27: Subtask load_fato
[2022-06-18 11:34:07,697] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:34:07,820] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:34:07,855] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 11:34:07,881] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T143407, end_date=20220618T143407
[2022-06-18 11:34:07,941] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 11:34:07,997] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 11:58:02,279] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:58:02,295] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 11:58:02,295] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:58:02,295] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 11:58:02,295] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 11:58:02,310] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 11:58:02,317] {standard_task_runner.py:52} INFO - Started process 219595 to run task
[2022-06-18 11:58:02,322] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '92', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp44e3syuu', '--error-file', '/tmp/tmpsyosk6bg']
[2022-06-18 11:58:02,323] {standard_task_runner.py:80} INFO - Job 92: Subtask load_fato
[2022-06-18 11:58:02,392] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 11:58:02,518] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 11:58:02,557] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 11:58:02,579] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T145802, end_date=20220618T145802
[2022-06-18 11:58:02,614] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 11:58:02,660] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 12:19:22,030] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 12:19:22,041] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 12:19:22,042] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 12:19:22,042] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 12:19:22,042] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 12:19:22,055] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 12:19:22,063] {standard_task_runner.py:52} INFO - Started process 227959 to run task
[2022-06-18 12:19:22,066] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1423', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmpe2_bmvv5', '--error-file', '/tmp/tmpwmrl2qjf']
[2022-06-18 12:19:22,067] {standard_task_runner.py:80} INFO - Job 1423: Subtask load_fato
[2022-06-18 12:19:22,130] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 12:19:22,219] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 12:19:22,257] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 12:19:22,277] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T151922, end_date=20220618T151922
[2022-06-18 12:19:22,319] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 12:19:22,364] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 13:13:51,054] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:13:51,077] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 13:13:51,077] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:13:51,078] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 13:13:51,078] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 13:13:51,102] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 13:13:51,113] {standard_task_runner.py:52} INFO - Started process 14172 to run task
[2022-06-18 13:13:51,119] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '1471', '--raw', '--subdir', 'DAGS_FOLDER/dag copy.py', '--cfg-path', '/tmp/tmp5_ol7dvf', '--error-file', '/tmp/tmpkmlo2tdi']
[2022-06-18 13:13:51,119] {standard_task_runner.py:80} INFO - Job 1471: Subtask load_fato
[2022-06-18 13:13:51,208] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 13:13:51,337] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 13:13:51,357] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.SyntaxError: unterminated quoted identifier at or near "" f        left join dm_customers c        on  c.customername = f.customername        left join dm_products p        on   p.productname = f.productname          left join dm_time t        on t.orderdate = f.orderdate and t.requireddate = f.requireddate        left join dm_emp e        on   e.lastname = f.lastname"
LINE 1: ..., p.id_products, t.id_time, e.id_emp from stg_fato" f       ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 113, in load_Fato
    df_ft = pd.read_sql_query('select f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) unterminated quoted identifier at or near "" f        left join dm_customers c        on  c.customername = f.customername        left join dm_products p        on   p.productname = f.productname          left join dm_time t        on t.orderdate = f.orderdate and t.requireddate = f.requireddate        left join dm_emp e        on   e.lastname = f.lastname"
LINE 1: ..., p.id_products, t.id_time, e.id_emp from stg_fato" f       ...
                                                             ^

[SQL: select f.quantityordered, f.priceeach, f.buyprice,         c.id_customers, p.id_products, t.id_time, e.id_emp from stg_fato" f        left join dm_customers c        on  c.customername = f.customername        left join dm_products p        on   p.productname = f.productname          left join dm_time t        on t.orderdate = f.orderdate and t.requireddate = f.requireddate        left join dm_emp e        on   e.lastname = f.lastname]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-18 13:13:51,377] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T161351, end_date=20220618T161351
[2022-06-18 13:13:51,398] {standard_task_runner.py:92} ERROR - Failed to execute job 1471 for task load_fato ((psycopg2.errors.SyntaxError) unterminated quoted identifier at or near "" f        left join dm_customers c        on  c.customername = f.customername        left join dm_products p        on   p.productname = f.productname          left join dm_time t        on t.orderdate = f.orderdate and t.requireddate = f.requireddate        left join dm_emp e        on   e.lastname = f.lastname"
LINE 1: ..., p.id_products, t.id_time, e.id_emp from stg_fato" f       ...
                                                             ^

[SQL: select f.quantityordered, f.priceeach, f.buyprice,         c.id_customers, p.id_products, t.id_time, e.id_emp from stg_fato" f        left join dm_customers c        on  c.customername = f.customername        left join dm_products p        on   p.productname = f.productname          left join dm_time t        on t.orderdate = f.orderdate and t.requireddate = f.requireddate        left join dm_emp e        on   e.lastname = f.lastname]
(Background on this error at: http://sqlalche.me/e/14/f405); 14172)
[2022-06-18 13:13:51,450] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 13:13:51,514] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:22:53,316] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:22:53,337] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:22:53,337] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:22:53,338] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:22:53,338] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:22:53,360] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:22:53,368] {standard_task_runner.py:52} INFO - Started process 48815 to run task
[2022-06-18 14:22:53,373] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '39', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpr2ci2vex', '--error-file', '/tmp/tmpo0u1tnao']
[2022-06-18 14:22:53,373] {standard_task_runner.py:80} INFO - Job 39: Subtask load_fato
[2022-06-18 14:22:53,456] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:22:53,567] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:22:53,680] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (1, null, null, null, null, 49, 35.29, 21.75).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 133, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (1, null, null, null, null, 49, 35.29, 21.75).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 30.0, 'priceeach': 136.0, 'buyprice': 86.7, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 45.0, 'priceeach': 32.53, 'buyprice': 22.57, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 25.0, 'priceeach': 108.06, 'buyprice': 58.48, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 46.0, 'priceeach': 44.35, 'buyprice': 20.61, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 26.0, 'priceeach': 167.06, 'buyprice': 72.56, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}  ... displaying 10 of 2996 total bound parameter sets ...  {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 23.14, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 44.0, 'priceeach': 54.94, 'buyprice': 33.61, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-18 14:22:53,708] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T172253, end_date=20220618T172253
[2022-06-18 14:22:53,730] {standard_task_runner.py:92} ERROR - Failed to execute job 39 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (1, null, null, null, null, 49, 35.29, 21.75).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 30.0, 'priceeach': 136.0, 'buyprice': 86.7, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 45.0, 'priceeach': 32.53, 'buyprice': 22.57, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 25.0, 'priceeach': 108.06, 'buyprice': 58.48, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 46.0, 'priceeach': 44.35, 'buyprice': 20.61, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 26.0, 'priceeach': 167.06, 'buyprice': 72.56, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}  ... displaying 10 of 2996 total bound parameter sets ...  {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 23.14, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None}, {'quantityordered': 44.0, 'priceeach': 54.94, 'buyprice': 33.61, 'id_customers': None, 'id_products': None, 'id_time': None, 'id_emp': None})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 48815)
[2022-06-18 14:22:53,786] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 14:22:53,853] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 14:53:22,073] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:53:22,096] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 14:53:22,096] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:53:22,096] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 14:53:22,096] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 14:53:22,119] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 14:53:22,131] {standard_task_runner.py:52} INFO - Started process 59172 to run task
[2022-06-18 14:53:22,138] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '102', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpdjp82ba0', '--error-file', '/tmp/tmpd3hi9394']
[2022-06-18 14:53:22,138] {standard_task_runner.py:80} INFO - Job 102: Subtask load_fato
[2022-06-18 14:53:22,227] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 14:53:22,339] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 14:53:22,468] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_emp" violates not-null constraint
DETAIL:  Failing row contains (2, 9, 34, 224, null, 49, 35.29, 21.75).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_emp" violates not-null constraint
DETAIL:  Failing row contains (2, 9, 34, 224, null, 49, 35.29, 21.75).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': 9.0, 'id_products': 54, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 30.0, 'priceeach': 136.0, 'buyprice': 86.7, 'id_customers': 9.0, 'id_products': 101, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 45.0, 'priceeach': 32.53, 'buyprice': 22.57, 'id_customers': None, 'id_products': 89, 'id_time': 160.0, 'id_emp': None}, {'quantityordered': 25.0, 'priceeach': 108.06, 'buyprice': 58.48, 'id_customers': None, 'id_products': 103, 'id_time': 160.0, 'id_emp': None}, {'quantityordered': 46.0, 'priceeach': 44.35, 'buyprice': 20.61, 'id_customers': None, 'id_products': 72, 'id_time': 160.0, 'id_emp': None}, {'quantityordered': 26.0, 'priceeach': 167.06, 'buyprice': 72.56, 'id_customers': None, 'id_products': 90, 'id_time': 160.0, 'id_emp': None}  ... displaying 10 of 3182 total bound parameter sets ...  {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 23.14, 'id_customers': None, 'id_products': 69, 'id_time': None, 'id_emp': None}, {'quantityordered': 44.0, 'priceeach': 54.94, 'buyprice': 33.61, 'id_customers': None, 'id_products': 74, 'id_time': None, 'id_emp': None})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-18 14:53:22,494] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T175322, end_date=20220618T175322
[2022-06-18 14:53:22,515] {standard_task_runner.py:92} ERROR - Failed to execute job 102 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_emp" violates not-null constraint
DETAIL:  Failing row contains (2, 9, 34, 224, null, 49, 35.29, 21.75).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': 9.0, 'id_products': 54, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 30.0, 'priceeach': 136.0, 'buyprice': 86.7, 'id_customers': 9.0, 'id_products': 101, 'id_time': 224.0, 'id_emp': None}, {'quantityordered': 45.0, 'priceeach': 32.53, 'buyprice': 22.57, 'id_customers': None, 'id_products': 89, 'id_time': 160.0, 'id_emp': None}, {'quantityordered': 25.0, 'priceeach': 108.06, 'buyprice': 58.48, 'id_customers': None, 'id_products': 103, 'id_time': 160.0, 'id_emp': None}, {'quantityordered': 46.0, 'priceeach': 44.35, 'buyprice': 20.61, 'id_customers': None, 'id_products': 72, 'id_time': 160.0, 'id_emp': None}, {'quantityordered': 26.0, 'priceeach': 167.06, 'buyprice': 72.56, 'id_customers': None, 'id_products': 90, 'id_time': 160.0, 'id_emp': None}  ... displaying 10 of 3182 total bound parameter sets ...  {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 23.14, 'id_customers': None, 'id_products': 69, 'id_time': None, 'id_emp': None}, {'quantityordered': 44.0, 'priceeach': 54.94, 'buyprice': 33.61, 'id_customers': None, 'id_products': 74, 'id_time': None, 'id_emp': None})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 59172)
[2022-06-18 14:53:22,550] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 14:53:22,610] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:01:57,277] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:01:57,298] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:01:57,298] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:01:57,298] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:01:57,298] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:01:57,319] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:01:57,331] {standard_task_runner.py:52} INFO - Started process 62683 to run task
[2022-06-18 15:01:57,337] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '119', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp136bjbxo', '--error-file', '/tmp/tmpoz7xhd02']
[2022-06-18 15:01:57,338] {standard_task_runner.py:80} INFO - Job 119: Subtask load_fato
[2022-06-18 15:01:57,424] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:01:57,551] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:01:57,711] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (16, null, 89, 160, 13, 45, 32.53, 22.57).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (16, null, 89, 160, 13, 45, 32.53, 22.57).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': 15}, {'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': 12}, {'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': 7}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': 15}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': 12}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': 7}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': 9.0, 'id_products': 54, 'id_time': 224.0, 'id_emp': 15}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': 9.0, 'id_products': 54, 'id_time': 224.0, 'id_emp': 12}  ... displaying 10 of 3863 total bound parameter sets ...  {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 23.14, 'id_customers': None, 'id_products': 69, 'id_time': None, 'id_emp': 11}, {'quantityordered': 44.0, 'priceeach': 54.94, 'buyprice': 33.61, 'id_customers': None, 'id_products': 74, 'id_time': None, 'id_emp': 11})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-18 15:01:57,746] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T180157, end_date=20220618T180157
[2022-06-18 15:01:57,775] {standard_task_runner.py:92} ERROR - Failed to execute job 119 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (16, null, 89, 160, 13, 45, 32.53, 22.57).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': 15}, {'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': 12}, {'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 9.0, 'id_products': 34, 'id_time': 224.0, 'id_emp': 7}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': 15}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': 12}, {'quantityordered': 22.0, 'priceeach': 75.46, 'buyprice': 43.26, 'id_customers': 9.0, 'id_products': 24, 'id_time': 224.0, 'id_emp': 7}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': 9.0, 'id_products': 54, 'id_time': 224.0, 'id_emp': 15}, {'quantityordered': 50.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': 9.0, 'id_products': 54, 'id_time': 224.0, 'id_emp': 12}  ... displaying 10 of 3863 total bound parameter sets ...  {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 23.14, 'id_customers': None, 'id_products': 69, 'id_time': None, 'id_emp': 11}, {'quantityordered': 44.0, 'priceeach': 54.94, 'buyprice': 33.61, 'id_customers': None, 'id_products': 74, 'id_time': None, 'id_emp': 11})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 62683)
[2022-06-18 15:01:57,829] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 15:01:57,902] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:06:40,021] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:06:40,051] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:06:40,051] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:06:40,051] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:06:40,051] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:06:40,076] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:06:40,086] {standard_task_runner.py:52} INFO - Started process 65592 to run task
[2022-06-18 15:06:40,093] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '136', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp91_5zb7z', '--error-file', '/tmp/tmpb62bs31x']
[2022-06-18 15:06:40,093] {standard_task_runner.py:80} INFO - Job 136: Subtask load_fato
[2022-06-18 15:06:40,179] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:06:40,298] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:06:41,523] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (35, null, 137, 381, 41, 55, 58.15, 24.23).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (35, null, 137, 381, 41, 55, 58.15, 24.23).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 460.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 460.0, 'id_emp': 1}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 151.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 151.0, 'id_emp': 1}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 460.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 460.0, 'id_emp': 1}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 151.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 151.0, 'id_emp': 1}  ... displaying 10 of 45144 total bound parameter sets ...  {'quantityordered': 29.0, 'priceeach': 43.68, 'buyprice': 33.3, 'id_customers': 38.0, 'id_products': 102, 'id_time': 173.0, 'id_emp': 32}, {'quantityordered': 29.0, 'priceeach': 43.68, 'buyprice': 33.3, 'id_customers': 38.0, 'id_products': 102, 'id_time': 173.0, 'id_emp': 9})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-18 15:06:41,593] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T180640, end_date=20220618T180641
[2022-06-18 15:06:41,620] {standard_task_runner.py:92} ERROR - Failed to execute job 136 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (35, null, 137, 381, 41, 55, 58.15, 24.23).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 460.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 460.0, 'id_emp': 1}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 151.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 182, 'id_time': 151.0, 'id_emp': 1}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 460.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 460.0, 'id_emp': 1}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 151.0, 'id_emp': 24}, {'quantityordered': 22.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': 87.0, 'id_products': 72, 'id_time': 151.0, 'id_emp': 1}  ... displaying 10 of 45144 total bound parameter sets ...  {'quantityordered': 29.0, 'priceeach': 43.68, 'buyprice': 33.3, 'id_customers': 38.0, 'id_products': 102, 'id_time': 173.0, 'id_emp': 32}, {'quantityordered': 29.0, 'priceeach': 43.68, 'buyprice': 33.3, 'id_customers': 38.0, 'id_products': 102, 'id_time': 173.0, 'id_emp': 9})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 65592)
[2022-06-18 15:06:41,669] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 15:06:42,089] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:08:17,839] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:08:17,864] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:08:17,865] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:08:17,865] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:08:17,865] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:08:17,887] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:08:17,899] {standard_task_runner.py:52} INFO - Started process 67605 to run task
[2022-06-18 15:08:17,904] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '153', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmphfuzxo_9', '--error-file', '/tmp/tmpielepbpe']
[2022-06-18 15:08:17,904] {standard_task_runner.py:80} INFO - Job 153: Subtask load_fato
[2022-06-18 15:08:17,990] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:08:18,120] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:08:42,321] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:08:42,344] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T180817, end_date=20220618T180842
[2022-06-18 15:08:42,416] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:08:42,465] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:27:20,379] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:27:20,402] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:27:20,402] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:27:20,402] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:27:20,402] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:27:20,425] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:27:20,439] {standard_task_runner.py:52} INFO - Started process 76256 to run task
[2022-06-18 15:27:20,445] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '170', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpslqkdg8f', '--error-file', '/tmp/tmpzbwtf_at']
[2022-06-18 15:27:20,446] {standard_task_runner.py:80} INFO - Job 170: Subtask load_fato
[2022-06-18 15:27:20,530] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:27:20,655] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:28:41,760] {python.py:173} INFO - Done. Returned value was: None
[2022-06-18 15:28:41,783] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T182720, end_date=20220618T182841
[2022-06-18 15:28:41,867] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-18 15:28:41,911] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-18 15:30:00,902] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:30:00,923] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [queued]>
[2022-06-18 15:30:00,923] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:30:00,923] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-18 15:30:00,923] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-18 15:30:00,947] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-17 00:00:00+00:00
[2022-06-18 15:30:00,959] {standard_task_runner.py:52} INFO - Started process 79590 to run task
[2022-06-18 15:30:00,965] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-17T00:00:00+00:00', '--job-id', '187', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpjq6no7ni', '--error-file', '/tmp/tmpupaa_3v8']
[2022-06-18 15:30:00,966] {standard_task_runner.py:80} INFO - Job 187: Subtask load_fato
[2022-06-18 15:30:01,060] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-17T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-18 15:30:01,199] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-17T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-17T00:00:00+00:00
[2022-06-18 15:30:34,659] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (10, null, 279, 1097, 34, 29, 76.56, 48.81).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (10, null, 279, 1097, 34, 29, 76.56, 48.81).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 41.0, 'priceeach': 44.21, 'buyprice': 24.26, 'id_customers': 9.0, 'id_products': 393, 'id_time': 325.0, 'id_emp': 107}, {'quantityordered': 23.0, 'priceeach': 123.58, 'buyprice': 98.3, 'id_customers': 181.0, 'id_products': 343, 'id_time': 82.0, 'id_emp': 113}, {'quantityordered': 22.0, 'priceeach': 96.95, 'buyprice': 56.13, 'id_customers': 112.0, 'id_products': 41, 'id_time': 941.0, 'id_emp': 55}, {'quantityordered': 40.0, 'priceeach': 180.01, 'buyprice': 98.58, 'id_customers': 105.0, 'id_products': 449, 'id_time': 1329.0, 'id_emp': 76}, {'quantityordered': 41.0, 'priceeach': 54.34, 'buyprice': 34.35, 'id_customers': 9.0, 'id_products': 7, 'id_time': 402.0, 'id_emp': 58}, {'quantityordered': 33.0, 'priceeach': 35.78, 'buyprice': 27.06, 'id_customers': 107.0, 'id_products': 537, 'id_time': 825.0, 'id_emp': 71}, {'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 153.0, 'id_products': 254, 'id_time': 1151.0, 'id_emp': 7}, {'quantityordered': 50.0, 'priceeach': 62.16, 'buyprice': 33.97, 'id_customers': 170.0, 'id_products': 312, 'id_time': 1024.0, 'id_emp': 14}  ... displaying 10 of 1383675 total bound parameter sets ...  {'quantityordered': 32.0, 'priceeach': 143.94, 'buyprice': 77.9, 'id_customers': 114.0, 'id_products': 547, 'id_time': 401.0, 'id_emp': 25}, {'quantityordered': 45.0, 'priceeach': 88.93, 'buyprice': 64.58, 'id_customers': 211.0, 'id_products': 204, 'id_time': 444.0, 'id_emp': 93})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-18 15:30:36,691] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220617T000000, start_date=20220618T183000, end_date=20220618T183036
[2022-06-18 15:30:36,714] {standard_task_runner.py:92} ERROR - Failed to execute job 187 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (10, null, 279, 1097, 34, 29, 76.56, 48.81).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 41.0, 'priceeach': 44.21, 'buyprice': 24.26, 'id_customers': 9.0, 'id_products': 393, 'id_time': 325.0, 'id_emp': 107}, {'quantityordered': 23.0, 'priceeach': 123.58, 'buyprice': 98.3, 'id_customers': 181.0, 'id_products': 343, 'id_time': 82.0, 'id_emp': 113}, {'quantityordered': 22.0, 'priceeach': 96.95, 'buyprice': 56.13, 'id_customers': 112.0, 'id_products': 41, 'id_time': 941.0, 'id_emp': 55}, {'quantityordered': 40.0, 'priceeach': 180.01, 'buyprice': 98.58, 'id_customers': 105.0, 'id_products': 449, 'id_time': 1329.0, 'id_emp': 76}, {'quantityordered': 41.0, 'priceeach': 54.34, 'buyprice': 34.35, 'id_customers': 9.0, 'id_products': 7, 'id_time': 402.0, 'id_emp': 58}, {'quantityordered': 33.0, 'priceeach': 35.78, 'buyprice': 27.06, 'id_customers': 107.0, 'id_products': 537, 'id_time': 825.0, 'id_emp': 71}, {'quantityordered': 49.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': 153.0, 'id_products': 254, 'id_time': 1151.0, 'id_emp': 7}, {'quantityordered': 50.0, 'priceeach': 62.16, 'buyprice': 33.97, 'id_customers': 170.0, 'id_products': 312, 'id_time': 1024.0, 'id_emp': 14}  ... displaying 10 of 1383675 total bound parameter sets ...  {'quantityordered': 32.0, 'priceeach': 143.94, 'buyprice': 77.9, 'id_customers': 114.0, 'id_products': 547, 'id_time': 401.0, 'id_emp': 25}, {'quantityordered': 45.0, 'priceeach': 88.93, 'buyprice': 64.58, 'id_customers': 211.0, 'id_products': 204, 'id_time': 444.0, 'id_emp': 93})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 79590)
[2022-06-18 15:30:36,942] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-18 15:30:42,740] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
