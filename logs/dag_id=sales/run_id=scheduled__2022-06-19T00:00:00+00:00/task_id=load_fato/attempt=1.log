[2022-06-19 23:39:57,237] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:39:57,258] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:39:57,259] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:39:57,259] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-19 23:39:57,259] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:39:57,287] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-19 23:39:57,297] {standard_task_runner.py:52} INFO - Started process 28741 to run task
[2022-06-19 23:39:57,302] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '207', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpnz3umpxs', '--error-file', '/tmp/tmpr3y4bbf5']
[2022-06-19 23:39:57,303] {standard_task_runner.py:80} INFO - Job 207: Subtask load_fato
[2022-06-19 23:39:57,389] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-19 23:39:57,501] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-19 23:40:58,342] {local_task_job.py:220} WARNING - State of this instance has been externally set to None. Terminating instance.
[2022-06-19 23:40:58,361] {process_utils.py:125} INFO - Sending Signals.SIGTERM to group 28741. PIDs of all processes in the group: [28741]
[2022-06-19 23:40:58,362] {process_utils.py:80} INFO - Sending the signal Signals.SIGTERM to group 28741
[2022-06-19 23:40:58,362] {taskinstance.py:1542} ERROR - Received SIGTERM. Terminating subprocesses.
[2022-06-19 23:40:58,364] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1608, in _execute_context
    context = constructor(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 1070, in _init_compiled
    param = {
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 1072, in <dictcomp>
    if key in processors
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1544, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
airflow.exceptions.AirflowException: Task received SIGTERM signal

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1614, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1608, in _execute_context
    context = constructor(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 1070, in _init_compiled
    param = {
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 1072, in <dictcomp>
    if key in processors
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/models/taskinstance.py", line 1544, in signal_handler
    raise AirflowException("Task received SIGTERM signal")
sqlalchemy.exc.StatementError: (airflow.exceptions.AirflowException) Task received SIGTERM signal
[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: [{'quantityordered': 6.0, 'priceeach': 104.25, 'buyprice': 58.48, 'id_customers': None, 'id_products': 103, 'id_time': 192, 'id_emp': 6}, {'quantityor ... (383704836 characters truncated) ... p': 103}, {'quantityordered': 97.0, 'priceeach': 115.16, 'buyprice': 58.73, 'id_customers': None, 'id_products': 569, 'id_time': 1757, 'id_emp': 126}]]
[2022-06-19 23:41:08,917] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T023957, end_date=20220620T024108
[2022-06-19 23:41:08,955] {standard_task_runner.py:92} ERROR - Failed to execute job 207 for task load_fato ((psycopg2.errors.ForeignKeyViolation) insert or update on table "task_fail" violates foreign key constraint "task_fail_ti_fkey"
DETAIL:  Key (dag_id, task_id, run_id, map_index)=(sales, load_fato, scheduled__2022-06-19T00:00:00+00:00, -1) is not present in table "task_instance".

[SQL: INSERT INTO task_fail (task_id, dag_id, run_id, map_index, start_date, end_date, duration) VALUES (%(task_id)s, %(dag_id)s, %(run_id)s, %(map_index)s, %(start_date)s, %(end_date)s, %(duration)s) RETURNING task_fail.id]
[parameters: {'task_id': 'load_fato', 'dag_id': 'sales', 'run_id': 'scheduled__2022-06-19T00:00:00+00:00', 'map_index': -1, 'start_date': datetime.datetime(2022, 6, 20, 2, 39, 57, 237929, tzinfo=Timezone('UTC')), 'end_date': datetime.datetime(2022, 6, 20, 2, 41, 8, 916148, tzinfo=Timezone('UTC')), 'duration': 71}]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 28741)
[2022-06-19 23:41:09,343] {process_utils.py:75} INFO - Process psutil.Process(pid=28741, status='terminated', exitcode=1, started='23:39:56') (28741) terminated with exit code 1
[2022-06-19 23:48:52,151] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:48:52,175] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:48:52,175] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:48:52,176] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-19 23:48:52,176] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:48:52,197] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-19 23:48:52,207] {standard_task_runner.py:52} INFO - Started process 33347 to run task
[2022-06-19 23:48:52,213] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '237', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp655xue2v', '--error-file', '/tmp/tmpr5aw2mdf']
[2022-06-19 23:48:52,213] {standard_task_runner.py:80} INFO - Job 237: Subtask load_fato
[2022-06-19 23:48:52,296] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-19 23:48:52,412] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-19 23:48:52,561] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (3, null, 83, 306, 11, 28, 58.47, 33.02).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (3, null, 83, 306, 11, 28, 58.47, 33.02).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 30.0, 'priceeach': 139.64, 'buyprice': 73.49, 'id_customers': 30.0, 'id_products': 2, 'id_time': 41, 'id_emp': 21}, {'quantityordered': 44.0, 'priceeach': 71.56, 'buyprice': 33.97, 'id_customers': 43.0, 'id_products': 92, 'id_time': 230, 'id_emp': 12}, {'quantityordered': 28.0, 'priceeach': 58.47, 'buyprice': 33.02, 'id_customers': None, 'id_products': 83, 'id_time': 306, 'id_emp': 11}, {'quantityordered': 30.0, 'priceeach': 57.73, 'buyprice': 24.92, 'id_customers': None, 'id_products': 28, 'id_time': 113, 'id_emp': 11}, {'quantityordered': 23.0, 'priceeach': 85.76, 'buyprice': 68.8, 'id_customers': 21.0, 'id_products': 31, 'id_time': 153, 'id_emp': 3}, {'quantityordered': 33.0, 'priceeach': 55.27, 'buyprice': 29.34, 'id_customers': 35.0, 'id_products': 53, 'id_time': 285, 'id_emp': 20}, {'quantityordered': 37.0, 'priceeach': 72.02, 'buyprice': 49.24, 'id_customers': 9.0, 'id_products': 95, 'id_time': 2, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 73.32, 'buyprice': 39.83, 'id_customers': 23.0, 'id_products': 20, 'id_time': 3, 'id_emp': 2}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 42.0, 'priceeach': 49.67, 'buyprice': 24.23, 'id_customers': 8.0, 'id_products': 27, 'id_time': 24, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 199.3, 'buyprice': 98.58, 'id_customers': 44.0, 'id_products': 9, 'id_time': 235, 'id_emp': 16})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-19 23:48:52,590] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T024852, end_date=20220620T024852
[2022-06-19 23:48:52,614] {standard_task_runner.py:92} ERROR - Failed to execute job 237 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (3, null, 83, 306, 11, 28, 58.47, 33.02).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 30.0, 'priceeach': 139.64, 'buyprice': 73.49, 'id_customers': 30.0, 'id_products': 2, 'id_time': 41, 'id_emp': 21}, {'quantityordered': 44.0, 'priceeach': 71.56, 'buyprice': 33.97, 'id_customers': 43.0, 'id_products': 92, 'id_time': 230, 'id_emp': 12}, {'quantityordered': 28.0, 'priceeach': 58.47, 'buyprice': 33.02, 'id_customers': None, 'id_products': 83, 'id_time': 306, 'id_emp': 11}, {'quantityordered': 30.0, 'priceeach': 57.73, 'buyprice': 24.92, 'id_customers': None, 'id_products': 28, 'id_time': 113, 'id_emp': 11}, {'quantityordered': 23.0, 'priceeach': 85.76, 'buyprice': 68.8, 'id_customers': 21.0, 'id_products': 31, 'id_time': 153, 'id_emp': 3}, {'quantityordered': 33.0, 'priceeach': 55.27, 'buyprice': 29.34, 'id_customers': 35.0, 'id_products': 53, 'id_time': 285, 'id_emp': 20}, {'quantityordered': 37.0, 'priceeach': 72.02, 'buyprice': 49.24, 'id_customers': 9.0, 'id_products': 95, 'id_time': 2, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 73.32, 'buyprice': 39.83, 'id_customers': 23.0, 'id_products': 20, 'id_time': 3, 'id_emp': 2}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 42.0, 'priceeach': 49.67, 'buyprice': 24.23, 'id_customers': 8.0, 'id_products': 27, 'id_time': 24, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 199.3, 'buyprice': 98.58, 'id_customers': 44.0, 'id_products': 9, 'id_time': 235, 'id_emp': 16})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 33347)
[2022-06-19 23:48:52,664] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-19 23:48:52,732] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:04:08,302] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:04:08,326] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:04:08,327] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:04:08,327] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:04:08,327] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:04:08,353] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:04:08,363] {standard_task_runner.py:52} INFO - Started process 36481 to run task
[2022-06-20 00:04:08,368] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '253', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp2xc90_b7', '--error-file', '/tmp/tmp59a63kni']
[2022-06-20 00:04:08,369] {standard_task_runner.py:80} INFO - Job 253: Subtask load_fato
[2022-06-20 00:04:08,458] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:04:08,613] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:04:09,958] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (4, null, 98, 5, 41, 38, 69.52, 32.33).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (4, null, 98, 5, 41, 38, 69.52, 32.33).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 38.0, 'priceeach': 69.52, 'buyprice': 32.33, 'id_customers': None, 'id_products': 98, 'id_time': 5, 'id_emp': 41}, {'quantityordered': 29.0, 'priceeach': 141.1, 'buyprice': 86.7, 'id_customers': 24.0, 'id_products': 101, 'id_time': 302, 'id_emp': 39}, {'quantityordered': 34.0, 'priceeach': 48.46, 'buyprice': 24.23, 'id_customers': 45.0, 'id_products': 27, 'id_time': 39, 'id_emp': 43}, {'quantityordered': 37.0, 'priceeach': 49.66, 'buyprice': 32.77, 'id_customers': 82.0, 'id_products': 61, 'id_time': 70, 'id_emp': 21}, {'quantityordered': 34.0, 'priceeach': 115.5, 'buyprice': 58.33, 'id_customers': 50.0, 'id_products': 64, 'id_time': 600, 'id_emp': 43}, {'quantityordered': 30.0, 'priceeach': 74.51, 'buyprice': 47.25, 'id_customers': 28.0, 'id_products': 190, 'id_time': 325, 'id_emp': 30}, {'quantityordered': 49.0, 'priceeach': 97.26, 'buyprice': 60.78, 'id_customers': 46.0, 'id_products': 145, 'id_time': 119, 'id_emp': 1}, {'quantityordered': 50.0, 'priceeach': 126.52, 'buyprice': 66.27, 'id_customers': None, 'id_products': 214, 'id_time': 209, 'id_emp': 10}  ... displaying 10 of 44048 total bound parameter sets ...  {'quantityordered': 44.0, 'priceeach': 125.01, 'buyprice': 66.27, 'id_customers': 76.0, 'id_products': 104, 'id_time': 52, 'id_emp': 15}, {'quantityordered': 46.0, 'priceeach': 93.16, 'buyprice': 62.11, 'id_customers': 57.0, 'id_products': 22, 'id_time': 311, 'id_emp': 30})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 00:04:10,021] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T030408, end_date=20220620T030410
[2022-06-20 00:04:10,046] {standard_task_runner.py:92} ERROR - Failed to execute job 253 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (4, null, 98, 5, 41, 38, 69.52, 32.33).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 38.0, 'priceeach': 69.52, 'buyprice': 32.33, 'id_customers': None, 'id_products': 98, 'id_time': 5, 'id_emp': 41}, {'quantityordered': 29.0, 'priceeach': 141.1, 'buyprice': 86.7, 'id_customers': 24.0, 'id_products': 101, 'id_time': 302, 'id_emp': 39}, {'quantityordered': 34.0, 'priceeach': 48.46, 'buyprice': 24.23, 'id_customers': 45.0, 'id_products': 27, 'id_time': 39, 'id_emp': 43}, {'quantityordered': 37.0, 'priceeach': 49.66, 'buyprice': 32.77, 'id_customers': 82.0, 'id_products': 61, 'id_time': 70, 'id_emp': 21}, {'quantityordered': 34.0, 'priceeach': 115.5, 'buyprice': 58.33, 'id_customers': 50.0, 'id_products': 64, 'id_time': 600, 'id_emp': 43}, {'quantityordered': 30.0, 'priceeach': 74.51, 'buyprice': 47.25, 'id_customers': 28.0, 'id_products': 190, 'id_time': 325, 'id_emp': 30}, {'quantityordered': 49.0, 'priceeach': 97.26, 'buyprice': 60.78, 'id_customers': 46.0, 'id_products': 145, 'id_time': 119, 'id_emp': 1}, {'quantityordered': 50.0, 'priceeach': 126.52, 'buyprice': 66.27, 'id_customers': None, 'id_products': 214, 'id_time': 209, 'id_emp': 10}  ... displaying 10 of 44048 total bound parameter sets ...  {'quantityordered': 44.0, 'priceeach': 125.01, 'buyprice': 66.27, 'id_customers': 76.0, 'id_products': 104, 'id_time': 52, 'id_emp': 15}, {'quantityordered': 46.0, 'priceeach': 93.16, 'buyprice': 62.11, 'id_customers': 57.0, 'id_products': 22, 'id_time': 311, 'id_emp': 30})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 36481)
[2022-06-20 00:04:10,107] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:04:10,484] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:07:07,059] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:07:07,078] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:07:07,078] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:07:07,078] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:07:07,078] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:07:07,100] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:07:07,108] {standard_task_runner.py:52} INFO - Started process 39278 to run task
[2022-06-20 00:07:07,113] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '278', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp1u0997tj', '--error-file', '/tmp/tmpab25nykt']
[2022-06-20 00:07:07,114] {standard_task_runner.py:80} INFO - Job 278: Subtask load_fato
[2022-06-20 00:07:07,191] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:07:07,295] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:07:07,421] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (5, null, 306, 858, 50, 47, 53.88, 38.58).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (5, null, 306, 858, 50, 47, 53.88, 38.58).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 47.0, 'priceeach': 53.88, 'buyprice': 38.58, 'id_customers': None, 'id_products': 306, 'id_time': 858, 'id_emp': 50}, {'quantityordered': 24.0, 'priceeach': 85.17, 'buyprice': 48.81, 'id_customers': None, 'id_products': 279, 'id_time': 654, 'id_emp': 49}, {'quantityordered': 20.0, 'priceeach': 129.76, 'buyprice': 68.3, 'id_customers': None, 'id_products': 226, 'id_time': 885, 'id_emp': 50}, {'quantityordered': 34.0, 'priceeach': 101.15, 'buyprice': 46.53, 'id_customers': 140.0, 'id_products': 262, 'id_time': 691, 'id_emp': 62}, {'quantityordered': 33.0, 'priceeach': 146.55, 'buyprice': 89.14, 'id_customers': 130.0, 'id_products': 278, 'id_time': 720, 'id_emp': 67}, {'quantityordered': 39.0, 'priceeach': 92.16, 'buyprice': 51.09, 'id_customers': None, 'id_products': 302, 'id_time': 687, 'id_emp': 50}, {'quantityordered': 25.0, 'priceeach': 88.62, 'buyprice': 57.46, 'id_customers': None, 'id_products': 287, 'id_time': 668, 'id_emp': 59}, {'quantityordered': 47.0, 'priceeach': 63.98, 'buyprice': 37.32, 'id_customers': 136.0, 'id_products': 286, 'id_time': 661, 'id_emp': 47}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 49.0, 'priceeach': 162.64, 'buyprice': 83.05, 'id_customers': None, 'id_products': 236, 'id_time': 793, 'id_emp': 56}, {'quantityordered': 23.0, 'priceeach': 43.46, 'buyprice': 20.61, 'id_customers': 140.0, 'id_products': 292, 'id_time': 680, 'id_emp': 62})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 00:07:07,446] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T030707, end_date=20220620T030707
[2022-06-20 00:07:07,467] {standard_task_runner.py:92} ERROR - Failed to execute job 278 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (5, null, 306, 858, 50, 47, 53.88, 38.58).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 47.0, 'priceeach': 53.88, 'buyprice': 38.58, 'id_customers': None, 'id_products': 306, 'id_time': 858, 'id_emp': 50}, {'quantityordered': 24.0, 'priceeach': 85.17, 'buyprice': 48.81, 'id_customers': None, 'id_products': 279, 'id_time': 654, 'id_emp': 49}, {'quantityordered': 20.0, 'priceeach': 129.76, 'buyprice': 68.3, 'id_customers': None, 'id_products': 226, 'id_time': 885, 'id_emp': 50}, {'quantityordered': 34.0, 'priceeach': 101.15, 'buyprice': 46.53, 'id_customers': 140.0, 'id_products': 262, 'id_time': 691, 'id_emp': 62}, {'quantityordered': 33.0, 'priceeach': 146.55, 'buyprice': 89.14, 'id_customers': 130.0, 'id_products': 278, 'id_time': 720, 'id_emp': 67}, {'quantityordered': 39.0, 'priceeach': 92.16, 'buyprice': 51.09, 'id_customers': None, 'id_products': 302, 'id_time': 687, 'id_emp': 50}, {'quantityordered': 25.0, 'priceeach': 88.62, 'buyprice': 57.46, 'id_customers': None, 'id_products': 287, 'id_time': 668, 'id_emp': 59}, {'quantityordered': 47.0, 'priceeach': 63.98, 'buyprice': 37.32, 'id_customers': 136.0, 'id_products': 286, 'id_time': 661, 'id_emp': 47}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 49.0, 'priceeach': 162.64, 'buyprice': 83.05, 'id_customers': None, 'id_products': 236, 'id_time': 793, 'id_emp': 56}, {'quantityordered': 23.0, 'priceeach': 43.46, 'buyprice': 20.61, 'id_customers': 140.0, 'id_products': 292, 'id_time': 680, 'id_emp': 62})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 39278)
[2022-06-20 00:07:07,485] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:07:07,542] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:25:41,536] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:25:41,560] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:25:41,560] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:25:41,560] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:25:41,560] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:25:41,580] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:25:41,592] {standard_task_runner.py:52} INFO - Started process 43285 to run task
[2022-06-20 00:25:41,597] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '294', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpxrkf_daf', '--error-file', '/tmp/tmpbw_1u10f']
[2022-06-20 00:25:41,598] {standard_task_runner.py:80} INFO - Job 294: Subtask load_fato
[2022-06-20 00:25:41,681] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:25:41,796] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:25:42,926] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (7, null, 297, 705, 79, 36, 109.51, 65.96).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (7, null, 297, 705, 79, 36, 109.51, 65.96).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 45.0, 'priceeach': 83.76, 'buyprice': 57.46, 'id_customers': 144.0, 'id_products': 397, 'id_time': 758, 'id_emp': 53}, {'quantityordered': 36.0, 'priceeach': 109.51, 'buyprice': 65.96, 'id_customers': None, 'id_products': 297, 'id_time': 705, 'id_emp': 79}, {'quantityordered': 47.0, 'priceeach': 96.86, 'buyprice': 84.76, 'id_customers': None, 'id_products': 355, 'id_time': 891, 'id_emp': 59}, {'quantityordered': 28.0, 'priceeach': 105.34, 'buyprice': 84.76, 'id_customers': 188.0, 'id_products': 245, 'id_time': 1162, 'id_emp': 85}, {'quantityordered': 50.0, 'priceeach': 102.04, 'buyprice': 59.33, 'id_customers': 152.0, 'id_products': 390, 'id_time': 642, 'id_emp': 81}, {'quantityordered': 41.0, 'priceeach': 133.94, 'buyprice': 77.9, 'id_customers': 170.0, 'id_products': 329, 'id_time': 935, 'id_emp': 60}, {'quantityordered': 40.0, 'priceeach': 93.49, 'buyprice': 57.46, 'id_customers': 181.0, 'id_products': 397, 'id_time': 1211, 'id_emp': 65}, {'quantityordered': 26.0, 'priceeach': 82.83, 'buyprice': 53.93, 'id_customers': 188.0, 'id_products': 380, 'id_time': 756, 'id_emp': 85}  ... displaying 10 of 44048 total bound parameter sets ...  {'quantityordered': 34.0, 'priceeach': 45.28, 'buyprice': 29.18, 'id_customers': None, 'id_products': 237, 'id_time': 939, 'id_emp': 59}, {'quantityordered': 20.0, 'priceeach': 58.17, 'buyprice': 38.58, 'id_customers': 174.0, 'id_products': 306, 'id_time': 659, 'id_emp': 67})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 00:25:42,987] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T032541, end_date=20220620T032542
[2022-06-20 00:25:43,008] {standard_task_runner.py:92} ERROR - Failed to execute job 294 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (7, null, 297, 705, 79, 36, 109.51, 65.96).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 45.0, 'priceeach': 83.76, 'buyprice': 57.46, 'id_customers': 144.0, 'id_products': 397, 'id_time': 758, 'id_emp': 53}, {'quantityordered': 36.0, 'priceeach': 109.51, 'buyprice': 65.96, 'id_customers': None, 'id_products': 297, 'id_time': 705, 'id_emp': 79}, {'quantityordered': 47.0, 'priceeach': 96.86, 'buyprice': 84.76, 'id_customers': None, 'id_products': 355, 'id_time': 891, 'id_emp': 59}, {'quantityordered': 28.0, 'priceeach': 105.34, 'buyprice': 84.76, 'id_customers': 188.0, 'id_products': 245, 'id_time': 1162, 'id_emp': 85}, {'quantityordered': 50.0, 'priceeach': 102.04, 'buyprice': 59.33, 'id_customers': 152.0, 'id_products': 390, 'id_time': 642, 'id_emp': 81}, {'quantityordered': 41.0, 'priceeach': 133.94, 'buyprice': 77.9, 'id_customers': 170.0, 'id_products': 329, 'id_time': 935, 'id_emp': 60}, {'quantityordered': 40.0, 'priceeach': 93.49, 'buyprice': 57.46, 'id_customers': 181.0, 'id_products': 397, 'id_time': 1211, 'id_emp': 65}, {'quantityordered': 26.0, 'priceeach': 82.83, 'buyprice': 53.93, 'id_customers': 188.0, 'id_products': 380, 'id_time': 756, 'id_emp': 85}  ... displaying 10 of 44048 total bound parameter sets ...  {'quantityordered': 34.0, 'priceeach': 45.28, 'buyprice': 29.18, 'id_customers': None, 'id_products': 237, 'id_time': 939, 'id_emp': 59}, {'quantityordered': 20.0, 'priceeach': 58.17, 'buyprice': 38.58, 'id_customers': 174.0, 'id_products': 306, 'id_time': 659, 'id_emp': 67})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 43285)
[2022-06-20 00:25:43,055] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:25:43,396] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:26:37,857] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:26:37,879] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:26:37,880] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:26:37,880] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:26:37,880] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:26:37,900] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:26:37,912] {standard_task_runner.py:52} INFO - Started process 44621 to run task
[2022-06-20 00:26:37,917] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '310', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp10miiaxc', '--error-file', '/tmp/tmpk6_u6bgg']
[2022-06-20 00:26:37,917] {standard_task_runner.py:80} INFO - Job 310: Subtask load_fato
[2022-06-20 00:26:37,992] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:26:38,093] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:26:38,218] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (9, null, 487, 1323, 109, 55, 95.89, 66.92).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (9, null, 487, 1323, 109, 55, 95.89, 66.92).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 32.0, 'priceeach': 100.01, 'buyprice': 56.13, 'id_customers': 205.0, 'id_products': 481, 'id_time': 1265, 'id_emp': 112}, {'quantityordered': 55.0, 'priceeach': 95.89, 'buyprice': 66.92, 'id_customers': None, 'id_products': 487, 'id_time': 1323, 'id_emp': 109}, {'quantityordered': 48.0, 'priceeach': 60.97, 'buyprice': 34.25, 'id_customers': None, 'id_products': 451, 'id_time': 1438, 'id_emp': 106}, {'quantityordered': 38.0, 'priceeach': 50.31, 'buyprice': 29.18, 'id_customers': 232.0, 'id_products': 457, 'id_time': 1400, 'id_emp': 93}, {'quantityordered': 20.0, 'priceeach': 58.17, 'buyprice': 38.58, 'id_customers': 222.0, 'id_products': 526, 'id_time': 1277, 'id_emp': 111}, {'quantityordered': 24.0, 'priceeach': 76.73, 'buyprice': 51.15, 'id_customers': None, 'id_products': 525, 'id_time': 1447, 'id_emp': 103}, {'quantityordered': 49.0, 'priceeach': 133.28, 'buyprice': 85.68, 'id_customers': 226.0, 'id_products': 461, 'id_time': 1306, 'id_emp': 113}, {'quantityordered': 37.0, 'priceeach': 110.88, 'buyprice': 56.76, 'id_customers': None, 'id_products': 496, 'id_time': 1483, 'id_emp': 102}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 48.0, 'priceeach': 95.44, 'buyprice': 57.46, 'id_customers': None, 'id_products': 507, 'id_time': 1462, 'id_emp': 96}, {'quantityordered': 22.0, 'priceeach': 64.44, 'buyprice': 26.3, 'id_customers': 223.0, 'id_products': 545, 'id_time': 1397, 'id_emp': 111})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 00:26:38,244] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T032637, end_date=20220620T032638
[2022-06-20 00:26:38,265] {standard_task_runner.py:92} ERROR - Failed to execute job 310 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (9, null, 487, 1323, 109, 55, 95.89, 66.92).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 32.0, 'priceeach': 100.01, 'buyprice': 56.13, 'id_customers': 205.0, 'id_products': 481, 'id_time': 1265, 'id_emp': 112}, {'quantityordered': 55.0, 'priceeach': 95.89, 'buyprice': 66.92, 'id_customers': None, 'id_products': 487, 'id_time': 1323, 'id_emp': 109}, {'quantityordered': 48.0, 'priceeach': 60.97, 'buyprice': 34.25, 'id_customers': None, 'id_products': 451, 'id_time': 1438, 'id_emp': 106}, {'quantityordered': 38.0, 'priceeach': 50.31, 'buyprice': 29.18, 'id_customers': 232.0, 'id_products': 457, 'id_time': 1400, 'id_emp': 93}, {'quantityordered': 20.0, 'priceeach': 58.17, 'buyprice': 38.58, 'id_customers': 222.0, 'id_products': 526, 'id_time': 1277, 'id_emp': 111}, {'quantityordered': 24.0, 'priceeach': 76.73, 'buyprice': 51.15, 'id_customers': None, 'id_products': 525, 'id_time': 1447, 'id_emp': 103}, {'quantityordered': 49.0, 'priceeach': 133.28, 'buyprice': 85.68, 'id_customers': 226.0, 'id_products': 461, 'id_time': 1306, 'id_emp': 113}, {'quantityordered': 37.0, 'priceeach': 110.88, 'buyprice': 56.76, 'id_customers': None, 'id_products': 496, 'id_time': 1483, 'id_emp': 102}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 48.0, 'priceeach': 95.44, 'buyprice': 57.46, 'id_customers': None, 'id_products': 507, 'id_time': 1462, 'id_emp': 96}, {'quantityordered': 22.0, 'priceeach': 64.44, 'buyprice': 26.3, 'id_customers': 223.0, 'id_products': 545, 'id_time': 1397, 'id_emp': 111})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 44621)
[2022-06-20 00:26:38,289] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:26:38,346] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:34:25,309] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:34:25,332] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:34:25,332] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:34:25,332] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:34:25,332] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:34:25,354] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:34:25,368] {standard_task_runner.py:52} INFO - Started process 51093 to run task
[2022-06-20 00:34:25,374] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '371', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpfadcxlil', '--error-file', '/tmp/tmpzgyutyaq']
[2022-06-20 00:34:25,374] {standard_task_runner.py:80} INFO - Job 371: Subtask load_fato
[2022-06-20 00:34:25,465] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:34:25,587] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:34:25,726] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (12, null, 66, 1648, 119, 48, 51.75, 24.26).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (12, null, 66, 1648, 119, 48, 51.75, 24.26).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 55.0, 'priceeach': 136.7, 'buyprice': 73.49, 'id_customers': 425.0, 'id_products': 8, 'id_time': 1777, 'id_emp': 117}, {'quantityordered': 36.0, 'priceeach': 117.82, 'buyprice': 74.86, 'id_customers': 420.0, 'id_products': 57, 'id_time': 1629, 'id_emp': 130}, {'quantityordered': 48.0, 'priceeach': 51.75, 'buyprice': 24.26, 'id_customers': None, 'id_products': 66, 'id_time': 1648, 'id_emp': 119}, {'quantityordered': 24.0, 'priceeach': 59.56, 'buyprice': 47.1, 'id_customers': None, 'id_products': 61, 'id_time': 1584, 'id_emp': 128}, {'quantityordered': 46.0, 'priceeach': 100.58, 'buyprice': 64.58, 'id_customers': 419.0, 'id_products': 38, 'id_time': 1743, 'id_emp': 135}, {'quantityordered': 48.0, 'priceeach': 114.14, 'buyprice': 74.86, 'id_customers': 392.0, 'id_products': 57, 'id_time': 1708, 'id_emp': 122}, {'quantityordered': 49.0, 'priceeach': 52.36, 'buyprice': 33.61, 'id_customers': 415.0, 'id_products': 100, 'id_time': 1710, 'id_emp': 136}, {'quantityordered': 24.0, 'priceeach': 129.93, 'buyprice': 89.14, 'id_customers': None, 'id_products': 107, 'id_time': 1814, 'id_emp': 119}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 34.0, 'priceeach': 91.02, 'buyprice': 62.11, 'id_customers': None, 'id_products': 62, 'id_time': 1634, 'id_emp': 126}, {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 29.18, 'id_customers': None, 'id_products': 71, 'id_time': 1792, 'id_emp': 125})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 00:34:25,755] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T033425, end_date=20220620T033425
[2022-06-20 00:34:25,780] {standard_task_runner.py:92} ERROR - Failed to execute job 371 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (12, null, 66, 1648, 119, 48, 51.75, 24.26).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 55.0, 'priceeach': 136.7, 'buyprice': 73.49, 'id_customers': 425.0, 'id_products': 8, 'id_time': 1777, 'id_emp': 117}, {'quantityordered': 36.0, 'priceeach': 117.82, 'buyprice': 74.86, 'id_customers': 420.0, 'id_products': 57, 'id_time': 1629, 'id_emp': 130}, {'quantityordered': 48.0, 'priceeach': 51.75, 'buyprice': 24.26, 'id_customers': None, 'id_products': 66, 'id_time': 1648, 'id_emp': 119}, {'quantityordered': 24.0, 'priceeach': 59.56, 'buyprice': 47.1, 'id_customers': None, 'id_products': 61, 'id_time': 1584, 'id_emp': 128}, {'quantityordered': 46.0, 'priceeach': 100.58, 'buyprice': 64.58, 'id_customers': 419.0, 'id_products': 38, 'id_time': 1743, 'id_emp': 135}, {'quantityordered': 48.0, 'priceeach': 114.14, 'buyprice': 74.86, 'id_customers': 392.0, 'id_products': 57, 'id_time': 1708, 'id_emp': 122}, {'quantityordered': 49.0, 'priceeach': 52.36, 'buyprice': 33.61, 'id_customers': 415.0, 'id_products': 100, 'id_time': 1710, 'id_emp': 136}, {'quantityordered': 24.0, 'priceeach': 129.93, 'buyprice': 89.14, 'id_customers': None, 'id_products': 107, 'id_time': 1814, 'id_emp': 119}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 34.0, 'priceeach': 91.02, 'buyprice': 62.11, 'id_customers': None, 'id_products': 62, 'id_time': 1634, 'id_emp': 126}, {'quantityordered': 26.0, 'priceeach': 40.25, 'buyprice': 29.18, 'id_customers': None, 'id_products': 71, 'id_time': 1792, 'id_emp': 125})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 51093)
[2022-06-20 00:34:25,828] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:34:25,902] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:25:23,503] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:25:23,525] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:25:23,525] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:25:23,525] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:25:23,525] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:25:23,547] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:25:23,557] {standard_task_runner.py:52} INFO - Started process 79619 to run task
[2022-06-20 01:25:23,563] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '535', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp5m6q0t6u', '--error-file', '/tmp/tmp757d112o']
[2022-06-20 01:25:23,564] {standard_task_runner.py:80} INFO - Job 535: Subtask load_fato
[2022-06-20 01:25:23,650] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:25:23,773] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:25:30,376] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (13, null, 428, 3940, 148, 30, 76.8, 32.33).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 153, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (13, null, 428, 3940, 148, 30, 76.8, 32.33).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 30.0, 'priceeach': 76.8, 'buyprice': 32.33, 'id_customers': None, 'id_products': 428, 'id_time': 3940, 'id_emp': 148}, {'quantityordered': 20.0, 'priceeach': 47.29, 'buyprice': 29.18, 'id_customers': None, 'id_products': 237, 'id_time': 3173, 'id_emp': 164}, {'quantityordered': 48.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': None, 'id_products': 364, 'id_time': 3899, 'id_emp': 210}, {'quantityordered': 29.0, 'priceeach': 57.86, 'buyprice': 26.3, 'id_customers': 746.0, 'id_products': 325, 'id_time': 3805, 'id_emp': 221}, {'quantityordered': 44.0, 'priceeach': 76.0, 'buyprice': 54.4, 'id_customers': 704.0, 'id_products': 159, 'id_time': 3148, 'id_emp': 177}, {'quantityordered': 40.0, 'priceeach': 48.55, 'buyprice': 32.37, 'id_customers': 629.0, 'id_products': 362, 'id_time': 3184, 'id_emp': 158}, {'quantityordered': 21.0, 'priceeach': 167.65, 'buyprice': 77.9, 'id_customers': None, 'id_products': 437, 'id_time': 3264, 'id_emp': 141}, {'quantityordered': 37.0, 'priceeach': 90.75, 'buyprice': 68.8, 'id_customers': None, 'id_products': 251, 'id_time': 3229, 'id_emp': 149}  ... displaying 10 of 263592 total bound parameter sets ...  {'quantityordered': 20.0, 'priceeach': 169.34, 'buyprice': 77.9, 'id_customers': 764.0, 'id_products': 327, 'id_time': 3967, 'id_emp': 223}, {'quantityordered': 21.0, 'priceeach': 139.03, 'buyprice': 98.3, 'id_customers': 685.0, 'id_products': 123, 'id_time': 3119, 'id_emp': 204})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 01:25:30,712] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T042523, end_date=20220620T042530
[2022-06-20 01:25:30,732] {standard_task_runner.py:92} ERROR - Failed to execute job 535 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (13, null, 428, 3940, 148, 30, 76.8, 32.33).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 30.0, 'priceeach': 76.8, 'buyprice': 32.33, 'id_customers': None, 'id_products': 428, 'id_time': 3940, 'id_emp': 148}, {'quantityordered': 20.0, 'priceeach': 47.29, 'buyprice': 29.18, 'id_customers': None, 'id_products': 237, 'id_time': 3173, 'id_emp': 164}, {'quantityordered': 48.0, 'priceeach': 35.29, 'buyprice': 21.75, 'id_customers': None, 'id_products': 364, 'id_time': 3899, 'id_emp': 210}, {'quantityordered': 29.0, 'priceeach': 57.86, 'buyprice': 26.3, 'id_customers': 746.0, 'id_products': 325, 'id_time': 3805, 'id_emp': 221}, {'quantityordered': 44.0, 'priceeach': 76.0, 'buyprice': 54.4, 'id_customers': 704.0, 'id_products': 159, 'id_time': 3148, 'id_emp': 177}, {'quantityordered': 40.0, 'priceeach': 48.55, 'buyprice': 32.37, 'id_customers': 629.0, 'id_products': 362, 'id_time': 3184, 'id_emp': 158}, {'quantityordered': 21.0, 'priceeach': 167.65, 'buyprice': 77.9, 'id_customers': None, 'id_products': 437, 'id_time': 3264, 'id_emp': 141}, {'quantityordered': 37.0, 'priceeach': 90.75, 'buyprice': 68.8, 'id_customers': None, 'id_products': 251, 'id_time': 3229, 'id_emp': 149}  ... displaying 10 of 263592 total bound parameter sets ...  {'quantityordered': 20.0, 'priceeach': 169.34, 'buyprice': 77.9, 'id_customers': 764.0, 'id_products': 327, 'id_time': 3967, 'id_emp': 223}, {'quantityordered': 21.0, 'priceeach': 139.03, 'buyprice': 98.3, 'id_customers': 685.0, 'id_products': 123, 'id_time': 3119, 'id_emp': 204})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 79619)
[2022-06-20 01:25:30,795] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 01:25:32,025] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:28:05,301] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:28:05,322] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:28:05,323] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:28:05,323] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:28:05,323] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:28:05,346] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:28:05,358] {standard_task_runner.py:52} INFO - Started process 82619 to run task
[2022-06-20 01:28:05,364] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '563', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmphr428l3z', '--error-file', '/tmp/tmpk4y320m0']
[2022-06-20 01:28:05,365] {standard_task_runner.py:80} INFO - Job 563: Subtask load_fato
[2022-06-20 01:28:05,455] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:28:05,572] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:28:05,712] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (17, null, 496, 4239, 241, 40, 117.48, 56.76).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 153, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (17, null, 496, 4239, 241, 40, 117.48, 56.76).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 41.0, 'priceeach': 54.34, 'buyprice': 34.35, 'id_customers': 777.0, 'id_products': 447, 'id_time': 4110, 'id_emp': 237}, {'quantityordered': 21.0, 'priceeach': 79.2, 'buyprice': 54.4, 'id_customers': 813.0, 'id_products': 489, 'id_time': 4298, 'id_emp': 250}, {'quantityordered': 37.0, 'priceeach': 60.77, 'buyprice': 24.92, 'id_customers': 815.0, 'id_products': 468, 'id_time': 4141, 'id_emp': 251}, {'quantityordered': 40.0, 'priceeach': 117.48, 'buyprice': 56.76, 'id_customers': None, 'id_products': 496, 'id_time': 4239, 'id_emp': 241}, {'quantityordered': 45.0, 'priceeach': 102.04, 'buyprice': 59.33, 'id_customers': 804.0, 'id_products': 500, 'id_time': 4232, 'id_emp': 242}, {'quantityordered': 44.0, 'priceeach': 59.22, 'buyprice': 36.27, 'id_customers': None, 'id_products': 492, 'id_time': 4156, 'id_emp': 241}, {'quantityordered': 30.0, 'priceeach': 59.55, 'buyprice': 24.92, 'id_customers': None, 'id_products': 468, 'id_time': 4083, 'id_emp': 236}, {'quantityordered': 47.0, 'priceeach': 145.04, 'buyprice': 89.14, 'id_customers': 783.0, 'id_products': 498, 'id_time': 4076, 'id_emp': 250}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 44.0, 'priceeach': 72.41, 'buyprice': 34.17, 'id_customers': None, 'id_products': 469, 'id_time': 4226, 'id_emp': 248}, {'quantityordered': 21.0, 'priceeach': 105.94, 'buyprice': 60.86, 'id_customers': None, 'id_products': 508, 'id_time': 4323, 'id_emp': 241})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 01:28:05,740] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T042805, end_date=20220620T042805
[2022-06-20 01:28:05,766] {standard_task_runner.py:92} ERROR - Failed to execute job 563 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (17, null, 496, 4239, 241, 40, 117.48, 56.76).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 41.0, 'priceeach': 54.34, 'buyprice': 34.35, 'id_customers': 777.0, 'id_products': 447, 'id_time': 4110, 'id_emp': 237}, {'quantityordered': 21.0, 'priceeach': 79.2, 'buyprice': 54.4, 'id_customers': 813.0, 'id_products': 489, 'id_time': 4298, 'id_emp': 250}, {'quantityordered': 37.0, 'priceeach': 60.77, 'buyprice': 24.92, 'id_customers': 815.0, 'id_products': 468, 'id_time': 4141, 'id_emp': 251}, {'quantityordered': 40.0, 'priceeach': 117.48, 'buyprice': 56.76, 'id_customers': None, 'id_products': 496, 'id_time': 4239, 'id_emp': 241}, {'quantityordered': 45.0, 'priceeach': 102.04, 'buyprice': 59.33, 'id_customers': 804.0, 'id_products': 500, 'id_time': 4232, 'id_emp': 242}, {'quantityordered': 44.0, 'priceeach': 59.22, 'buyprice': 36.27, 'id_customers': None, 'id_products': 492, 'id_time': 4156, 'id_emp': 241}, {'quantityordered': 30.0, 'priceeach': 59.55, 'buyprice': 24.92, 'id_customers': None, 'id_products': 468, 'id_time': 4083, 'id_emp': 236}, {'quantityordered': 47.0, 'priceeach': 145.04, 'buyprice': 89.14, 'id_customers': 783.0, 'id_products': 498, 'id_time': 4076, 'id_emp': 250}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 44.0, 'priceeach': 72.41, 'buyprice': 34.17, 'id_customers': None, 'id_products': 469, 'id_time': 4226, 'id_emp': 248}, {'quantityordered': 21.0, 'priceeach': 105.94, 'buyprice': 60.86, 'id_customers': None, 'id_products': 508, 'id_time': 4323, 'id_emp': 241})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 82619)
[2022-06-20 01:28:05,818] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 01:28:05,888] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:32:45,986] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:32:46,009] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:32:46,009] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:32:46,009] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:32:46,009] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:32:46,032] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:32:46,041] {standard_task_runner.py:52} INFO - Started process 84710 to run task
[2022-06-20 01:32:46,048] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '581', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpm1c7r36u', '--error-file', '/tmp/tmpd_4a836h']
[2022-06-20 01:32:46,048] {standard_task_runner.py:80} INFO - Job 581: Subtask load_fato
[2022-06-20 01:32:46,132] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:32:46,252] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:32:46,393] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (18, null, 616, 4454, 266, 32, 70.08, 37.32).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 153, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (18, null, 616, 4454, 266, 32, 70.08, 37.32).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 32.0, 'priceeach': 70.08, 'buyprice': 37.32, 'id_customers': None, 'id_products': 616, 'id_time': 4454, 'id_emp': 266}, {'quantityordered': 26.0, 'priceeach': 38.57, 'buyprice': 21.75, 'id_customers': 826.0, 'id_products': 584, 'id_time': 4488, 'id_emp': 269}, {'quantityordered': 33.0, 'priceeach': 88.3, 'buyprice': 57.54, 'id_customers': None, 'id_products': 621, 'id_time': 4599, 'id_emp': 266}, {'quantityordered': 37.0, 'priceeach': 113.92, 'buyprice': 75.16, 'id_customers': None, 'id_products': 631, 'id_time': 4366, 'id_emp': 263}, {'quantityordered': 33.0, 'priceeach': 35.78, 'buyprice': 27.06, 'id_customers': None, 'id_products': 647, 'id_time': 4414, 'id_emp': 266}, {'quantityordered': 33.0, 'priceeach': 102.17, 'buyprice': 72.82, 'id_customers': None, 'id_products': 634, 'id_time': 4614, 'id_emp': 263}, {'quantityordered': 22.0, 'priceeach': 86.73, 'buyprice': 62.11, 'id_customers': None, 'id_products': 572, 'id_time': 4514, 'id_emp': 266}, {'quantityordered': 40.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': None, 'id_products': 622, 'id_time': 4356, 'id_emp': 259}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 45.0, 'priceeach': 97.1, 'buyprice': 46.53, 'id_customers': None, 'id_products': 592, 'id_time': 4463, 'id_emp': 270}, {'quantityordered': 26.0, 'priceeach': 32.19, 'buyprice': 22.57, 'id_customers': 839.0, 'id_products': 639, 'id_time': 4590, 'id_emp': 255})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 01:32:46,422] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T043245, end_date=20220620T043246
[2022-06-20 01:32:46,452] {standard_task_runner.py:92} ERROR - Failed to execute job 581 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (18, null, 616, 4454, 266, 32, 70.08, 37.32).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 32.0, 'priceeach': 70.08, 'buyprice': 37.32, 'id_customers': None, 'id_products': 616, 'id_time': 4454, 'id_emp': 266}, {'quantityordered': 26.0, 'priceeach': 38.57, 'buyprice': 21.75, 'id_customers': 826.0, 'id_products': 584, 'id_time': 4488, 'id_emp': 269}, {'quantityordered': 33.0, 'priceeach': 88.3, 'buyprice': 57.54, 'id_customers': None, 'id_products': 621, 'id_time': 4599, 'id_emp': 266}, {'quantityordered': 37.0, 'priceeach': 113.92, 'buyprice': 75.16, 'id_customers': None, 'id_products': 631, 'id_time': 4366, 'id_emp': 263}, {'quantityordered': 33.0, 'priceeach': 35.78, 'buyprice': 27.06, 'id_customers': None, 'id_products': 647, 'id_time': 4414, 'id_emp': 266}, {'quantityordered': 33.0, 'priceeach': 102.17, 'buyprice': 72.82, 'id_customers': None, 'id_products': 634, 'id_time': 4614, 'id_emp': 263}, {'quantityordered': 22.0, 'priceeach': 86.73, 'buyprice': 62.11, 'id_customers': None, 'id_products': 572, 'id_time': 4514, 'id_emp': 266}, {'quantityordered': 40.0, 'priceeach': 36.29, 'buyprice': 20.61, 'id_customers': None, 'id_products': 622, 'id_time': 4356, 'id_emp': 259}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 45.0, 'priceeach': 97.1, 'buyprice': 46.53, 'id_customers': None, 'id_products': 592, 'id_time': 4463, 'id_emp': 270}, {'quantityordered': 26.0, 'priceeach': 32.19, 'buyprice': 22.57, 'id_customers': 839.0, 'id_products': 639, 'id_time': 4590, 'id_emp': 255})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 84710)
[2022-06-20 01:32:46,499] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 01:32:46,571] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:50:39,698] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:50:39,721] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:50:39,721] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:50:39,721] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:50:39,721] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:50:39,743] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:50:39,753] {standard_task_runner.py:52} INFO - Started process 90570 to run task
[2022-06-20 01:50:39,759] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '616', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpihp6vdut', '--error-file', '/tmp/tmpod1hdpx0']
[2022-06-20 01:50:39,760] {standard_task_runner.py:80} INFO - Job 616: Subtask load_fato
[2022-06-20 01:50:39,854] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:50:39,982] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:50:40,130] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (21, null, 83, 306, 11, 28, 58.47, 33.02).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 153, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (21, null, 83, 306, 11, 28, 58.47, 33.02).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 30.0, 'priceeach': 139.64, 'buyprice': 73.49, 'id_customers': 30.0, 'id_products': 2, 'id_time': 41, 'id_emp': 21}, {'quantityordered': 44.0, 'priceeach': 71.56, 'buyprice': 33.97, 'id_customers': 43.0, 'id_products': 92, 'id_time': 230, 'id_emp': 12}, {'quantityordered': 28.0, 'priceeach': 58.47, 'buyprice': 33.02, 'id_customers': None, 'id_products': 83, 'id_time': 306, 'id_emp': 11}, {'quantityordered': 30.0, 'priceeach': 57.73, 'buyprice': 24.92, 'id_customers': None, 'id_products': 28, 'id_time': 113, 'id_emp': 11}, {'quantityordered': 23.0, 'priceeach': 85.76, 'buyprice': 68.8, 'id_customers': 21.0, 'id_products': 31, 'id_time': 153, 'id_emp': 3}, {'quantityordered': 33.0, 'priceeach': 55.27, 'buyprice': 29.34, 'id_customers': 35.0, 'id_products': 53, 'id_time': 285, 'id_emp': 20}, {'quantityordered': 37.0, 'priceeach': 72.02, 'buyprice': 49.24, 'id_customers': 9.0, 'id_products': 95, 'id_time': 2, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 73.32, 'buyprice': 39.83, 'id_customers': 23.0, 'id_products': 20, 'id_time': 3, 'id_emp': 2}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 42.0, 'priceeach': 49.67, 'buyprice': 24.23, 'id_customers': 8.0, 'id_products': 27, 'id_time': 24, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 199.3, 'buyprice': 98.58, 'id_customers': 44.0, 'id_products': 9, 'id_time': 235, 'id_emp': 16})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 01:50:40,157] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T045039, end_date=20220620T045040
[2022-06-20 01:50:40,181] {standard_task_runner.py:92} ERROR - Failed to execute job 616 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (21, null, 83, 306, 11, 28, 58.47, 33.02).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 30.0, 'priceeach': 139.64, 'buyprice': 73.49, 'id_customers': 30.0, 'id_products': 2, 'id_time': 41, 'id_emp': 21}, {'quantityordered': 44.0, 'priceeach': 71.56, 'buyprice': 33.97, 'id_customers': 43.0, 'id_products': 92, 'id_time': 230, 'id_emp': 12}, {'quantityordered': 28.0, 'priceeach': 58.47, 'buyprice': 33.02, 'id_customers': None, 'id_products': 83, 'id_time': 306, 'id_emp': 11}, {'quantityordered': 30.0, 'priceeach': 57.73, 'buyprice': 24.92, 'id_customers': None, 'id_products': 28, 'id_time': 113, 'id_emp': 11}, {'quantityordered': 23.0, 'priceeach': 85.76, 'buyprice': 68.8, 'id_customers': 21.0, 'id_products': 31, 'id_time': 153, 'id_emp': 3}, {'quantityordered': 33.0, 'priceeach': 55.27, 'buyprice': 29.34, 'id_customers': 35.0, 'id_products': 53, 'id_time': 285, 'id_emp': 20}, {'quantityordered': 37.0, 'priceeach': 72.02, 'buyprice': 49.24, 'id_customers': 9.0, 'id_products': 95, 'id_time': 2, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 73.32, 'buyprice': 39.83, 'id_customers': 23.0, 'id_products': 20, 'id_time': 3, 'id_emp': 2}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 42.0, 'priceeach': 49.67, 'buyprice': 24.23, 'id_customers': 8.0, 'id_products': 27, 'id_time': 24, 'id_emp': 7}, {'quantityordered': 32.0, 'priceeach': 199.3, 'buyprice': 98.58, 'id_customers': 44.0, 'id_products': 9, 'id_time': 235, 'id_emp': 16})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 90570)
[2022-06-20 01:50:40,211] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 01:50:40,273] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 02:29:10,904] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 02:29:10,918] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 02:29:10,918] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 02:29:10,918] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 02:29:10,918] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 02:29:10,931] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 02:29:10,937] {standard_task_runner.py:52} INFO - Started process 100859 to run task
[2022-06-20 02:29:10,942] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '665', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp_8iebegc', '--error-file', '/tmp/tmp6ndryerc']
[2022-06-20 02:29:10,943] {standard_task_runner.py:80} INFO - Job 665: Subtask load_fato
[2022-06-20 02:29:11,011] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 02:29:11,100] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 02:29:11,191] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (23, null, 164, 326, 29, 36, 55.09, 33.3).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 153, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (23, null, 164, 326, 29, 36, 55.09, 33.3).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 33.0, 'priceeach': 154.93, 'buyprice': 91.02, 'id_customers': 88.0, 'id_products': 220, 'id_time': 352, 'id_emp': 24}, {'quantityordered': 36.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': None, 'id_products': 164, 'id_time': 326, 'id_emp': 29}, {'quantityordered': 42.0, 'priceeach': 100.3, 'buyprice': 60.78, 'id_customers': 85.0, 'id_products': 145, 'id_time': 593, 'id_emp': 44}, {'quantityordered': 46.0, 'priceeach': 84.22, 'buyprice': 48.81, 'id_customers': 56.0, 'id_products': 169, 'id_time': 333, 'id_emp': 38}, {'quantityordered': 46.0, 'priceeach': 61.58, 'buyprice': 36.23, 'id_customers': None, 'id_products': 146, 'id_time': 520, 'id_emp': 34}, {'quantityordered': 20.0, 'priceeach': 26.55, 'buyprice': 22.57, 'id_customers': 57.0, 'id_products': 199, 'id_time': 325, 'id_emp': 35}, {'quantityordered': 43.0, 'priceeach': 94.25, 'buyprice': 60.74, 'id_customers': 75.0, 'id_products': 122, 'id_time': 362, 'id_emp': 39}, {'quantityordered': 36.0, 'priceeach': 75.13, 'buyprice': 39.83, 'id_customers': None, 'id_products': 130, 'id_time': 337, 'id_emp': 33}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 35.0, 'priceeach': 80.91, 'buyprice': 66.92, 'id_customers': None, 'id_products': 157, 'id_time': 423, 'id_emp': 37}, {'quantityordered': 31.0, 'priceeach': 50.36, 'buyprice': 32.95, 'id_customers': None, 'id_products': 140, 'id_time': 314, 'id_emp': 41})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 02:29:11,209] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T052910, end_date=20220620T052911
[2022-06-20 02:29:11,228] {standard_task_runner.py:92} ERROR - Failed to execute job 665 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (23, null, 164, 326, 29, 36, 55.09, 33.3).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 33.0, 'priceeach': 154.93, 'buyprice': 91.02, 'id_customers': 88.0, 'id_products': 220, 'id_time': 352, 'id_emp': 24}, {'quantityordered': 36.0, 'priceeach': 55.09, 'buyprice': 33.3, 'id_customers': None, 'id_products': 164, 'id_time': 326, 'id_emp': 29}, {'quantityordered': 42.0, 'priceeach': 100.3, 'buyprice': 60.78, 'id_customers': 85.0, 'id_products': 145, 'id_time': 593, 'id_emp': 44}, {'quantityordered': 46.0, 'priceeach': 84.22, 'buyprice': 48.81, 'id_customers': 56.0, 'id_products': 169, 'id_time': 333, 'id_emp': 38}, {'quantityordered': 46.0, 'priceeach': 61.58, 'buyprice': 36.23, 'id_customers': None, 'id_products': 146, 'id_time': 520, 'id_emp': 34}, {'quantityordered': 20.0, 'priceeach': 26.55, 'buyprice': 22.57, 'id_customers': 57.0, 'id_products': 199, 'id_time': 325, 'id_emp': 35}, {'quantityordered': 43.0, 'priceeach': 94.25, 'buyprice': 60.74, 'id_customers': 75.0, 'id_products': 122, 'id_time': 362, 'id_emp': 39}, {'quantityordered': 36.0, 'priceeach': 75.13, 'buyprice': 39.83, 'id_customers': None, 'id_products': 130, 'id_time': 337, 'id_emp': 33}  ... displaying 10 of 3690 total bound parameter sets ...  {'quantityordered': 35.0, 'priceeach': 80.91, 'buyprice': 66.92, 'id_customers': None, 'id_products': 157, 'id_time': 423, 'id_emp': 37}, {'quantityordered': 31.0, 'priceeach': 50.36, 'buyprice': 32.95, 'id_customers': None, 'id_products': 140, 'id_time': 314, 'id_emp': 41})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 100859)
[2022-06-20 02:29:11,272] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 02:29:11,320] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 03:25:23,790] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:25:23,805] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:25:23,805] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:25:23,805] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 03:25:23,805] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:25:23,816] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 03:25:23,821] {standard_task_runner.py:52} INFO - Started process 111221 to run task
[2022-06-20 03:25:23,825] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '683', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmphrqzn5g9', '--error-file', '/tmp/tmptuderk5h']
[2022-06-20 03:25:23,826] {standard_task_runner.py:80} INFO - Job 683: Subtask load_fato
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [2022-06-20 03:39:12,666] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:39:12,686] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:39:12,686] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:39:12,686] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 03:39:12,686] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:39:12,707] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 03:39:12,714] {standard_task_runner.py:52} INFO - Started process 9267 to run task
[2022-06-20 03:39:12,720] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '717', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpna49ddvk', '--error-file', '/tmp/tmp9vz4dujd']
[2022-06-20 03:39:12,721] {standard_task_runner.py:80} INFO - Job 717: Subtask load_fato
[2022-06-20 03:39:12,804] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 03:39:12,914] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 03:39:13,057] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (57, null, 175, 533, 44, 43, 77.24, 52.66).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 153, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (57, null, 175, 533, 44, 43, 77.24, 52.66).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 43.0, 'priceeach': 77.24, 'buyprice': 52.66, 'id_customers': None, 'id_products': 175, 'id_time': 533.0, 'id_emp': 44}, {'quantityordered': 30.0, 'priceeach': 76.8, 'buyprice': 32.33, 'id_customers': None, 'id_products': 230, 'id_time': 562.0, 'id_emp': 51}, {'quantityordered': 20.0, 'priceeach': 50.88, 'buyprice': 24.23, 'id_customers': 102.0, 'id_products': 159, 'id_time': 545.0, 'id_emp': 45}, {'quantityordered': 23.0, 'priceeach': 80.84, 'buyprice': 32.33, 'id_customers': 90.0, 'id_products': 230, 'id_time': 596.0, 'id_emp': 49}, {'quantityordered': 33.0, 'priceeach': 99.52, 'buyprice': 64.58, 'id_customers': 114.0, 'id_products': 226, 'id_time': 622.0, 'id_emp': 48}, {'quantityordered': 50.0, 'priceeach': 50.86, 'buyprice': 25.98, 'id_customers': None, 'id_products': 158, 'id_time': 395.0, 'id_emp': 36}, {'quantityordered': 34.0, 'priceeach': 189.79, 'buyprice': 91.02, 'id_customers': 69.0, 'id_products': 242, 'id_time': 587.0, 'id_emp': 47}, {'quantityordered': 44.0, 'priceeach': 77.42, 'buyprice': 51.61, 'id_customers': 109.0, 'id_products': 183, 'id_time': None, 'id_emp': 45}  ... displaying 10 of 3863 total bound parameter sets ...  {'quantityordered': 38.0, 'priceeach': 69.52, 'buyprice': 32.33, 'id_customers': None, 'id_products': 230, 'id_time': 335.0, 'id_emp': 43}, {'quantityordered': 39.0, 'priceeach': 51.22, 'buyprice': 34.35, 'id_customers': 97.0, 'id_products': 139, 'id_time': 495.0, 'id_emp': 52})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 03:39:13,087] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T063912, end_date=20220620T063913
[2022-06-20 03:39:13,108] {standard_task_runner.py:92} ERROR - Failed to execute job 717 for task load_fato ((psycopg2.errors.NotNullViolation) null value in column "id_customers" violates not-null constraint
DETAIL:  Failing row contains (57, null, 175, 533, 44, 43, 77.24, 52.66).

[SQL: INSERT INTO fato (quantityordered, priceeach, buyprice, id_customers, id_products, id_time, id_emp) VALUES (%(quantityordered)s, %(priceeach)s, %(buyprice)s, %(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s)]
[parameters: ({'quantityordered': 43.0, 'priceeach': 77.24, 'buyprice': 52.66, 'id_customers': None, 'id_products': 175, 'id_time': 533.0, 'id_emp': 44}, {'quantityordered': 30.0, 'priceeach': 76.8, 'buyprice': 32.33, 'id_customers': None, 'id_products': 230, 'id_time': 562.0, 'id_emp': 51}, {'quantityordered': 20.0, 'priceeach': 50.88, 'buyprice': 24.23, 'id_customers': 102.0, 'id_products': 159, 'id_time': 545.0, 'id_emp': 45}, {'quantityordered': 23.0, 'priceeach': 80.84, 'buyprice': 32.33, 'id_customers': 90.0, 'id_products': 230, 'id_time': 596.0, 'id_emp': 49}, {'quantityordered': 33.0, 'priceeach': 99.52, 'buyprice': 64.58, 'id_customers': 114.0, 'id_products': 226, 'id_time': 622.0, 'id_emp': 48}, {'quantityordered': 50.0, 'priceeach': 50.86, 'buyprice': 25.98, 'id_customers': None, 'id_products': 158, 'id_time': 395.0, 'id_emp': 36}, {'quantityordered': 34.0, 'priceeach': 189.79, 'buyprice': 91.02, 'id_customers': 69.0, 'id_products': 242, 'id_time': 587.0, 'id_emp': 47}, {'quantityordered': 44.0, 'priceeach': 77.42, 'buyprice': 51.61, 'id_customers': 109.0, 'id_products': 183, 'id_time': None, 'id_emp': 45}  ... displaying 10 of 3863 total bound parameter sets ...  {'quantityordered': 38.0, 'priceeach': 69.52, 'buyprice': 32.33, 'id_customers': None, 'id_products': 230, 'id_time': 335.0, 'id_emp': 43}, {'quantityordered': 39.0, 'priceeach': 51.22, 'buyprice': 34.35, 'id_customers': 97.0, 'id_products': 139, 'id_time': 495.0, 'id_emp': 52})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 9267)
[2022-06-20 03:39:13,132] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 03:39:13,193] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 04:38:04,487] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 04:38:04,510] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 04:38:04,510] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 04:38:04,511] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 04:38:04,511] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 04:38:04,532] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 04:38:04,542] {standard_task_runner.py:52} INFO - Started process 19718 to run task
[2022-06-20 04:38:04,548] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '739', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpt8fm5vr1', '--error-file', '/tmp/tmpla09igv_']
[2022-06-20 04:38:04,548] {standard_task_runner.py:80} INFO - Job 739: Subtask load_fato
[2022-06-20 04:38:04,633] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 04:38:04,745] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 04:38:04,761] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column f.id_customers does not exist
LINE 1: ...fato f        left join dm_customers c        on  f.id_custo...
                                                             ^
HINT:  Perhaps you meant to reference the column "c.id_customers".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column f.id_customers does not exist
LINE 1: ...fato f        left join dm_customers c        on  f.id_custo...
                                                             ^
HINT:  Perhaps you meant to reference the column "c.id_customers".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,         id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f        left join dm_customers c        on  f.id_customers = c.id_customers        left join dm_products p        on   f.id_products = p.id_products          left join dm_time t        on f.id_time = t.id_time        left join dm_emp e        on   f.id_emp = e.id_emp]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 04:38:04,784] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T073804, end_date=20220620T073804
[2022-06-20 04:38:04,805] {standard_task_runner.py:92} ERROR - Failed to execute job 739 for task load_fato ((psycopg2.errors.UndefinedColumn) column f.id_customers does not exist
LINE 1: ...fato f        left join dm_customers c        on  f.id_custo...
                                                             ^
HINT:  Perhaps you meant to reference the column "c.id_customers".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,         id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f        left join dm_customers c        on  f.id_customers = c.id_customers        left join dm_products p        on   f.id_products = p.id_products          left join dm_time t        on f.id_time = t.id_time        left join dm_emp e        on   f.id_emp = e.id_emp]
(Background on this error at: http://sqlalche.me/e/14/f405); 19718)
[2022-06-20 04:38:04,839] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 04:38:04,892] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 12:27:48,162] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:27:48,183] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:27:48,183] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:27:48,183] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 12:27:48,184] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:27:48,203] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 12:27:48,212] {standard_task_runner.py:52} INFO - Started process 12057 to run task
[2022-06-20 12:27:48,219] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '102', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp39th3sav', '--error-file', '/tmp/tmp9yk8rq92']
[2022-06-20 12:27:48,219] {standard_task_runner.py:80} INFO - Job 102: Subtask load_fato
[2022-06-20 12:27:48,299] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 12:27:48,411] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 12:27:48,430] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column c.customernumber does not exist
LINE 1: ... dm_customers c            on  f.customerNumber = c.customer...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.customernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 143, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column c.customernumber does not exist
LINE 1: ... dm_customers c            on  f.customerNumber = c.customer...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.customernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 12:27:48,452] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T152748, end_date=20220620T152748
[2022-06-20 12:27:48,473] {standard_task_runner.py:92} ERROR - Failed to execute job 102 for task load_fato ((psycopg2.errors.UndefinedColumn) column c.customernumber does not exist
LINE 1: ... dm_customers c            on  f.customerNumber = c.customer...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.customernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 12057)
[2022-06-20 12:27:48,510] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 12:27:48,561] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 12:57:00,215] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:57:00,239] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:57:00,239] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:57:00,240] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 12:57:00,240] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:57:00,263] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 12:57:00,276] {standard_task_runner.py:52} INFO - Started process 18417 to run task
[2022-06-20 12:57:00,281] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '138', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpxwgyhyio', '--error-file', '/tmp/tmpx1x4kawp']
[2022-06-20 12:57:00,282] {standard_task_runner.py:80} INFO - Job 138: Subtask load_fato
[2022-06-20 12:57:00,370] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 12:57:00,484] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 12:57:00,502] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 143, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 12:57:00,522] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T155700, end_date=20220620T155700
[2022-06-20 12:57:00,541] {standard_task_runner.py:92} ERROR - Failed to execute job 138 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 18417)
[2022-06-20 12:57:00,573] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 12:57:00,626] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 13:00:13,349] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:00:13,370] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:00:13,370] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:00:13,370] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 13:00:13,370] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:00:13,392] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 13:00:13,403] {standard_task_runner.py:52} INFO - Started process 20297 to run task
[2022-06-20 13:00:13,409] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '157', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpc6h49o69', '--error-file', '/tmp/tmp9yfhspp8']
[2022-06-20 13:00:13,410] {standard_task_runner.py:80} INFO - Job 157: Subtask load_fato
[2022-06-20 13:00:13,499] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 13:00:13,618] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 13:00:13,635] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 143, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 13:00:13,653] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T160013, end_date=20220620T160013
[2022-06-20 13:00:13,675] {standard_task_runner.py:92} ERROR - Failed to execute job 157 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 20297)
[2022-06-20 13:00:13,701] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 13:00:13,754] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 13:45:32,344] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:45:32,364] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:45:32,365] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:45:32,365] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 13:45:32,365] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:45:32,385] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 13:45:32,397] {standard_task_runner.py:52} INFO - Started process 29766 to run task
[2022-06-20 13:45:32,402] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '176', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpexpsx8zu', '--error-file', '/tmp/tmpqfkbuys3']
[2022-06-20 13:45:32,403] {standard_task_runner.py:80} INFO - Job 176: Subtask load_fato
[2022-06-20 13:45:32,488] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 13:45:32,605] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 13:45:32,623] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 143, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 13:45:32,643] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T164532, end_date=20220620T164532
[2022-06-20 13:45:32,663] {standard_task_runner.py:92} ERROR - Failed to execute job 176 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 29766)
[2022-06-20 13:45:32,694] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 13:45:32,753] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:08:08,856] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:08:08,878] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:08:08,878] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:08:08,879] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:08:08,879] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:08:08,899] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:08:08,910] {standard_task_runner.py:52} INFO - Started process 37060 to run task
[2022-06-20 14:08:08,914] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '211', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp9ugzn73f', '--error-file', '/tmp/tmpzki3hwzm']
[2022-06-20 14:08:08,915] {standard_task_runner.py:80} INFO - Job 211: Subtask load_fato
[2022-06-20 14:08:09,000] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:08:09,109] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:08:09,126] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 143, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 14:08:09,145] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T170808, end_date=20220620T170809
[2022-06-20 14:08:09,165] {standard_task_runner.py:92} ERROR - Failed to execute job 211 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 37060)
[2022-06-20 14:08:09,206] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:08:09,264] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:16:35,942] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:16:35,965] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:16:35,966] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:16:35,966] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:16:35,966] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:16:35,987] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:16:35,996] {standard_task_runner.py:52} INFO - Started process 41289 to run task
[2022-06-20 14:16:36,001] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '248', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmppxp9ymhv', '--error-file', '/tmp/tmpd5ejlcvb']
[2022-06-20 14:16:36,002] {standard_task_runner.py:80} INFO - Job 248: Subtask load_fato
[2022-06-20 14:16:36,084] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:16:36,204] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:16:36,223] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 143, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 14:16:36,242] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T171635, end_date=20220620T171636
[2022-06-20 14:16:36,261] {standard_task_runner.py:92} ERROR - Failed to execute job 248 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 41289)
[2022-06-20 14:16:36,292] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:16:36,342] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:46:47,926] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:46:47,946] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:46:47,946] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:46:47,946] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:46:47,946] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:46:47,967] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:46:47,978] {standard_task_runner.py:52} INFO - Started process 54707 to run task
[2022-06-20 14:46:47,985] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '334', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpyl8rft14', '--error-file', '/tmp/tmplthwglwy']
[2022-06-20 14:46:47,985] {standard_task_runner.py:80} INFO - Job 334: Subtask load_fato
[2022-06-20 14:46:48,072] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:46:48,202] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:46:48,221] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 142, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 14:46:48,244] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T174647, end_date=20220620T174648
[2022-06-20 14:46:48,263] {standard_task_runner.py:92} ERROR - Failed to execute job 334 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 54707)
[2022-06-20 14:46:48,316] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:46:48,371] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:35:36,878] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:35:36,899] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:35:36,899] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:35:36,899] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:35:36,899] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:35:36,920] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:35:36,930] {standard_task_runner.py:52} INFO - Started process 62897 to run task
[2022-06-20 15:35:36,935] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '368', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmptkcay25f', '--error-file', '/tmp/tmpacx6ebuh']
[2022-06-20 15:35:36,935] {standard_task_runner.py:80} INFO - Job 368: Subtask load_fato
[2022-06-20 15:35:37,025] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:35:37,138] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:35:37,158] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 15:35:37,178] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T183536, end_date=20220620T183537
[2022-06-20 15:35:37,198] {standard_task_runner.py:92} ERROR - Failed to execute job 368 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 62897)
[2022-06-20 15:35:37,226] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 15:35:37,276] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:42:00,082] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:42:00,102] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:42:00,103] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:42:00,103] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:42:00,103] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:42:00,123] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:42:00,135] {standard_task_runner.py:52} INFO - Started process 65329 to run task
[2022-06-20 15:42:00,140] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '386', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmph2x_qepw', '--error-file', '/tmp/tmpa2kn6qmx']
[2022-06-20 15:42:00,141] {standard_task_runner.py:80} INFO - Job 386: Subtask load_fato
[2022-06-20 15:42:00,223] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:42:00,328] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:42:00,346] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 15:42:00,364] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T184200, end_date=20220620T184200
[2022-06-20 15:42:00,382] {standard_task_runner.py:92} ERROR - Failed to execute job 386 for task load_fato ((psycopg2.errors.UndefinedColumn) column t.ordernumber does not exist
LINE 1: ...left join dm_time t            on f.ordernumber = t.ordernum...
                                                             ^
HINT:  Perhaps you meant to reference the column "f.ordernumber".

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 65329)
[2022-06-20 15:42:00,432] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 15:42:00,483] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:51:37,630] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:51:37,651] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:51:37,651] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:51:37,652] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:51:37,652] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:51:37,677] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:51:37,690] {standard_task_runner.py:52} INFO - Started process 68022 to run task
[2022-06-20 15:51:37,696] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '404', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpuxf88h5y', '--error-file', '/tmp/tmpnb4fqrb5']
[2022-06-20 15:51:37,697] {standard_task_runner.py:80} INFO - Job 404: Subtask load_fato
[2022-06-20 15:51:37,782] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:51:37,896] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:51:37,913] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.UndefinedColumn: column f.buyprice does not exist
LINE 1: select distinct f.quantityordered, f.priceeach, f.buyprice, ...
                                                        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft = pd.read_sql_query('select distinct f.quantityordered, f.priceeach, f.buyprice, \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column f.buyprice does not exist
LINE 1: select distinct f.quantityordered, f.priceeach, f.buyprice, ...
                                                        ^

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 15:51:37,932] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T185137, end_date=20220620T185137
[2022-06-20 15:51:37,950] {standard_task_runner.py:92} ERROR - Failed to execute job 404 for task load_fato ((psycopg2.errors.UndefinedColumn) column f.buyprice does not exist
LINE 1: select distinct f.quantityordered, f.priceeach, f.buyprice, ...
                                                        ^

[SQL: select distinct f.quantityordered, f.priceeach, f.buyprice,             id_customers, id_products, id_time, id_emp, id_ordd from stg_fato f            left join dm_customers c            on  f.customerNumber = c.customerNumber             left join dm_products p            on   f.productcode = p.productcode             left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_emp e            on   f.employeenumber = e.employeenumber ]
(Background on this error at: http://sqlalche.me/e/14/f405); 68022)
[2022-06-20 15:51:37,987] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 15:51:38,041] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:09:34,373] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:09:34,400] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:09:34,400] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:09:34,400] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:09:34,400] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:09:34,420] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:09:34,430] {standard_task_runner.py:52} INFO - Started process 75001 to run task
[2022-06-20 16:09:34,436] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '428', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpo2y83is5', '--error-file', '/tmp/tmpvccyd555']
[2022-06-20 16:09:34,436] {standard_task_runner.py:80} INFO - Job 428: Subtask load_fato
[2022-06-20 16:09:34,519] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:09:34,632] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:09:34,648] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
psycopg2.errors.SyntaxError: syntax error at or near "."
LINE 1: ...oducts, t.id_time, e.id_emp, id_ordd             f.quantityo...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 141, in load_Fato
    df_ft = pd.read_sql_query('select distinct c.id_customers, p.id_products, t.id_time, e.id_emp, id_ordd \
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 399, in read_sql_query
    return pandas_sql.read_query(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1557, in read_query
    result = self.execute(*args)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1402, in execute
    return self.connectable.execution_options().execute(*args, **kwargs)
  File "<string>", line 2, in execute
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/deprecations.py", line 390, in warned
    return fn(*args, **kwargs)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 3037, in execute
    return connection.execute(statement, *multiparams, **params)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1185, in execute
    return self._exec_driver_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1484, in _exec_driver_sql
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1705, in _execute_context
    self.dialect.do_execute(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 716, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.SyntaxError) syntax error at or near "."
LINE 1: ...oducts, t.id_time, e.id_emp, id_ordd             f.quantityo...
                                                             ^

[SQL: select distinct c.id_customers, p.id_products, t.id_time, e.id_emp, id_ordd             f.quantityordered, f.priceeach,             from stg_fato f             left join dm_products p             on   f.productcode = p.productcode             left join dm_orderd o             on f.ordernumber = o.ordernumber and f.quantityordered = o.quantityordered and f.orderLineNumber = o.orderLineNumber            left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_customers c             on f.customernumber = c.customernumber             left join dm_emp e            on f.employeenumber = e.employeenumber            order by id_time]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 16:09:34,669] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T190934, end_date=20220620T190934
[2022-06-20 16:09:34,689] {standard_task_runner.py:92} ERROR - Failed to execute job 428 for task load_fato ((psycopg2.errors.SyntaxError) syntax error at or near "."
LINE 1: ...oducts, t.id_time, e.id_emp, id_ordd             f.quantityo...
                                                             ^

[SQL: select distinct c.id_customers, p.id_products, t.id_time, e.id_emp, id_ordd             f.quantityordered, f.priceeach,             from stg_fato f             left join dm_products p             on   f.productcode = p.productcode             left join dm_orderd o             on f.ordernumber = o.ordernumber and f.quantityordered = o.quantityordered and f.orderLineNumber = o.orderLineNumber            left join dm_time t            on f.ordernumber = t.ordernumber            left join dm_customers c             on f.customernumber = c.customernumber             left join dm_emp e            on f.employeenumber = e.employeenumber            order by id_time]
(Background on this error at: http://sqlalche.me/e/14/f405); 75001)
[2022-06-20 16:09:34,727] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 16:09:34,777] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:13:57,674] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:13:57,696] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:13:57,696] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:13:57,696] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:13:57,696] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:13:57,719] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:13:57,731] {standard_task_runner.py:52} INFO - Started process 77058 to run task
[2022-06-20 16:13:57,736] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '446', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpvu46elux', '--error-file', '/tmp/tmpa1p2lhz3']
[2022-06-20 16:13:57,737] {standard_task_runner.py:80} INFO - Job 446: Subtask load_fato
[2022-06-20 16:13:57,819] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:13:57,937] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:13:58,066] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "id_ordd" of relation "fato" does not exist
LINE 1: ...fato (id_customers, id_products, id_time, id_emp, id_ordd, q...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 156, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "id_ordd" of relation "fato" does not exist
LINE 1: ...fato (id_customers, id_products, id_time, id_emp, id_ordd, q...
                                                             ^

[SQL: INSERT INTO fato (id_customers, id_products, id_time, id_emp, id_ordd, quantityordered, priceeach) VALUES (%(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s, %(id_ordd)s, %(quantityordered)s, %(priceeach)s)]
[parameters: ({'id_customers': 8, 'id_products': 13, 'id_time': 1, 'id_emp': 11, 'id_ordd': 2965, 'quantityordered': 23.0, 'priceeach': 144.05}, {'id_customers': 8, 'id_products': 19, 'id_time': 1, 'id_emp': 11, 'id_ordd': 983, 'quantityordered': 31.0, 'priceeach': 52.05}, {'id_customers': 8, 'id_products': 24, 'id_time': 1, 'id_emp': 11, 'id_ordd': 1117, 'quantityordered': 29.0, 'priceeach': 116.27}, {'id_customers': 8, 'id_products': 29, 'id_time': 1, 'id_emp': 11, 'id_ordd': 174, 'quantityordered': 49.0, 'priceeach': 65.94}, {'id_customers': 8, 'id_products': 46, 'id_time': 1, 'id_emp': 11, 'id_ordd': 2779, 'quantityordered': 23.0, 'priceeach': 95.58}, {'id_customers': 8, 'id_products': 77, 'id_time': 1, 'id_emp': 11, 'id_ordd': 1362, 'quantityordered': 41.0, 'priceeach': 63.14}, {'id_customers': 8, 'id_products': 79, 'id_time': 1, 'id_emp': 11, 'id_ordd': 2004, 'quantityordered': 33.0, 'priceeach': 184.84}, {'id_customers': 8, 'id_products': 90, 'id_time': 1, 'id_emp': 11, 'id_ordd': 553, 'quantityordered': 22.0, 'priceeach': 76.61}  ... displaying 10 of 2996 total bound parameter sets ...  {'id_customers': 76, 'id_products': 91, 'id_time': 326, 'id_emp': 21, 'id_ordd': 593, 'quantityordered': 39.0, 'priceeach': 135.61}, {'id_customers': 76, 'id_products': 103, 'id_time': 326, 'id_emp': 21, 'id_ordd': 1230, 'quantityordered': 22.0, 'priceeach': 75.47})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 16:13:58,092] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T191357, end_date=20220620T191358
[2022-06-20 16:13:58,116] {standard_task_runner.py:92} ERROR - Failed to execute job 446 for task load_fato ((psycopg2.errors.UndefinedColumn) column "id_ordd" of relation "fato" does not exist
LINE 1: ...fato (id_customers, id_products, id_time, id_emp, id_ordd, q...
                                                             ^

[SQL: INSERT INTO fato (id_customers, id_products, id_time, id_emp, id_ordd, quantityordered, priceeach) VALUES (%(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s, %(id_ordd)s, %(quantityordered)s, %(priceeach)s)]
[parameters: ({'id_customers': 8, 'id_products': 13, 'id_time': 1, 'id_emp': 11, 'id_ordd': 2965, 'quantityordered': 23.0, 'priceeach': 144.05}, {'id_customers': 8, 'id_products': 19, 'id_time': 1, 'id_emp': 11, 'id_ordd': 983, 'quantityordered': 31.0, 'priceeach': 52.05}, {'id_customers': 8, 'id_products': 24, 'id_time': 1, 'id_emp': 11, 'id_ordd': 1117, 'quantityordered': 29.0, 'priceeach': 116.27}, {'id_customers': 8, 'id_products': 29, 'id_time': 1, 'id_emp': 11, 'id_ordd': 174, 'quantityordered': 49.0, 'priceeach': 65.94}, {'id_customers': 8, 'id_products': 46, 'id_time': 1, 'id_emp': 11, 'id_ordd': 2779, 'quantityordered': 23.0, 'priceeach': 95.58}, {'id_customers': 8, 'id_products': 77, 'id_time': 1, 'id_emp': 11, 'id_ordd': 1362, 'quantityordered': 41.0, 'priceeach': 63.14}, {'id_customers': 8, 'id_products': 79, 'id_time': 1, 'id_emp': 11, 'id_ordd': 2004, 'quantityordered': 33.0, 'priceeach': 184.84}, {'id_customers': 8, 'id_products': 90, 'id_time': 1, 'id_emp': 11, 'id_ordd': 553, 'quantityordered': 22.0, 'priceeach': 76.61}  ... displaying 10 of 2996 total bound parameter sets ...  {'id_customers': 76, 'id_products': 91, 'id_time': 326, 'id_emp': 21, 'id_ordd': 593, 'quantityordered': 39.0, 'priceeach': 135.61}, {'id_customers': 76, 'id_products': 103, 'id_time': 326, 'id_emp': 21, 'id_ordd': 1230, 'quantityordered': 22.0, 'priceeach': 75.47})]
(Background on this error at: http://sqlalche.me/e/14/f405); 77058)
[2022-06-20 16:13:58,148] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 16:13:58,208] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:16:10,207] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:16:10,229] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:16:10,229] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:16:10,229] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:16:10,229] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:16:10,253] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:16:10,264] {standard_task_runner.py:52} INFO - Started process 79397 to run task
[2022-06-20 16:16:10,270] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '473', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp20ce6nk8', '--error-file', '/tmp/tmpro8kzb3r']
[2022-06-20 16:16:10,270] {standard_task_runner.py:80} INFO - Job 473: Subtask load_fato
[2022-06-20 16:16:10,354] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:16:10,471] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:16:10,795] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:16:10,818] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T191610, end_date=20220620T191610
[2022-06-20 16:16:10,883] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:16:10,936] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:29:47,291] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:29:47,313] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:29:47,313] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:29:47,313] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:29:47,313] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:29:47,334] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:29:47,345] {standard_task_runner.py:52} INFO - Started process 82430 to run task
[2022-06-20 16:29:47,351] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '491', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpe_py7xza', '--error-file', '/tmp/tmp0uzz_tq_']
[2022-06-20 16:29:47,352] {standard_task_runner.py:80} INFO - Job 491: Subtask load_fato
[2022-06-20 16:29:47,436] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:29:47,547] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:29:48,951] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "buyprice" of relation "fato" does not exist
LINE 1: ...cts, id_time, id_emp, quantityordered, priceeach, buyprice) ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 156, in load_Fato
    df_ft.to_sql('fato', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "buyprice" of relation "fato" does not exist
LINE 1: ...cts, id_time, id_emp, quantityordered, priceeach, buyprice) ...
                                                             ^

[SQL: INSERT INTO fato (id_customers, id_products, id_time, id_emp, quantityordered, priceeach, buyprice) VALUES (%(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s, %(quantityordered)s, %(priceeach)s, %(buyprice)s)]
[parameters: ({'id_customers': 8, 'id_products': 13, 'id_time': 1, 'id_emp': 11, 'quantityordered': 23.0, 'priceeach': 144.05, 'buyprice': 73.49}, {'id_customers': 8, 'id_products': 13, 'id_time': 1, 'id_emp': 34, 'quantityordered': 23.0, 'priceeach': 144.05, 'buyprice': 73.49}, {'id_customers': 8, 'id_products': 19, 'id_time': 1, 'id_emp': 11, 'quantityordered': 31.0, 'priceeach': 52.05, 'buyprice': 38.58}, {'id_customers': 8, 'id_products': 19, 'id_time': 1, 'id_emp': 34, 'quantityordered': 31.0, 'priceeach': 52.05, 'buyprice': 38.58}, {'id_customers': 8, 'id_products': 24, 'id_time': 1, 'id_emp': 11, 'quantityordered': 29.0, 'priceeach': 116.27, 'buyprice': 75.16}, {'id_customers': 8, 'id_products': 24, 'id_time': 1, 'id_emp': 34, 'quantityordered': 29.0, 'priceeach': 116.27, 'buyprice': 75.16}, {'id_customers': 8, 'id_products': 29, 'id_time': 1, 'id_emp': 11, 'quantityordered': 49.0, 'priceeach': 65.94, 'buyprice': 49.05}, {'id_customers': 8, 'id_products': 29, 'id_time': 1, 'id_emp': 34, 'quantityordered': 49.0, 'priceeach': 65.94, 'buyprice': 49.05}  ... displaying 10 of 47936 total bound parameter sets ...  {'id_customers': 198, 'id_products': 213, 'id_time': 652, 'id_emp': 21, 'quantityordered': 22.0, 'priceeach': 75.47, 'buyprice': 48.64}, {'id_customers': 198, 'id_products': 213, 'id_time': 652, 'id_emp': 44, 'quantityordered': 22.0, 'priceeach': 75.47, 'buyprice': 48.64})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 16:29:49,017] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T192947, end_date=20220620T192949
[2022-06-20 16:29:49,039] {standard_task_runner.py:92} ERROR - Failed to execute job 491 for task load_fato ((psycopg2.errors.UndefinedColumn) column "buyprice" of relation "fato" does not exist
LINE 1: ...cts, id_time, id_emp, quantityordered, priceeach, buyprice) ...
                                                             ^

[SQL: INSERT INTO fato (id_customers, id_products, id_time, id_emp, quantityordered, priceeach, buyprice) VALUES (%(id_customers)s, %(id_products)s, %(id_time)s, %(id_emp)s, %(quantityordered)s, %(priceeach)s, %(buyprice)s)]
[parameters: ({'id_customers': 8, 'id_products': 13, 'id_time': 1, 'id_emp': 11, 'quantityordered': 23.0, 'priceeach': 144.05, 'buyprice': 73.49}, {'id_customers': 8, 'id_products': 13, 'id_time': 1, 'id_emp': 34, 'quantityordered': 23.0, 'priceeach': 144.05, 'buyprice': 73.49}, {'id_customers': 8, 'id_products': 19, 'id_time': 1, 'id_emp': 11, 'quantityordered': 31.0, 'priceeach': 52.05, 'buyprice': 38.58}, {'id_customers': 8, 'id_products': 19, 'id_time': 1, 'id_emp': 34, 'quantityordered': 31.0, 'priceeach': 52.05, 'buyprice': 38.58}, {'id_customers': 8, 'id_products': 24, 'id_time': 1, 'id_emp': 11, 'quantityordered': 29.0, 'priceeach': 116.27, 'buyprice': 75.16}, {'id_customers': 8, 'id_products': 24, 'id_time': 1, 'id_emp': 34, 'quantityordered': 29.0, 'priceeach': 116.27, 'buyprice': 75.16}, {'id_customers': 8, 'id_products': 29, 'id_time': 1, 'id_emp': 11, 'quantityordered': 49.0, 'priceeach': 65.94, 'buyprice': 49.05}, {'id_customers': 8, 'id_products': 29, 'id_time': 1, 'id_emp': 34, 'quantityordered': 49.0, 'priceeach': 65.94, 'buyprice': 49.05}  ... displaying 10 of 47936 total bound parameter sets ...  {'id_customers': 198, 'id_products': 213, 'id_time': 652, 'id_emp': 21, 'quantityordered': 22.0, 'priceeach': 75.47, 'buyprice': 48.64}, {'id_customers': 198, 'id_products': 213, 'id_time': 652, 'id_emp': 44, 'quantityordered': 22.0, 'priceeach': 75.47, 'buyprice': 48.64})]
(Background on this error at: http://sqlalche.me/e/14/f405); 82430)
[2022-06-20 16:29:49,088] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 16:29:49,472] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:32:03,417] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:32:03,439] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:32:03,439] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:32:03,439] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:32:03,439] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:32:03,462] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_fato> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:32:03,474] {standard_task_runner.py:52} INFO - Started process 84330 to run task
[2022-06-20 16:32:03,479] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_fato', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '509', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp4a289ypp', '--error-file', '/tmp/tmpkjjk8m6c']
[2022-06-20 16:32:03,480] {standard_task_runner.py:80} INFO - Job 509: Subtask load_fato
[2022-06-20 16:32:03,562] {task_command.py:370} INFO - Running <TaskInstance: sales.load_fato scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:32:03,678] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_fato
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:32:04,056] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:32:04,078] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_fato, execution_date=20220619T000000, start_date=20220620T193203, end_date=20220620T193204
[2022-06-20 16:32:04,133] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:32:04,185] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
