[2022-06-19 23:39:55,925] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:39:55,948] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:39:55,949] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:39:55,949] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-19 23:39:55,949] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:39:55,978] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-19 23:39:55,988] {standard_task_runner.py:52} INFO - Started process 28670 to run task
[2022-06-19 23:39:55,994] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '206', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp4y9bhpu3', '--error-file', '/tmp/tmp6zmdpyg_']
[2022-06-19 23:39:55,995] {standard_task_runner.py:80} INFO - Job 206: Subtask load_DMs
[2022-06-19 23:39:56,087] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-19 23:39:56,205] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-19 23:39:56,314] {python.py:173} INFO - Done. Returned value was: None
[2022-06-19 23:39:56,339] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T023955, end_date=20220620T023956
[2022-06-19 23:39:56,407] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-19 23:39:56,478] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-19 23:48:49,866] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:48:49,891] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-19 23:48:49,891] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:48:49,891] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-19 23:48:49,891] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-19 23:48:49,912] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-19 23:48:49,920] {standard_task_runner.py:52} INFO - Started process 33300 to run task
[2022-06-19 23:48:49,926] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '236', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp0x73m2ha', '--error-file', '/tmp/tmpaxhxaxql']
[2022-06-19 23:48:49,927] {standard_task_runner.py:80} INFO - Job 236: Subtask load_DMs
[2022-06-19 23:48:50,013] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-19 23:48:50,132] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-19 23:48:50,256] {python.py:173} INFO - Done. Returned value was: None
[2022-06-19 23:48:50,284] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T024849, end_date=20220620T024850
[2022-06-19 23:48:50,338] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-19 23:48:50,412] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:04:06,962] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:04:06,985] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:04:06,985] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:04:06,985] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:04:06,985] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:04:07,006] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:04:07,018] {standard_task_runner.py:52} INFO - Started process 36433 to run task
[2022-06-20 00:04:07,024] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '252', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpryyhd5xs', '--error-file', '/tmp/tmpllm2qbsb']
[2022-06-20 00:04:07,025] {standard_task_runner.py:80} INFO - Job 252: Subtask load_DMs
[2022-06-20 00:04:07,120] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:04:07,240] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:04:07,348] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 00:04:07,371] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T030406, end_date=20220620T030407
[2022-06-20 00:04:07,435] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 00:04:07,502] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:07:04,998] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:07:05,020] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:07:05,020] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:07:05,020] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:07:05,021] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:07:05,040] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:07:05,048] {standard_task_runner.py:52} INFO - Started process 39219 to run task
[2022-06-20 00:07:05,052] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '277', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpc1vk9gfn', '--error-file', '/tmp/tmph_3ybylk']
[2022-06-20 00:07:05,053] {standard_task_runner.py:80} INFO - Job 277: Subtask load_DMs
[2022-06-20 00:07:05,134] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:07:05,242] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:07:05,344] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 00:07:05,366] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T030704, end_date=20220620T030705
[2022-06-20 00:07:05,424] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 00:07:05,490] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:25:40,319] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:25:40,345] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:25:40,345] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:25:40,345] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:25:40,345] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:25:40,373] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:25:40,387] {standard_task_runner.py:52} INFO - Started process 43250 to run task
[2022-06-20 00:25:40,394] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '293', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmprtl4_nbl', '--error-file', '/tmp/tmpdbzvy8m1']
[2022-06-20 00:25:40,394] {standard_task_runner.py:80} INFO - Job 293: Subtask load_DMs
[2022-06-20 00:25:40,506] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:25:40,619] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:25:40,712] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 00:25:40,731] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T032540, end_date=20220620T032540
[2022-06-20 00:25:40,766] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 00:25:40,823] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:26:36,627] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:26:36,657] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:26:36,658] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:26:36,658] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:26:36,658] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:26:36,689] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:26:36,703] {standard_task_runner.py:52} INFO - Started process 44598 to run task
[2022-06-20 00:26:36,707] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '309', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp221xp404', '--error-file', '/tmp/tmp79vbj4yf']
[2022-06-20 00:26:36,707] {standard_task_runner.py:80} INFO - Job 309: Subtask load_DMs
[2022-06-20 00:26:36,791] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:26:36,903] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:26:36,998] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 00:26:37,020] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T032636, end_date=20220620T032637
[2022-06-20 00:26:37,080] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 00:26:37,139] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:29:41,053] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:29:41,075] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:29:41,075] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:29:41,075] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:29:41,076] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:29:41,095] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:29:41,103] {standard_task_runner.py:52} INFO - Started process 46299 to run task
[2022-06-20 00:29:41,109] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '325', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpvatefnyw', '--error-file', '/tmp/tmp0sl_ts0g']
[2022-06-20 00:29:41,109] {standard_task_runner.py:80} INFO - Job 325: Subtask load_DMs
[2022-06-20 00:29:41,185] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:29:41,299] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:29:41,374] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 124, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^

[SQL: INSERT INTO dm_products (productname, productline, productvendor, productdescription, buyprice) VALUES (%(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s, %(buyprice)s)]
[parameters: ({'productname': '2001 Ferrari Enzo', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.', 'buyprice': 95.59}, {'productname': '1960 BSA Gold Star DBD34', 'productline': 'Motorcycles', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'Detailed scale replica with working suspension and constructed from over 70 parts', 'buyprice': 37.32}, {'productname': '1900s Vintage Bi-Plane', 'productline': 'Planes', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hand crafted diecast-like metal bi-plane is re-created in about 1:24 scale of antique pioneer airplane. All hand-assembled with many different parts. Hand-painted in classic yellow and features correct markings of original airplane.', 'buyprice': 34.25}, {'productname': '1969 Harley Davidson Ultimate Chopper', 'productline': 'Motorcycles', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This replica features working kickstand, front suspension, gear-shift lever, footbrake lever, drive chain, wheels and steering. All parts are particularly delicate due to their precise scale and require special care and attention.', 'buyprice': 48.81}, {'productname': '1957 Corvette Convertible', 'productline': 'Classic Cars', 'productvendor': 'Classic Metal Creations', 'productdescription': '1957 die cast Corvette Convertible in Roman Red with white sides and whitewall tires. 1:18 scale quality die-cast with detailed engine and underbvody. Now you can own The Classic Corvette.', 'buyprice': 69.93}, {'productname': '1980s Black Hawk Helicopter', 'productline': 'Planes', 'productvendor': 'Red Start Diecast', 'productdescription': '1:18 scale replica of actual Armys UH-60L BLACK HAWK Helicopter. 100% hand-assembled. Features rotating rotor blades, propeller blades and rubber wheels.', 'buyprice': 77.27}, {'productname': 'Diamond T620 Semi-Skirted Tanker', 'productline': 'Trucks and Buses', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'This limited edition model is licensed and perfectly scaled for Lionel Trains. The Diamond T620 has been produced in solid precision diecast and pain ... (26 characters truncated) ... el finish. It comes with a removable tanker and is a perfect model to add authenticity to your static train or car layout or to just have on display.', 'buyprice': 68.29}, {'productname': '1976 Ford Gran Torino', 'productline': 'Classic Cars', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'Highly detailed 1976 Ford Gran Torino \\"Starsky and Hutch\\" diecast model. Very well constructed and painted in red and white patterns.', 'buyprice': 73.49}  ... displaying 10 of 110 total bound parameter sets ...  {'productname': '1995 Honda Civic', 'productline': 'Classic Cars', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This model features, opening hood, opening doors, detailed engine, rear spoiler, opening trunk, working steering, tinted windows, baked enamel finish. Color yellow.', 'buyprice': 93.89}, {'productname': '1968 Ford Mustang', 'productline': 'Classic Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hood, doors and trunk all open to reveal highly detailed interior features. Steering wheel actually turns the front wheels. Color dark green.', 'buyprice': 95.34})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 00:29:41,403] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T032941, end_date=20220620T032941
[2022-06-20 00:29:41,434] {standard_task_runner.py:92} ERROR - Failed to execute job 325 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^

[SQL: INSERT INTO dm_products (productname, productline, productvendor, productdescription, buyprice) VALUES (%(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s, %(buyprice)s)]
[parameters: ({'productname': '2001 Ferrari Enzo', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.', 'buyprice': 95.59}, {'productname': '1960 BSA Gold Star DBD34', 'productline': 'Motorcycles', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'Detailed scale replica with working suspension and constructed from over 70 parts', 'buyprice': 37.32}, {'productname': '1900s Vintage Bi-Plane', 'productline': 'Planes', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hand crafted diecast-like metal bi-plane is re-created in about 1:24 scale of antique pioneer airplane. All hand-assembled with many different parts. Hand-painted in classic yellow and features correct markings of original airplane.', 'buyprice': 34.25}, {'productname': '1969 Harley Davidson Ultimate Chopper', 'productline': 'Motorcycles', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This replica features working kickstand, front suspension, gear-shift lever, footbrake lever, drive chain, wheels and steering. All parts are particularly delicate due to their precise scale and require special care and attention.', 'buyprice': 48.81}, {'productname': '1957 Corvette Convertible', 'productline': 'Classic Cars', 'productvendor': 'Classic Metal Creations', 'productdescription': '1957 die cast Corvette Convertible in Roman Red with white sides and whitewall tires. 1:18 scale quality die-cast with detailed engine and underbvody. Now you can own The Classic Corvette.', 'buyprice': 69.93}, {'productname': '1980s Black Hawk Helicopter', 'productline': 'Planes', 'productvendor': 'Red Start Diecast', 'productdescription': '1:18 scale replica of actual Armys UH-60L BLACK HAWK Helicopter. 100% hand-assembled. Features rotating rotor blades, propeller blades and rubber wheels.', 'buyprice': 77.27}, {'productname': 'Diamond T620 Semi-Skirted Tanker', 'productline': 'Trucks and Buses', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'This limited edition model is licensed and perfectly scaled for Lionel Trains. The Diamond T620 has been produced in solid precision diecast and pain ... (26 characters truncated) ... el finish. It comes with a removable tanker and is a perfect model to add authenticity to your static train or car layout or to just have on display.', 'buyprice': 68.29}, {'productname': '1976 Ford Gran Torino', 'productline': 'Classic Cars', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'Highly detailed 1976 Ford Gran Torino \\"Starsky and Hutch\\" diecast model. Very well constructed and painted in red and white patterns.', 'buyprice': 73.49}  ... displaying 10 of 110 total bound parameter sets ...  {'productname': '1995 Honda Civic', 'productline': 'Classic Cars', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This model features, opening hood, opening doors, detailed engine, rear spoiler, opening trunk, working steering, tinted windows, baked enamel finish. Color yellow.', 'buyprice': 93.89}, {'productname': '1968 Ford Mustang', 'productline': 'Classic Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hood, doors and trunk all open to reveal highly detailed interior features. Steering wheel actually turns the front wheels. Color dark green.', 'buyprice': 95.34})]
(Background on this error at: http://sqlalche.me/e/14/f405); 46299)
[2022-06-20 00:29:41,480] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:29:41,548] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:30:54,006] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:30:54,027] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:30:54,027] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:30:54,027] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:30:54,028] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:30:54,048] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:30:54,061] {standard_task_runner.py:52} INFO - Started process 47736 to run task
[2022-06-20 00:30:54,066] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '340', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpk134erae', '--error-file', '/tmp/tmp3c7pwa0x']
[2022-06-20 00:30:54,067] {standard_task_runner.py:80} INFO - Job 340: Subtask load_DMs
[2022-06-20 00:30:54,154] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:30:54,272] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:30:54,343] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 124, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^

[SQL: INSERT INTO dm_products (productname, productline, productvendor, productdescription, buyprice) VALUES (%(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s, %(buyprice)s)]
[parameters: ({'productname': '2001 Ferrari Enzo', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.', 'buyprice': 95.59}, {'productname': '1960 BSA Gold Star DBD34', 'productline': 'Motorcycles', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'Detailed scale replica with working suspension and constructed from over 70 parts', 'buyprice': 37.32}, {'productname': '1900s Vintage Bi-Plane', 'productline': 'Planes', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hand crafted diecast-like metal bi-plane is re-created in about 1:24 scale of antique pioneer airplane. All hand-assembled with many different parts. Hand-painted in classic yellow and features correct markings of original airplane.', 'buyprice': 34.25}, {'productname': '1969 Harley Davidson Ultimate Chopper', 'productline': 'Motorcycles', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This replica features working kickstand, front suspension, gear-shift lever, footbrake lever, drive chain, wheels and steering. All parts are particularly delicate due to their precise scale and require special care and attention.', 'buyprice': 48.81}, {'productname': '1957 Corvette Convertible', 'productline': 'Classic Cars', 'productvendor': 'Classic Metal Creations', 'productdescription': '1957 die cast Corvette Convertible in Roman Red with white sides and whitewall tires. 1:18 scale quality die-cast with detailed engine and underbvody. Now you can own The Classic Corvette.', 'buyprice': 69.93}, {'productname': '1980s Black Hawk Helicopter', 'productline': 'Planes', 'productvendor': 'Red Start Diecast', 'productdescription': '1:18 scale replica of actual Armys UH-60L BLACK HAWK Helicopter. 100% hand-assembled. Features rotating rotor blades, propeller blades and rubber wheels.', 'buyprice': 77.27}, {'productname': 'Diamond T620 Semi-Skirted Tanker', 'productline': 'Trucks and Buses', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'This limited edition model is licensed and perfectly scaled for Lionel Trains. The Diamond T620 has been produced in solid precision diecast and pain ... (26 characters truncated) ... el finish. It comes with a removable tanker and is a perfect model to add authenticity to your static train or car layout or to just have on display.', 'buyprice': 68.29}, {'productname': '1976 Ford Gran Torino', 'productline': 'Classic Cars', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'Highly detailed 1976 Ford Gran Torino \\"Starsky and Hutch\\" diecast model. Very well constructed and painted in red and white patterns.', 'buyprice': 73.49}  ... displaying 10 of 110 total bound parameter sets ...  {'productname': '1995 Honda Civic', 'productline': 'Classic Cars', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This model features, opening hood, opening doors, detailed engine, rear spoiler, opening trunk, working steering, tinted windows, baked enamel finish. Color yellow.', 'buyprice': 93.89}, {'productname': '1968 Ford Mustang', 'productline': 'Classic Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hood, doors and trunk all open to reveal highly detailed interior features. Steering wheel actually turns the front wheels. Color dark green.', 'buyprice': 95.34})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 00:30:54,368] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T033054, end_date=20220620T033054
[2022-06-20 00:30:54,387] {standard_task_runner.py:92} ERROR - Failed to execute job 340 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^

[SQL: INSERT INTO dm_products (productname, productline, productvendor, productdescription, buyprice) VALUES (%(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s, %(buyprice)s)]
[parameters: ({'productname': '2001 Ferrari Enzo', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.', 'buyprice': 95.59}, {'productname': '1960 BSA Gold Star DBD34', 'productline': 'Motorcycles', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'Detailed scale replica with working suspension and constructed from over 70 parts', 'buyprice': 37.32}, {'productname': '1900s Vintage Bi-Plane', 'productline': 'Planes', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hand crafted diecast-like metal bi-plane is re-created in about 1:24 scale of antique pioneer airplane. All hand-assembled with many different parts. Hand-painted in classic yellow and features correct markings of original airplane.', 'buyprice': 34.25}, {'productname': '1969 Harley Davidson Ultimate Chopper', 'productline': 'Motorcycles', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This replica features working kickstand, front suspension, gear-shift lever, footbrake lever, drive chain, wheels and steering. All parts are particularly delicate due to their precise scale and require special care and attention.', 'buyprice': 48.81}, {'productname': '1957 Corvette Convertible', 'productline': 'Classic Cars', 'productvendor': 'Classic Metal Creations', 'productdescription': '1957 die cast Corvette Convertible in Roman Red with white sides and whitewall tires. 1:18 scale quality die-cast with detailed engine and underbvody. Now you can own The Classic Corvette.', 'buyprice': 69.93}, {'productname': '1980s Black Hawk Helicopter', 'productline': 'Planes', 'productvendor': 'Red Start Diecast', 'productdescription': '1:18 scale replica of actual Armys UH-60L BLACK HAWK Helicopter. 100% hand-assembled. Features rotating rotor blades, propeller blades and rubber wheels.', 'buyprice': 77.27}, {'productname': 'Diamond T620 Semi-Skirted Tanker', 'productline': 'Trucks and Buses', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'This limited edition model is licensed and perfectly scaled for Lionel Trains. The Diamond T620 has been produced in solid precision diecast and pain ... (26 characters truncated) ... el finish. It comes with a removable tanker and is a perfect model to add authenticity to your static train or car layout or to just have on display.', 'buyprice': 68.29}, {'productname': '1976 Ford Gran Torino', 'productline': 'Classic Cars', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'Highly detailed 1976 Ford Gran Torino \\"Starsky and Hutch\\" diecast model. Very well constructed and painted in red and white patterns.', 'buyprice': 73.49}  ... displaying 10 of 110 total bound parameter sets ...  {'productname': '1995 Honda Civic', 'productline': 'Classic Cars', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This model features, opening hood, opening doors, detailed engine, rear spoiler, opening trunk, working steering, tinted windows, baked enamel finish. Color yellow.', 'buyprice': 93.89}, {'productname': '1968 Ford Mustang', 'productline': 'Classic Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hood, doors and trunk all open to reveal highly detailed interior features. Steering wheel actually turns the front wheels. Color dark green.', 'buyprice': 95.34})]
(Background on this error at: http://sqlalche.me/e/14/f405); 47736)
[2022-06-20 00:30:54,439] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:30:54,518] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:32:43,230] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:32:43,252] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:32:43,252] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:32:43,252] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:32:43,252] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:32:43,275] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:32:43,286] {standard_task_runner.py:52} INFO - Started process 49445 to run task
[2022-06-20 00:32:43,292] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '355', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpph6482yr', '--error-file', '/tmp/tmpqho0x6tx']
[2022-06-20 00:32:43,293] {standard_task_runner.py:80} INFO - Job 355: Subtask load_DMs
[2022-06-20 00:32:43,382] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:32:43,506] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:32:43,587] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 124, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^

[SQL: INSERT INTO dm_products (productname, productline, productvendor, productdescription, buyprice) VALUES (%(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s, %(buyprice)s)]
[parameters: ({'productname': '2001 Ferrari Enzo', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.', 'buyprice': 95.59}, {'productname': '1960 BSA Gold Star DBD34', 'productline': 'Motorcycles', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'Detailed scale replica with working suspension and constructed from over 70 parts', 'buyprice': 37.32}, {'productname': '1900s Vintage Bi-Plane', 'productline': 'Planes', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hand crafted diecast-like metal bi-plane is re-created in about 1:24 scale of antique pioneer airplane. All hand-assembled with many different parts. Hand-painted in classic yellow and features correct markings of original airplane.', 'buyprice': 34.25}, {'productname': '1969 Harley Davidson Ultimate Chopper', 'productline': 'Motorcycles', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This replica features working kickstand, front suspension, gear-shift lever, footbrake lever, drive chain, wheels and steering. All parts are particularly delicate due to their precise scale and require special care and attention.', 'buyprice': 48.81}, {'productname': '1957 Corvette Convertible', 'productline': 'Classic Cars', 'productvendor': 'Classic Metal Creations', 'productdescription': '1957 die cast Corvette Convertible in Roman Red with white sides and whitewall tires. 1:18 scale quality die-cast with detailed engine and underbvody. Now you can own The Classic Corvette.', 'buyprice': 69.93}, {'productname': '1980s Black Hawk Helicopter', 'productline': 'Planes', 'productvendor': 'Red Start Diecast', 'productdescription': '1:18 scale replica of actual Armys UH-60L BLACK HAWK Helicopter. 100% hand-assembled. Features rotating rotor blades, propeller blades and rubber wheels.', 'buyprice': 77.27}, {'productname': 'Diamond T620 Semi-Skirted Tanker', 'productline': 'Trucks and Buses', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'This limited edition model is licensed and perfectly scaled for Lionel Trains. The Diamond T620 has been produced in solid precision diecast and pain ... (26 characters truncated) ... el finish. It comes with a removable tanker and is a perfect model to add authenticity to your static train or car layout or to just have on display.', 'buyprice': 68.29}, {'productname': '1976 Ford Gran Torino', 'productline': 'Classic Cars', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'Highly detailed 1976 Ford Gran Torino \\"Starsky and Hutch\\" diecast model. Very well constructed and painted in red and white patterns.', 'buyprice': 73.49}  ... displaying 10 of 110 total bound parameter sets ...  {'productname': '1995 Honda Civic', 'productline': 'Classic Cars', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This model features, opening hood, opening doors, detailed engine, rear spoiler, opening trunk, working steering, tinted windows, baked enamel finish. Color yellow.', 'buyprice': 93.89}, {'productname': '1968 Ford Mustang', 'productline': 'Classic Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hood, doors and trunk all open to reveal highly detailed interior features. Steering wheel actually turns the front wheels. Color dark green.', 'buyprice': 95.34})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 00:32:43,616] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T033243, end_date=20220620T033243
[2022-06-20 00:32:43,637] {standard_task_runner.py:92} ERROR - Failed to execute job 355 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "buyprice" of relation "dm_products" does not exist
LINE 1: ..., productline, productvendor, productdescription, buyprice) ...
                                                             ^

[SQL: INSERT INTO dm_products (productname, productline, productvendor, productdescription, buyprice) VALUES (%(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s, %(buyprice)s)]
[parameters: ({'productname': '2001 Ferrari Enzo', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.', 'buyprice': 95.59}, {'productname': '1960 BSA Gold Star DBD34', 'productline': 'Motorcycles', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'Detailed scale replica with working suspension and constructed from over 70 parts', 'buyprice': 37.32}, {'productname': '1900s Vintage Bi-Plane', 'productline': 'Planes', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hand crafted diecast-like metal bi-plane is re-created in about 1:24 scale of antique pioneer airplane. All hand-assembled with many different parts. Hand-painted in classic yellow and features correct markings of original airplane.', 'buyprice': 34.25}, {'productname': '1969 Harley Davidson Ultimate Chopper', 'productline': 'Motorcycles', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This replica features working kickstand, front suspension, gear-shift lever, footbrake lever, drive chain, wheels and steering. All parts are particularly delicate due to their precise scale and require special care and attention.', 'buyprice': 48.81}, {'productname': '1957 Corvette Convertible', 'productline': 'Classic Cars', 'productvendor': 'Classic Metal Creations', 'productdescription': '1957 die cast Corvette Convertible in Roman Red with white sides and whitewall tires. 1:18 scale quality die-cast with detailed engine and underbvody. Now you can own The Classic Corvette.', 'buyprice': 69.93}, {'productname': '1980s Black Hawk Helicopter', 'productline': 'Planes', 'productvendor': 'Red Start Diecast', 'productdescription': '1:18 scale replica of actual Armys UH-60L BLACK HAWK Helicopter. 100% hand-assembled. Features rotating rotor blades, propeller blades and rubber wheels.', 'buyprice': 77.27}, {'productname': 'Diamond T620 Semi-Skirted Tanker', 'productline': 'Trucks and Buses', 'productvendor': 'Highway 66 Mini Classics', 'productdescription': 'This limited edition model is licensed and perfectly scaled for Lionel Trains. The Diamond T620 has been produced in solid precision diecast and pain ... (26 characters truncated) ... el finish. It comes with a removable tanker and is a perfect model to add authenticity to your static train or car layout or to just have on display.', 'buyprice': 68.29}, {'productname': '1976 Ford Gran Torino', 'productline': 'Classic Cars', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'Highly detailed 1976 Ford Gran Torino \\"Starsky and Hutch\\" diecast model. Very well constructed and painted in red and white patterns.', 'buyprice': 73.49}  ... displaying 10 of 110 total bound parameter sets ...  {'productname': '1995 Honda Civic', 'productline': 'Classic Cars', 'productvendor': 'Min Lin Diecast', 'productdescription': 'This model features, opening hood, opening doors, detailed engine, rear spoiler, opening trunk, working steering, tinted windows, baked enamel finish. Color yellow.', 'buyprice': 93.89}, {'productname': '1968 Ford Mustang', 'productline': 'Classic Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Hood, doors and trunk all open to reveal highly detailed interior features. Steering wheel actually turns the front wheels. Color dark green.', 'buyprice': 95.34})]
(Background on this error at: http://sqlalche.me/e/14/f405); 49445)
[2022-06-20 00:32:43,664] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:32:43,740] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:34:23,932] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:34:23,954] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:34:23,954] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:34:23,954] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:34:23,954] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:34:23,976] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:34:23,988] {standard_task_runner.py:52} INFO - Started process 51023 to run task
[2022-06-20 00:34:23,994] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '370', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp8hhurq82', '--error-file', '/tmp/tmpbj79svje']
[2022-06-20 00:34:23,995] {standard_task_runner.py:80} INFO - Job 370: Subtask load_DMs
[2022-06-20 00:34:24,082] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:34:24,205] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:34:24,349] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 00:34:24,387] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T033423, end_date=20220620T033424
[2022-06-20 00:34:24,447] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 00:34:24,528] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:46:17,648] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:46:17,672] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:46:17,673] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:46:17,673] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:46:17,673] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:46:17,699] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:46:17,712] {standard_task_runner.py:52} INFO - Started process 54191 to run task
[2022-06-20 00:46:17,719] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '386', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmptzy8_7oi', '--error-file', '/tmp/tmp_te2z6s8']
[2022-06-20 00:46:17,720] {standard_task_runner.py:80} INFO - Job 386: Subtask load_DMs
[2022-06-20 00:46:17,809] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:46:17,927] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:46:18,265] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 136, in load_DMs
    df_emp.to_sql('dm_emp', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^

[SQL: INSERT INTO dm_emp (customername, contactlastname, creditlimit, contactfirstname, addressline1, productname, productvendor, orderdate, requireddate, shippeddate, lastname, firstname, quantityordered, priceeach, buyprice) VALUES (%(customername)s, %(contactlastname)s, %(creditlimit)s, %(contactfirstname)s, %(addressline1)s, %(productname)s, %(productvendor)s, %(orderdate)s, %(requireddate)s, %(shippeddate)s, %(lastname)s, %(firstname)s, %(quantityordered)s, %(priceeach)s, %(buyprice)s)]
[parameters: ({'customername': 'Daedalus Designs Imports', 'contactlastname': 'Ranc', 'creditlimit': 82900.0, 'contactfirstname': 'Martine ', 'addressline1': '184, chausse de Tournai', 'productname': '1961 Chevrolet Impala', 'productvendor': 'Classic Metal Creations', 'orderdate': datetime.date(2003, 11, 11), 'requireddate': datetime.date(2003, 11, 19), 'shippeddate': datetime.date(2003, 11, 14), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 28.0, 'priceeach': 68.71, 'buyprice': 32.33}, {'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'creditlimit': 71800.0, 'contactfirstname': 'Jean', 'addressline1': '8489 Strong St.', 'productname': '1952 Citroen-15CV', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 5), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Thompson', 'firstname': 'Leslie', 'quantityordered': 24.0, 'priceeach': 117.44, 'buyprice': 72.82}, {'customername': 'Tokyo Collectables, Ltd', 'contactlastname': 'Shimamura', 'creditlimit': 94400.0, 'contactfirstname': 'Akiko', 'addressline1': '2-2-8 Roppongi', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2004, 11, 23), 'requireddate': datetime.date(2004, 11, 30), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Nishi', 'firstname': 'Mami', 'quantityordered': 55.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Oulu Toy Supplies, Inc.', 'contactlastname': 'Koskitalo', 'creditlimit': 90500.0, 'contactfirstname': 'Pirkko', 'addressline1': 'Torikatu 38', 'productname': '1969 Dodge Charger', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 4, 12), 'requireddate': datetime.date(2004, 4, 21), 'shippeddate': datetime.date(2004, 4, 17), 'lastname': 'Bott', 'firstname': 'Larry', 'quantityordered': 21.0, 'priceeach': 100.19, 'buyprice': 58.73}, {'customername': 'Online Mini Collectables', 'contactlastname': 'Barajas', 'creditlimit': 68700.0, 'contactfirstname': 'Miguel', 'addressline1': '7635 Spinnaker Dr.', 'productname': 'The Queen Mary', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 9, 10), 'requireddate': datetime.date(2004, 9, 17), 'shippeddate': datetime.date(2004, 9, 14), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 45.0, 'priceeach': 98.32, 'buyprice': 53.63}, {'customername': 'Alpha Cognac', 'contactlastname': 'Roulet', 'creditlimit': 61100.0, 'contactfirstname': 'Annette ', 'addressline1': '1 rue Alsace-Lorraine', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2003, 11, 8), 'requireddate': datetime.date(2003, 11, 16), 'shippeddate': datetime.date(2003, 11, 10), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 34.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': 'F/A 18 Hornet 1/72', 'productvendor': 'Motor City Art Classics', 'orderdate': datetime.date(2003, 4, 29), 'requireddate': datetime.date(2003, 5, 8), 'shippeddate': datetime.date(2003, 5, 1), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 43.0, 'priceeach': 72.0, 'buyprice': 54.4}, {'customername': 'Lyon Souveniers', 'contactlastname': 'Da Silva', 'creditlimit': 68100.0, 'contactfirstname': 'Daniel', 'addressline1': '27 rue du Colonel Pierre Avia', 'productname': '2001 Ferrari Enzo', 'productvendor': 'Second Gear Diecast', 'orderdate': datetime.date(2005, 3, 17), 'requireddate': datetime.date(2005, 3, 24), 'shippeddate': datetime.date(2005, 3, 23), 'lastname': 'Bondur', 'firstname': 'Loui', 'quantityordered': 33.0, 'priceeach': 205.72, 'buyprice': 95.59}  ... displaying 10 of 2855 total bound parameter sets ...  {'customername': 'Corporate Gift Ideas Co.', 'contactlastname': 'Brown', 'creditlimit': 105000.0, 'contactfirstname': 'Julie', 'addressline1': '7734 Strong St.', 'productname': '1912 Ford Model T Delivery Wagon', 'productvendor': 'Min Lin Diecast', 'orderdate': datetime.date(2005, 2, 23), 'requireddate': datetime.date(2005, 3, 6), 'shippeddate': datetime.date(2005, 2, 27), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 43.0, 'priceeach': 71.69, 'buyprice': 46.91}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': '1928 Mercedes-Benz SSK', 'productvendor': 'Gearbox Collectibles', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 7), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 21.0, 'priceeach': 136.69, 'buyprice': 72.56})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 00:46:18,594] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T034617, end_date=20220620T034618
[2022-06-20 00:46:18,617] {standard_task_runner.py:92} ERROR - Failed to execute job 386 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^

[SQL: INSERT INTO dm_emp (customername, contactlastname, creditlimit, contactfirstname, addressline1, productname, productvendor, orderdate, requireddate, shippeddate, lastname, firstname, quantityordered, priceeach, buyprice) VALUES (%(customername)s, %(contactlastname)s, %(creditlimit)s, %(contactfirstname)s, %(addressline1)s, %(productname)s, %(productvendor)s, %(orderdate)s, %(requireddate)s, %(shippeddate)s, %(lastname)s, %(firstname)s, %(quantityordered)s, %(priceeach)s, %(buyprice)s)]
[parameters: ({'customername': 'Daedalus Designs Imports', 'contactlastname': 'Ranc', 'creditlimit': 82900.0, 'contactfirstname': 'Martine ', 'addressline1': '184, chausse de Tournai', 'productname': '1961 Chevrolet Impala', 'productvendor': 'Classic Metal Creations', 'orderdate': datetime.date(2003, 11, 11), 'requireddate': datetime.date(2003, 11, 19), 'shippeddate': datetime.date(2003, 11, 14), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 28.0, 'priceeach': 68.71, 'buyprice': 32.33}, {'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'creditlimit': 71800.0, 'contactfirstname': 'Jean', 'addressline1': '8489 Strong St.', 'productname': '1952 Citroen-15CV', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 5), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Thompson', 'firstname': 'Leslie', 'quantityordered': 24.0, 'priceeach': 117.44, 'buyprice': 72.82}, {'customername': 'Tokyo Collectables, Ltd', 'contactlastname': 'Shimamura', 'creditlimit': 94400.0, 'contactfirstname': 'Akiko', 'addressline1': '2-2-8 Roppongi', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2004, 11, 23), 'requireddate': datetime.date(2004, 11, 30), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Nishi', 'firstname': 'Mami', 'quantityordered': 55.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Oulu Toy Supplies, Inc.', 'contactlastname': 'Koskitalo', 'creditlimit': 90500.0, 'contactfirstname': 'Pirkko', 'addressline1': 'Torikatu 38', 'productname': '1969 Dodge Charger', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 4, 12), 'requireddate': datetime.date(2004, 4, 21), 'shippeddate': datetime.date(2004, 4, 17), 'lastname': 'Bott', 'firstname': 'Larry', 'quantityordered': 21.0, 'priceeach': 100.19, 'buyprice': 58.73}, {'customername': 'Online Mini Collectables', 'contactlastname': 'Barajas', 'creditlimit': 68700.0, 'contactfirstname': 'Miguel', 'addressline1': '7635 Spinnaker Dr.', 'productname': 'The Queen Mary', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 9, 10), 'requireddate': datetime.date(2004, 9, 17), 'shippeddate': datetime.date(2004, 9, 14), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 45.0, 'priceeach': 98.32, 'buyprice': 53.63}, {'customername': 'Alpha Cognac', 'contactlastname': 'Roulet', 'creditlimit': 61100.0, 'contactfirstname': 'Annette ', 'addressline1': '1 rue Alsace-Lorraine', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2003, 11, 8), 'requireddate': datetime.date(2003, 11, 16), 'shippeddate': datetime.date(2003, 11, 10), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 34.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': 'F/A 18 Hornet 1/72', 'productvendor': 'Motor City Art Classics', 'orderdate': datetime.date(2003, 4, 29), 'requireddate': datetime.date(2003, 5, 8), 'shippeddate': datetime.date(2003, 5, 1), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 43.0, 'priceeach': 72.0, 'buyprice': 54.4}, {'customername': 'Lyon Souveniers', 'contactlastname': 'Da Silva', 'creditlimit': 68100.0, 'contactfirstname': 'Daniel', 'addressline1': '27 rue du Colonel Pierre Avia', 'productname': '2001 Ferrari Enzo', 'productvendor': 'Second Gear Diecast', 'orderdate': datetime.date(2005, 3, 17), 'requireddate': datetime.date(2005, 3, 24), 'shippeddate': datetime.date(2005, 3, 23), 'lastname': 'Bondur', 'firstname': 'Loui', 'quantityordered': 33.0, 'priceeach': 205.72, 'buyprice': 95.59}  ... displaying 10 of 2855 total bound parameter sets ...  {'customername': 'Corporate Gift Ideas Co.', 'contactlastname': 'Brown', 'creditlimit': 105000.0, 'contactfirstname': 'Julie', 'addressline1': '7734 Strong St.', 'productname': '1912 Ford Model T Delivery Wagon', 'productvendor': 'Min Lin Diecast', 'orderdate': datetime.date(2005, 2, 23), 'requireddate': datetime.date(2005, 3, 6), 'shippeddate': datetime.date(2005, 2, 27), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 43.0, 'priceeach': 71.69, 'buyprice': 46.91}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': '1928 Mercedes-Benz SSK', 'productvendor': 'Gearbox Collectibles', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 7), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 21.0, 'priceeach': 136.69, 'buyprice': 72.56})]
(Background on this error at: http://sqlalche.me/e/14/f405); 54191)
[2022-06-20 00:46:18,652] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:46:18,755] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:51:37,843] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:51:37,864] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:51:37,864] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:51:37,864] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:51:37,865] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:51:37,885] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:51:37,896] {standard_task_runner.py:52} INFO - Started process 56780 to run task
[2022-06-20 00:51:37,901] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '403', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpczetag1p', '--error-file', '/tmp/tmphfkrg9z6']
[2022-06-20 00:51:37,901] {standard_task_runner.py:80} INFO - Job 403: Subtask load_DMs
[2022-06-20 00:51:37,991] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:51:38,117] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:51:38,447] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 136, in load_DMs
    df_emp.to_sql('dm_emp', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^

[SQL: INSERT INTO dm_emp (customername, contactlastname, creditlimit, contactfirstname, addressline1, productname, productvendor, orderdate, requireddate, shippeddate, lastname, firstname, quantityordered, priceeach, buyprice) VALUES (%(customername)s, %(contactlastname)s, %(creditlimit)s, %(contactfirstname)s, %(addressline1)s, %(productname)s, %(productvendor)s, %(orderdate)s, %(requireddate)s, %(shippeddate)s, %(lastname)s, %(firstname)s, %(quantityordered)s, %(priceeach)s, %(buyprice)s)]
[parameters: ({'customername': 'Daedalus Designs Imports', 'contactlastname': 'Ranc', 'creditlimit': 82900.0, 'contactfirstname': 'Martine ', 'addressline1': '184, chausse de Tournai', 'productname': '1961 Chevrolet Impala', 'productvendor': 'Classic Metal Creations', 'orderdate': datetime.date(2003, 11, 11), 'requireddate': datetime.date(2003, 11, 19), 'shippeddate': datetime.date(2003, 11, 14), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 28.0, 'priceeach': 68.71, 'buyprice': 32.33}, {'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'creditlimit': 71800.0, 'contactfirstname': 'Jean', 'addressline1': '8489 Strong St.', 'productname': '1952 Citroen-15CV', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 5), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Thompson', 'firstname': 'Leslie', 'quantityordered': 24.0, 'priceeach': 117.44, 'buyprice': 72.82}, {'customername': 'Tokyo Collectables, Ltd', 'contactlastname': 'Shimamura', 'creditlimit': 94400.0, 'contactfirstname': 'Akiko', 'addressline1': '2-2-8 Roppongi', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2004, 11, 23), 'requireddate': datetime.date(2004, 11, 30), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Nishi', 'firstname': 'Mami', 'quantityordered': 55.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Oulu Toy Supplies, Inc.', 'contactlastname': 'Koskitalo', 'creditlimit': 90500.0, 'contactfirstname': 'Pirkko', 'addressline1': 'Torikatu 38', 'productname': '1969 Dodge Charger', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 4, 12), 'requireddate': datetime.date(2004, 4, 21), 'shippeddate': datetime.date(2004, 4, 17), 'lastname': 'Bott', 'firstname': 'Larry', 'quantityordered': 21.0, 'priceeach': 100.19, 'buyprice': 58.73}, {'customername': 'Online Mini Collectables', 'contactlastname': 'Barajas', 'creditlimit': 68700.0, 'contactfirstname': 'Miguel', 'addressline1': '7635 Spinnaker Dr.', 'productname': 'The Queen Mary', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 9, 10), 'requireddate': datetime.date(2004, 9, 17), 'shippeddate': datetime.date(2004, 9, 14), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 45.0, 'priceeach': 98.32, 'buyprice': 53.63}, {'customername': 'Alpha Cognac', 'contactlastname': 'Roulet', 'creditlimit': 61100.0, 'contactfirstname': 'Annette ', 'addressline1': '1 rue Alsace-Lorraine', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2003, 11, 8), 'requireddate': datetime.date(2003, 11, 16), 'shippeddate': datetime.date(2003, 11, 10), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 34.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': 'F/A 18 Hornet 1/72', 'productvendor': 'Motor City Art Classics', 'orderdate': datetime.date(2003, 4, 29), 'requireddate': datetime.date(2003, 5, 8), 'shippeddate': datetime.date(2003, 5, 1), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 43.0, 'priceeach': 72.0, 'buyprice': 54.4}, {'customername': 'Lyon Souveniers', 'contactlastname': 'Da Silva', 'creditlimit': 68100.0, 'contactfirstname': 'Daniel', 'addressline1': '27 rue du Colonel Pierre Avia', 'productname': '2001 Ferrari Enzo', 'productvendor': 'Second Gear Diecast', 'orderdate': datetime.date(2005, 3, 17), 'requireddate': datetime.date(2005, 3, 24), 'shippeddate': datetime.date(2005, 3, 23), 'lastname': 'Bondur', 'firstname': 'Loui', 'quantityordered': 33.0, 'priceeach': 205.72, 'buyprice': 95.59}  ... displaying 10 of 2855 total bound parameter sets ...  {'customername': 'Corporate Gift Ideas Co.', 'contactlastname': 'Brown', 'creditlimit': 105000.0, 'contactfirstname': 'Julie', 'addressline1': '7734 Strong St.', 'productname': '1912 Ford Model T Delivery Wagon', 'productvendor': 'Min Lin Diecast', 'orderdate': datetime.date(2005, 2, 23), 'requireddate': datetime.date(2005, 3, 6), 'shippeddate': datetime.date(2005, 2, 27), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 43.0, 'priceeach': 71.69, 'buyprice': 46.91}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': '1928 Mercedes-Benz SSK', 'productvendor': 'Gearbox Collectibles', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 7), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 21.0, 'priceeach': 136.69, 'buyprice': 72.56})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 00:51:38,781] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T035137, end_date=20220620T035138
[2022-06-20 00:51:38,806] {standard_task_runner.py:92} ERROR - Failed to execute job 403 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^

[SQL: INSERT INTO dm_emp (customername, contactlastname, creditlimit, contactfirstname, addressline1, productname, productvendor, orderdate, requireddate, shippeddate, lastname, firstname, quantityordered, priceeach, buyprice) VALUES (%(customername)s, %(contactlastname)s, %(creditlimit)s, %(contactfirstname)s, %(addressline1)s, %(productname)s, %(productvendor)s, %(orderdate)s, %(requireddate)s, %(shippeddate)s, %(lastname)s, %(firstname)s, %(quantityordered)s, %(priceeach)s, %(buyprice)s)]
[parameters: ({'customername': 'Daedalus Designs Imports', 'contactlastname': 'Ranc', 'creditlimit': 82900.0, 'contactfirstname': 'Martine ', 'addressline1': '184, chausse de Tournai', 'productname': '1961 Chevrolet Impala', 'productvendor': 'Classic Metal Creations', 'orderdate': datetime.date(2003, 11, 11), 'requireddate': datetime.date(2003, 11, 19), 'shippeddate': datetime.date(2003, 11, 14), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 28.0, 'priceeach': 68.71, 'buyprice': 32.33}, {'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'creditlimit': 71800.0, 'contactfirstname': 'Jean', 'addressline1': '8489 Strong St.', 'productname': '1952 Citroen-15CV', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 5), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Thompson', 'firstname': 'Leslie', 'quantityordered': 24.0, 'priceeach': 117.44, 'buyprice': 72.82}, {'customername': 'Tokyo Collectables, Ltd', 'contactlastname': 'Shimamura', 'creditlimit': 94400.0, 'contactfirstname': 'Akiko', 'addressline1': '2-2-8 Roppongi', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2004, 11, 23), 'requireddate': datetime.date(2004, 11, 30), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Nishi', 'firstname': 'Mami', 'quantityordered': 55.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Oulu Toy Supplies, Inc.', 'contactlastname': 'Koskitalo', 'creditlimit': 90500.0, 'contactfirstname': 'Pirkko', 'addressline1': 'Torikatu 38', 'productname': '1969 Dodge Charger', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 4, 12), 'requireddate': datetime.date(2004, 4, 21), 'shippeddate': datetime.date(2004, 4, 17), 'lastname': 'Bott', 'firstname': 'Larry', 'quantityordered': 21.0, 'priceeach': 100.19, 'buyprice': 58.73}, {'customername': 'Online Mini Collectables', 'contactlastname': 'Barajas', 'creditlimit': 68700.0, 'contactfirstname': 'Miguel', 'addressline1': '7635 Spinnaker Dr.', 'productname': 'The Queen Mary', 'productvendor': 'Welly Diecast Productions', 'orderdate': datetime.date(2004, 9, 10), 'requireddate': datetime.date(2004, 9, 17), 'shippeddate': datetime.date(2004, 9, 14), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 45.0, 'priceeach': 98.32, 'buyprice': 53.63}, {'customername': 'Alpha Cognac', 'contactlastname': 'Roulet', 'creditlimit': 61100.0, 'contactfirstname': 'Annette ', 'addressline1': '1 rue Alsace-Lorraine', 'productname': 'HMS Bounty', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2003, 11, 8), 'requireddate': datetime.date(2003, 11, 16), 'shippeddate': datetime.date(2003, 11, 10), 'lastname': 'Hernandez', 'firstname': 'Gerard', 'quantityordered': 34.0, 'priceeach': 86.9, 'buyprice': 39.83}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': 'F/A 18 Hornet 1/72', 'productvendor': 'Motor City Art Classics', 'orderdate': datetime.date(2003, 4, 29), 'requireddate': datetime.date(2003, 5, 8), 'shippeddate': datetime.date(2003, 5, 1), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 43.0, 'priceeach': 72.0, 'buyprice': 54.4}, {'customername': 'Lyon Souveniers', 'contactlastname': 'Da Silva', 'creditlimit': 68100.0, 'contactfirstname': 'Daniel', 'addressline1': '27 rue du Colonel Pierre Avia', 'productname': '2001 Ferrari Enzo', 'productvendor': 'Second Gear Diecast', 'orderdate': datetime.date(2005, 3, 17), 'requireddate': datetime.date(2005, 3, 24), 'shippeddate': datetime.date(2005, 3, 23), 'lastname': 'Bondur', 'firstname': 'Loui', 'quantityordered': 33.0, 'priceeach': 205.72, 'buyprice': 95.59}  ... displaying 10 of 2855 total bound parameter sets ...  {'customername': 'Corporate Gift Ideas Co.', 'contactlastname': 'Brown', 'creditlimit': 105000.0, 'contactfirstname': 'Julie', 'addressline1': '7734 Strong St.', 'productname': '1912 Ford Model T Delivery Wagon', 'productvendor': 'Min Lin Diecast', 'orderdate': datetime.date(2005, 2, 23), 'requireddate': datetime.date(2005, 3, 6), 'shippeddate': datetime.date(2005, 2, 27), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 43.0, 'priceeach': 71.69, 'buyprice': 46.91}, {'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'creditlimit': 117300.0, 'contactfirstname': 'Peter', 'addressline1': '636 St Kilda Road', 'productname': '1928 Mercedes-Benz SSK', 'productvendor': 'Gearbox Collectibles', 'orderdate': datetime.date(2004, 11, 29), 'requireddate': datetime.date(2004, 12, 7), 'shippeddate': datetime.date(2004, 11, 30), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 21.0, 'priceeach': 136.69, 'buyprice': 72.56})]
(Background on this error at: http://sqlalche.me/e/14/f405); 56780)
[2022-06-20 00:51:38,835] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:51:38,941] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 00:57:00,449] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:57:00,473] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 00:57:00,474] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:57:00,474] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 00:57:00,474] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 00:57:00,503] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 00:57:00,518] {standard_task_runner.py:52} INFO - Started process 58917 to run task
[2022-06-20 00:57:00,525] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '420', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp26b4054i', '--error-file', '/tmp/tmpun315kpv']
[2022-06-20 00:57:00,526] {standard_task_runner.py:80} INFO - Job 420: Subtask load_DMs
[2022-06-20 00:57:00,641] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 00:57:00,805] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 00:57:01,117] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 136, in load_DMs
    df_emp.to_sql('dm_emp', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^

[SQL: INSERT INTO dm_emp (customername, contactlastname, creditlimit, contactfirstname, addressline1, productname, productvendor, orderdate, requireddate, shippeddate, lastname, firstname, quantityordered, priceeach) VALUES (%(customername)s, %(contactlastname)s, %(creditlimit)s, %(contactfirstname)s, %(addressline1)s, %(productname)s, %(productvendor)s, %(orderdate)s, %(requireddate)s, %(shippeddate)s, %(lastname)s, %(firstname)s, %(quantityordered)s, %(priceeach)s)]
[parameters: ({'customername': 'Mini Creations Ltd.', 'contactlastname': 'Huang', 'creditlimit': 94500.0, 'contactfirstname': 'Wing', 'addressline1': '4575 Hillside Dr.', 'productname': 'Pont Yacht', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2003, 11, 14), 'requireddate': datetime.date(2003, 11, 21), 'shippeddate': datetime.date(2003, 11, 20), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 28.0, 'priceeach': 47.5}, {'customername': 'Gift Depot Inc.', 'contactlastname': 'King', 'creditlimit': 84300.0, 'contactfirstname': 'Julie', 'addressline1': '25593 South Bay Ln.', 'productname': 'ATA: B757-300', 'productvendor': 'Highway 66 Mini Classics', 'orderdate': datetime.date(2004, 6, 28), 'requireddate': datetime.date(2004, 7, 4), 'shippeddate': datetime.date(2004, 7, 2), 'lastname': 'Vanauf', 'firstname': 'George', 'quantityordered': 47.0, 'priceeach': 117.46}, {'customername': 'Qubec Home Shopping Network', 'contactlastname': 'Fresnire', 'creditlimit': 48700.0, 'contactfirstname': 'Jean ', 'addressline1': '43 rue St. Laurent', 'productname': '1904 Buick Runabout', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 6, 17), 'requireddate': datetime.date(2004, 6, 25), 'shippeddate': datetime.date(2004, 6, 22), 'lastname': 'Tseng', 'firstname': 'Foon Yue', 'quantityordered': 20.0, 'priceeach': 80.75}, {'customername': 'Saveley & Henriot, Co.', 'contactlastname': 'Saveley', 'creditlimit': 123900.0, 'contactfirstname': 'Mary ', 'addressline1': '2, rue du Commerce', 'productname': '1940s Ford truck', 'productvendor': 'Motor City Art Classics', 'orderdate': datetime.date(2003, 11, 25), 'requireddate': datetime.date(2003, 12, 2), 'shippeddate': datetime.date(2003, 11, 26), 'lastname': 'Bondur', 'firstname': 'Loui', 'quantityordered': 32.0, 'priceeach': 113.82}, {'customername': 'Online Mini Collectables', 'contactlastname': 'Barajas', 'creditlimit': 68700.0, 'contactfirstname': 'Miguel', 'addressline1': '7635 Spinnaker Dr.', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productvendor': 'Second Gear Diecast', 'orderdate': datetime.date(2004, 8, 2), 'requireddate': datetime.date(2004, 8, 11), 'shippeddate': datetime.date(2004, 8, 8), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 38.0, 'priceeach': 94.91}, {'customername': 'Mini Gifts Distributors Ltd.', 'contactlastname': 'Nelson', 'creditlimit': 210500.0, 'contactfirstname': 'Susan', 'addressline1': '5677 Strong St.', 'productname': '1926 Ford Fire Engine', 'productvendor': 'Carousel DieCast Legends', 'orderdate': datetime.date(2004, 7, 20), 'requireddate': datetime.date(2004, 7, 29), 'shippeddate': datetime.date(2004, 7, 23), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 25.0, 'priceeach': 59.55}, {'customername': 'Australian Collectables, Ltd', 'contactlastname': 'Clenahan', 'creditlimit': 60300.0, 'contactfirstname': 'Sean', 'addressline1': '7 Allen Street', 'productname': '1917 Maxwell Touring Car', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2003, 11, 21), 'requireddate': datetime.date(2003, 11, 28), 'shippeddate': datetime.date(2003, 11, 27), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 32.0, 'priceeach': 79.37}, {'customername': 'Kellys Gift Shop', 'contactlastname': 'Snowden', 'creditlimit': 110000.0, 'contactfirstname': 'Tony', 'addressline1': 'Arenales 1938 3A', 'productname': '2002 Chevy Corvette', 'productvendor': 'Gearbox Collectibles', 'orderdate': datetime.date(2003, 7, 7), 'requireddate': datetime.date(2003, 7, 16), 'shippeddate': datetime.date(2003, 7, 13), 'lastname': 'Marsh', 'firstname': 'Peter', 'quantityordered': 21.0, 'priceeach': 99.58}  ... displaying 10 of 2855 total bound parameter sets ...  {'customername': 'Bavarian Collectables Imports, Co.', 'contactlastname': 'Donnermeyer', 'creditlimit': 77000.0, 'contactfirstname': 'Michael', 'addressline1': 'Hansastr. 15', 'productname': '1941 Chevrolet Special Deluxe Cabriolet', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 9, 15), 'requireddate': datetime.date(2004, 9, 22), 'shippeddate': datetime.date(2004, 9, 16), 'lastname': 'Jones', 'firstname': 'Barry', 'quantityordered': 22.0, 'priceeach': 105.87}, {'customername': 'Mini Gifts Distributors Ltd.', 'contactlastname': 'Nelson', 'creditlimit': 210500.0, 'contactfirstname': 'Susan', 'addressline1': '5677 Strong St.', 'productname': '1982 Camaro Z28', 'productvendor': 'Carousel DieCast Legends', 'orderdate': datetime.date(2004, 3, 11), 'requireddate': datetime.date(2004, 3, 20), 'shippeddate': datetime.date(2004, 3, 12), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 50.0, 'priceeach': 91.04})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 00:57:01,419] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T035700, end_date=20220620T035701
[2022-06-20 00:57:01,446] {standard_task_runner.py:92} ERROR - Failed to execute job 420 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "customername" of relation "dm_emp" does not exist
LINE 1: INSERT INTO dm_emp (customername, contactlastname, creditlim...
                            ^

[SQL: INSERT INTO dm_emp (customername, contactlastname, creditlimit, contactfirstname, addressline1, productname, productvendor, orderdate, requireddate, shippeddate, lastname, firstname, quantityordered, priceeach) VALUES (%(customername)s, %(contactlastname)s, %(creditlimit)s, %(contactfirstname)s, %(addressline1)s, %(productname)s, %(productvendor)s, %(orderdate)s, %(requireddate)s, %(shippeddate)s, %(lastname)s, %(firstname)s, %(quantityordered)s, %(priceeach)s)]
[parameters: ({'customername': 'Mini Creations Ltd.', 'contactlastname': 'Huang', 'creditlimit': 94500.0, 'contactfirstname': 'Wing', 'addressline1': '4575 Hillside Dr.', 'productname': 'Pont Yacht', 'productvendor': 'Unimax Art Galleries', 'orderdate': datetime.date(2003, 11, 14), 'requireddate': datetime.date(2003, 11, 21), 'shippeddate': datetime.date(2003, 11, 20), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 28.0, 'priceeach': 47.5}, {'customername': 'Gift Depot Inc.', 'contactlastname': 'King', 'creditlimit': 84300.0, 'contactfirstname': 'Julie', 'addressline1': '25593 South Bay Ln.', 'productname': 'ATA: B757-300', 'productvendor': 'Highway 66 Mini Classics', 'orderdate': datetime.date(2004, 6, 28), 'requireddate': datetime.date(2004, 7, 4), 'shippeddate': datetime.date(2004, 7, 2), 'lastname': 'Vanauf', 'firstname': 'George', 'quantityordered': 47.0, 'priceeach': 117.46}, {'customername': 'Qubec Home Shopping Network', 'contactlastname': 'Fresnire', 'creditlimit': 48700.0, 'contactfirstname': 'Jean ', 'addressline1': '43 rue St. Laurent', 'productname': '1904 Buick Runabout', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 6, 17), 'requireddate': datetime.date(2004, 6, 25), 'shippeddate': datetime.date(2004, 6, 22), 'lastname': 'Tseng', 'firstname': 'Foon Yue', 'quantityordered': 20.0, 'priceeach': 80.75}, {'customername': 'Saveley & Henriot, Co.', 'contactlastname': 'Saveley', 'creditlimit': 123900.0, 'contactfirstname': 'Mary ', 'addressline1': '2, rue du Commerce', 'productname': '1940s Ford truck', 'productvendor': 'Motor City Art Classics', 'orderdate': datetime.date(2003, 11, 25), 'requireddate': datetime.date(2003, 12, 2), 'shippeddate': datetime.date(2003, 11, 26), 'lastname': 'Bondur', 'firstname': 'Loui', 'quantityordered': 32.0, 'priceeach': 113.82}, {'customername': 'Online Mini Collectables', 'contactlastname': 'Barajas', 'creditlimit': 68700.0, 'contactfirstname': 'Miguel', 'addressline1': '7635 Spinnaker Dr.', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productvendor': 'Second Gear Diecast', 'orderdate': datetime.date(2004, 8, 2), 'requireddate': datetime.date(2004, 8, 11), 'shippeddate': datetime.date(2004, 8, 8), 'lastname': 'Firrelli', 'firstname': 'Julie', 'quantityordered': 38.0, 'priceeach': 94.91}, {'customername': 'Mini Gifts Distributors Ltd.', 'contactlastname': 'Nelson', 'creditlimit': 210500.0, 'contactfirstname': 'Susan', 'addressline1': '5677 Strong St.', 'productname': '1926 Ford Fire Engine', 'productvendor': 'Carousel DieCast Legends', 'orderdate': datetime.date(2004, 7, 20), 'requireddate': datetime.date(2004, 7, 29), 'shippeddate': datetime.date(2004, 7, 23), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 25.0, 'priceeach': 59.55}, {'customername': 'Australian Collectables, Ltd', 'contactlastname': 'Clenahan', 'creditlimit': 60300.0, 'contactfirstname': 'Sean', 'addressline1': '7 Allen Street', 'productname': '1917 Maxwell Touring Car', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2003, 11, 21), 'requireddate': datetime.date(2003, 11, 28), 'shippeddate': datetime.date(2003, 11, 27), 'lastname': 'Fixter', 'firstname': 'Andy', 'quantityordered': 32.0, 'priceeach': 79.37}, {'customername': 'Kellys Gift Shop', 'contactlastname': 'Snowden', 'creditlimit': 110000.0, 'contactfirstname': 'Tony', 'addressline1': 'Arenales 1938 3A', 'productname': '2002 Chevy Corvette', 'productvendor': 'Gearbox Collectibles', 'orderdate': datetime.date(2003, 7, 7), 'requireddate': datetime.date(2003, 7, 16), 'shippeddate': datetime.date(2003, 7, 13), 'lastname': 'Marsh', 'firstname': 'Peter', 'quantityordered': 21.0, 'priceeach': 99.58}  ... displaying 10 of 2855 total bound parameter sets ...  {'customername': 'Bavarian Collectables Imports, Co.', 'contactlastname': 'Donnermeyer', 'creditlimit': 77000.0, 'contactfirstname': 'Michael', 'addressline1': 'Hansastr. 15', 'productname': '1941 Chevrolet Special Deluxe Cabriolet', 'productvendor': 'Exoto Designs', 'orderdate': datetime.date(2004, 9, 15), 'requireddate': datetime.date(2004, 9, 22), 'shippeddate': datetime.date(2004, 9, 16), 'lastname': 'Jones', 'firstname': 'Barry', 'quantityordered': 22.0, 'priceeach': 105.87}, {'customername': 'Mini Gifts Distributors Ltd.', 'contactlastname': 'Nelson', 'creditlimit': 210500.0, 'contactfirstname': 'Susan', 'addressline1': '5677 Strong St.', 'productname': '1982 Camaro Z28', 'productvendor': 'Carousel DieCast Legends', 'orderdate': datetime.date(2004, 3, 11), 'requireddate': datetime.date(2004, 3, 20), 'shippeddate': datetime.date(2004, 3, 12), 'lastname': 'Jennings', 'firstname': 'Leslie', 'quantityordered': 50.0, 'priceeach': 91.04})]
(Background on this error at: http://sqlalche.me/e/14/f405); 58917)
[2022-06-20 00:57:01,500] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 00:57:01,594] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:25:22,216] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:25:22,237] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:25:22,237] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:25:22,238] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:25:22,238] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:25:22,258] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:25:22,271] {standard_task_runner.py:52} INFO - Started process 79548 to run task
[2022-06-20 01:25:22,277] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '534', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp9uusy_dz', '--error-file', '/tmp/tmp5uttesnk']
[2022-06-20 01:25:22,278] {standard_task_runner.py:80} INFO - Job 534: Subtask load_DMs
[2022-06-20 01:25:22,367] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:25:22,474] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:25:22,594] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 01:25:22,615] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T042522, end_date=20220620T042522
[2022-06-20 01:25:22,650] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 01:25:22,712] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:28:03,994] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:28:04,017] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:28:04,018] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:28:04,018] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:28:04,018] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:28:04,037] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:28:04,049] {standard_task_runner.py:52} INFO - Started process 82581 to run task
[2022-06-20 01:28:04,054] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '562', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpjgpndbhb', '--error-file', '/tmp/tmp62evm687']
[2022-06-20 01:28:04,054] {standard_task_runner.py:80} INFO - Job 562: Subtask load_DMs
[2022-06-20 01:28:04,142] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:28:04,262] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:28:04,403] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 01:28:04,425] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T042803, end_date=20220620T042804
[2022-06-20 01:28:04,466] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 01:28:04,528] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:32:44,628] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:32:44,650] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:32:44,651] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:32:44,651] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:32:44,651] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:32:44,670] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:32:44,682] {standard_task_runner.py:52} INFO - Started process 84645 to run task
[2022-06-20 01:32:44,688] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '580', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp6vt8o0og', '--error-file', '/tmp/tmpduqkzb1u']
[2022-06-20 01:32:44,688] {standard_task_runner.py:80} INFO - Job 580: Subtask load_DMs
[2022-06-20 01:32:44,775] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:32:44,904] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:32:45,019] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 01:32:45,042] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T043244, end_date=20220620T043245
[2022-06-20 01:32:45,100] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 01:32:45,161] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 01:50:37,319] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:50:37,340] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 01:50:37,340] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:50:37,340] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 01:50:37,341] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 01:50:37,363] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 01:50:37,376] {standard_task_runner.py:52} INFO - Started process 90467 to run task
[2022-06-20 01:50:37,383] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '615', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmppwjj1ya2', '--error-file', '/tmp/tmplx3_6rb_']
[2022-06-20 01:50:37,384] {standard_task_runner.py:80} INFO - Job 615: Subtask load_DMs
[2022-06-20 01:50:37,489] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 01:50:37,628] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 01:50:37,786] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 01:50:37,816] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T045037, end_date=20220620T045037
[2022-06-20 01:50:37,875] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 01:50:37,967] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 02:29:09,785] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 02:29:09,797] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 02:29:09,797] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 02:29:09,797] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 02:29:09,797] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 02:29:09,810] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 02:29:09,814] {standard_task_runner.py:52} INFO - Started process 100820 to run task
[2022-06-20 02:29:09,818] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '664', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpsjla6vwy', '--error-file', '/tmp/tmpl90p7yfg']
[2022-06-20 02:29:09,819] {standard_task_runner.py:80} INFO - Job 664: Subtask load_DMs
[2022-06-20 02:29:09,887] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 02:29:09,972] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 02:29:10,153] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 02:29:10,173] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T052909, end_date=20220620T052910
[2022-06-20 02:29:10,229] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 02:29:10,278] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 03:25:22,582] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:25:22,594] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:25:22,594] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:25:22,594] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 03:25:22,594] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:25:22,606] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 03:25:22,612] {standard_task_runner.py:52} INFO - Started process 111171 to run task
[2022-06-20 03:25:22,617] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '682', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp105vl_d_', '--error-file', '/tmp/tmpojxoi0so']
[2022-06-20 03:25:22,618] {standard_task_runner.py:80} INFO - Job 682: Subtask load_DMs
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       [2022-06-20 03:39:11,338] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:39:11,361] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 03:39:11,361] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:39:11,361] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 03:39:11,361] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 03:39:11,383] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 03:39:11,393] {standard_task_runner.py:52} INFO - Started process 9203 to run task
[2022-06-20 03:39:11,398] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '716', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpfna7r88o', '--error-file', '/tmp/tmpqwu6sg5w']
[2022-06-20 03:39:11,399] {standard_task_runner.py:80} INFO - Job 716: Subtask load_DMs
[2022-06-20 03:39:11,482] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 03:39:11,595] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 03:39:11,799] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 03:39:11,821] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T063911, end_date=20220620T063911
[2022-06-20 03:39:11,850] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 03:39:11,909] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 04:38:03,185] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 04:38:03,208] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 04:38:03,208] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 04:38:03,208] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 04:38:03,208] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 04:38:03,229] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 04:38:03,240] {standard_task_runner.py:52} INFO - Started process 19638 to run task
[2022-06-20 04:38:03,245] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '738', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmps7u17py1', '--error-file', '/tmp/tmpwrl2xztz']
[2022-06-20 04:38:03,245] {standard_task_runner.py:80} INFO - Job 738: Subtask load_DMs
[2022-06-20 04:38:03,330] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 04:38:03,442] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 04:38:03,628] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 04:38:03,652] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T073803, end_date=20220620T073803
[2022-06-20 04:38:03,697] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 04:38:03,761] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 05:29:41,694] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 05:29:41,716] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 05:29:41,716] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 05:29:41,716] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 05:29:41,716] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 05:29:41,736] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 05:29:41,745] {standard_task_runner.py:52} INFO - Started process 31484 to run task
[2022-06-20 05:29:41,749] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '761', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpteh_gd88', '--error-file', '/tmp/tmp3o4umpe8']
[2022-06-20 05:29:41,750] {standard_task_runner.py:80} INFO - Job 761: Subtask load_DMs
[2022-06-20 05:29:41,838] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 05:29:41,948] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 05:29:42,032] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 135, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 05:29:42,053] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T082941, end_date=20220620T082942
[2022-06-20 05:29:42,074] {standard_task_runner.py:92} ERROR - Failed to execute job 761 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/f405); 31484)
[2022-06-20 05:29:42,122] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 05:29:42,195] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 11:30:02,009] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 11:30:02,024] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 11:30:02,024] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 11:30:02,024] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 11:30:02,024] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 11:30:02,036] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 11:30:02,043] {standard_task_runner.py:52} INFO - Started process 44016 to run task
[2022-06-20 11:30:02,047] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '779', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpw4wbc2k0', '--error-file', '/tmp/tmpufcbe80o']
[2022-06-20 11:30:02,047] {standard_task_runner.py:80} INFO - Job 779: Subtask load_DMs
[2022-06-20 11:30:02,106] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 11:30:02,197] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 11:30:02,253] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 135, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 11:30:02,269] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T143002, end_date=20220620T143002
[2022-06-20 11:30:02,286] {standard_task_runner.py:92} ERROR - Failed to execute job 779 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/f405); 44016)
[2022-06-20 11:30:02,338] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 11:30:02,399] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 11:33:14,824] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 11:33:14,836] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 11:33:14,836] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 11:33:14,836] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 11:33:14,836] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 11:33:14,848] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 11:33:14,856] {standard_task_runner.py:52} INFO - Started process 45981 to run task
[2022-06-20 11:33:14,861] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '797', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpks8484u5', '--error-file', '/tmp/tmpq9e5nq26']
[2022-06-20 11:33:14,861] {standard_task_runner.py:80} INFO - Job 797: Subtask load_DMs
[2022-06-20 11:33:14,920] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 11:33:15,005] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 11:33:15,070] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.UndefinedColumn: column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 135, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.ProgrammingError: (psycopg2.errors.UndefinedColumn) column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/f405)
[2022-06-20 11:33:15,088] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T143314, end_date=20220620T143315
[2022-06-20 11:33:15,103] {standard_task_runner.py:92} ERROR - Failed to execute job 797 for task load_DMs ((psycopg2.errors.UndefinedColumn) column "productcode" of relation "dm_products" does not exist
LINE 1: INSERT INTO dm_products (productcode, productname, productli...
                                 ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/f405); 45981)
[2022-06-20 11:33:15,153] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 11:33:15,199] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 11:46:15,676] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 11:46:15,689] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 11:46:15,690] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 11:46:15,690] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 11:46:15,690] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 11:46:15,702] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 11:46:15,710] {standard_task_runner.py:52} INFO - Started process 53011 to run task
[2022-06-20 11:46:15,714] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '49', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpzz4t_dhn', '--error-file', '/tmp/tmp8jxiy24i']
[2022-06-20 11:46:15,714] {standard_task_runner.py:80} INFO - Job 49: Subtask load_DMs
[2022-06-20 11:46:15,774] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 11:46:15,858] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 11:46:15,929] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.InvalidTextRepresentation: invalid input syntax for type integer: "S18_2870"
LINE 1: ...tline, productvendor, productdescription) VALUES ('S18_2870'...
                                                             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 135, in load_DMs
    df_prod.to_sql('dm_products', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "S18_2870"
LINE 1: ...tline, productvendor, productdescription) VALUES ('S18_2870'...
                                                             ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/9h9h)
[2022-06-20 11:46:15,945] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T144615, end_date=20220620T144615
[2022-06-20 11:46:15,960] {standard_task_runner.py:92} ERROR - Failed to execute job 49 for task load_DMs ((psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type integer: "S18_2870"
LINE 1: ...tline, productvendor, productdescription) VALUES ('S18_2870'...
                                                             ^

[SQL: INSERT INTO dm_products (productcode, productname, productline, productvendor, productdescription) VALUES (%(productcode)s, %(productname)s, %(productline)s, %(productvendor)s, %(productdescription)s)]
[parameters: ({'productcode': 'S18_2870', 'productname': '1999 Indy 500 Monte Carlo SS', 'productline': 'Classic Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Features include opening and closing doors. Color: Red'}, {'productcode': 'S32_4485', 'productname': '1974 Ducati 350 Mk3 Desmo', 'productline': 'Motorcycles', 'productvendor': 'Second Gear Diecast', 'productdescription': 'This model features two-tone paint with chrome accents, superior die-cast detail , rotating wheels , working kick stand'}, {'productcode': 'S18_1749', 'productname': '1917 Grand Touring Sedan', 'productline': 'Vintage Cars', 'productvendor': 'Welly Diecast Productions', 'productdescription': 'This 1:18 scale replica of the 1917 Grand Touring car has all the features you would expect from museum quality reproductions: all four doors and bi-fold hood opening, detailed engine and instrument panel, chrome-look trim, and tufted upholstery, all topped off with a factory baked-enamel finish.'}, {'productcode': 'S10_4962', 'productname': '1962 LanciaA Delta 16V', 'productline': 'Classic Cars', 'productvendor': 'Second Gear Diecast', 'productdescription': 'Features include: Turnable front wheels; steering function; detailed interior; detailed engine; opening hood; opening trunk; opening doors; and detailed chassis.'}, {'productcode': 'S32_3207', 'productname': '1950s Chicago Surface Lines Streetcar', 'productline': 'Trains', 'productvendor': 'Gearbox Collectibles', 'productdescription': 'This streetcar is a joy to see. It has 80 separate windows, electric wire guides, detailed interiors with seats, poles and drivers controls, rolling and turning wheel assemblies, plus authentic factory baked-enamel finishes (Green Hornet for Chicago and Cream and Crimson for Boston).'}, {'productcode': 'S24_3420', 'productname': '1937 Horch 930V Limousine', 'productline': 'Vintage Cars', 'productvendor': 'Autoart Studio Design', 'productdescription': 'Features opening hood, opening doors, opening trunk, wide white wall tires, front door arm rests, working steering system'}, {'productcode': 'S700_2466', 'productname': 'America West Airlines B757-200', 'productline': 'Planes', 'productvendor': 'Motor City Art Classics', 'productdescription': 'Official logos and insignias. Working steering system. Rotating jet engines'}, {'productcode': 'S700_1938', 'productname': 'The Mayflower', 'productline': 'Ships', 'productvendor': 'Studio M Art Models', 'productdescription': 'Measures 31 1/2 inches Long x 25 1/2 inches High x 10 5/8 inches Wide\\r\\nAll wood with canvas sail. Extras include long boats, rigging, ladders, railing, anchors, side cannons, hand painted, etc.'}  ... displaying 10 of 110 total bound parameter sets ...  {'productcode': 'S18_3232', 'productname': '1992 Ferrari 360 Spider red', 'productline': 'Classic Cars', 'productvendor': 'Unimax Art Galleries', 'productdescription': 'his replica features opening doors, superb detail and craftsmanship, working steering system, opening forward compartment, opening rear trunk with removable spare, 4 wheel independent spring suspension as well as factory baked enamel finish.'}, {'productcode': 'S18_3136', 'productname': '18th Century Vintage Horse Carriage', 'productline': 'Vintage Cars', 'productvendor': 'Red Start Diecast', 'productdescription': 'Hand crafted diecast-like metal horse carriage is re-created in about 1:18 scale of antique horse carriage. This antique style metal Stagecoach is al ... (37 characters truncated) ... parts.\\r\\n\\r\\nThis collectible metal horse carriage is painted in classic Red, and features turning steering wheel and is entirely hand-finished.'})]
(Background on this error at: http://sqlalche.me/e/14/9h9h); 53011)
[2022-06-20 11:46:16,006] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 11:46:16,068] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 12:08:21,752] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:08:21,765] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:08:21,766] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:08:21,766] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 12:08:21,766] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:08:21,777] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 12:08:21,781] {standard_task_runner.py:52} INFO - Started process 57728 to run task
[2022-06-20 12:08:21,785] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '67', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp8zfrx807', '--error-file', '/tmp/tmp5b2m40l4']
[2022-06-20 12:08:21,785] {standard_task_runner.py:80} INFO - Job 67: Subtask load_DMs
[2022-06-20 12:08:21,855] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 12:08:21,950] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 12:08:22,040] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "employeenumber" violates not-null constraint
DETAIL:  Failing row contains (1, null, Hernandez, Gerard, ghernande@classicmodelcars.com, Sales Rep).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 137, in load_DMs
    df_emp.to_sql('dm_emp', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "employeenumber" violates not-null constraint
DETAIL:  Failing row contains (1, null, Hernandez, Gerard, ghernande@classicmodelcars.com, Sales Rep).

[SQL: INSERT INTO dm_emp (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Hernandez', 'firstname': 'Gerard', 'email': 'ghernande@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Tseng', 'firstname': 'Foon Yue', 'email': 'ftseng@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bondur', 'firstname': 'Gerard', 'email': 'gbondur@classicmodelcars.com', 'jobtitle': 'Sale Manager (EMEA)'}, {'lastname': 'Patterson', 'firstname': 'Mary', 'email': 'mpatterso@classicmodelcars.com', 'jobtitle': 'VP Sales'}, {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'William', 'email': 'wpatterson@classicmodelcars.com', 'jobtitle': 'Sales Manager (APAC)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Bondur', 'firstname': 'Loui', 'email': 'lbondur@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 12:08:22,060] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T150821, end_date=20220620T150822
[2022-06-20 12:08:22,075] {standard_task_runner.py:92} ERROR - Failed to execute job 67 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "employeenumber" violates not-null constraint
DETAIL:  Failing row contains (1, null, Hernandez, Gerard, ghernande@classicmodelcars.com, Sales Rep).

[SQL: INSERT INTO dm_emp (lastname, firstname, email, jobtitle) VALUES (%(lastname)s, %(firstname)s, %(email)s, %(jobtitle)s)]
[parameters: ({'lastname': 'Hernandez', 'firstname': 'Gerard', 'email': 'ghernande@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Tseng', 'firstname': 'Foon Yue', 'email': 'ftseng@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'King', 'firstname': 'Tom', 'email': 'tking@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bondur', 'firstname': 'Gerard', 'email': 'gbondur@classicmodelcars.com', 'jobtitle': 'Sale Manager (EMEA)'}, {'lastname': 'Patterson', 'firstname': 'Mary', 'email': 'mpatterso@classicmodelcars.com', 'jobtitle': 'VP Sales'}, {'lastname': 'Murphy', 'firstname': 'Diane', 'email': 'dmurphy@classicmodelcars.com', 'jobtitle': 'President'}, {'lastname': 'Kato', 'firstname': 'Yoshimi', 'email': 'ykato@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Patterson', 'firstname': 'William', 'email': 'wpatterson@classicmodelcars.com', 'jobtitle': 'Sales Manager (APAC)'}  ... displaying 10 of 23 total bound parameter sets ...  {'lastname': 'Bondur', 'firstname': 'Loui', 'email': 'lbondur@classicmodelcars.com', 'jobtitle': 'Sales Rep'}, {'lastname': 'Bow', 'firstname': 'Anthony', 'email': 'abow@classicmodelcars.com', 'jobtitle': 'Sales Manager (NA)'})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 57728)
[2022-06-20 12:08:22,117] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 12:08:22,173] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 12:27:46,831] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:27:46,852] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:27:46,853] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:27:46,853] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 12:27:46,853] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:27:46,873] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 12:27:46,884] {standard_task_runner.py:52} INFO - Started process 12020 to run task
[2022-06-20 12:27:46,889] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '101', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp31k0jfrv', '--error-file', '/tmp/tmpugttwq5c']
[2022-06-20 12:27:46,889] {standard_task_runner.py:80} INFO - Job 101: Subtask load_DMs
[2022-06-20 12:27:46,970] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 12:27:47,083] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 12:27:47,306] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 12:27:47,328] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T152746, end_date=20220620T152747
[2022-06-20 12:27:47,381] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 12:27:47,440] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 12:39:55,058] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:39:55,080] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:39:55,080] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:39:55,080] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 12:39:55,080] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:39:55,101] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 12:39:55,111] {standard_task_runner.py:52} INFO - Started process 15114 to run task
[2022-06-20 12:39:55,115] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '120', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpnke0pejl', '--error-file', '/tmp/tmpgk1loxdc']
[2022-06-20 12:39:55,116] {standard_task_runner.py:80} INFO - Job 120: Subtask load_DMs
[2022-06-20 12:39:55,196] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 12:39:55,314] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 12:39:55,383] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "customernumber" violates not-null constraint
DETAIL:  Failing row contains (1, null, Auto-Moto Classics Inc., Taylor, Leslie, 6175558428, 16780 Pompton St., Brickhaven, MA, 58339, USA, 23000).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 134, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "customernumber" violates not-null constraint
DETAIL:  Failing row contains (1, null, Auto-Moto Classics Inc., Taylor, Leslie, 6175558428, 16780 Pompton St., Brickhaven, MA, 58339, USA, 23000).

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'contactfirstname': 'Jean', 'phone': '7025551838', 'addressline1': '8489 Strong St.', 'city': 'Las Vegas', 'state': 'NV', 'postalcode': '83030', 'country': 'USA', 'creditlimit': 71800.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'Toys4GrownUps.com', 'contactlastname': 'Young', 'contactfirstname': 'Julie', 'phone': '6265557265', 'addressline1': '78934 Hillside Dr.', 'city': 'Pasadena', 'state': 'CA', 'postalcode': '90003', 'country': 'USA', 'creditlimit': 90700.0}, {'customername': 'Classic Gift Ideas, Inc', 'contactlastname': 'Cervantes', 'contactfirstname': 'Francisca', 'phone': '2155554695', 'addressline1': '782 First Street', 'city': 'Philadelphia', 'state': 'PA', 'postalcode': '71270', 'country': 'USA', 'creditlimit': 81100.0}, {'customername': 'Muscle Machine Inc', 'contactlastname': 'Young', 'contactfirstname': 'Jeff', 'phone': '2125557413', 'addressline1': '4092 Furth Circle', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 138500.0}, {'customername': 'Super Scale Inc.', 'contactlastname': 'Murphy', 'contactfirstname': 'Leslie', 'phone': '2035559545', 'addressline1': '567 North Pendale Street', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 95400.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Gift Depot Inc.', 'contactlastname': 'King', 'contactfirstname': 'Julie', 'phone': '2035552570', 'addressline1': '25593 South Bay Ln.', 'city': 'Bridgewater', 'state': 'CT', 'postalcode': '97562', 'country': 'USA', 'creditlimit': 84300.0}, {'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 12:39:55,405] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T153955, end_date=20220620T153955
[2022-06-20 12:39:55,426] {standard_task_runner.py:92} ERROR - Failed to execute job 120 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "customernumber" violates not-null constraint
DETAIL:  Failing row contains (1, null, Auto-Moto Classics Inc., Taylor, Leslie, 6175558428, 16780 Pompton St., Brickhaven, MA, 58339, USA, 23000).

[SQL: INSERT INTO dm_customers (customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'contactfirstname': 'Jean', 'phone': '7025551838', 'addressline1': '8489 Strong St.', 'city': 'Las Vegas', 'state': 'NV', 'postalcode': '83030', 'country': 'USA', 'creditlimit': 71800.0}, {'customername': 'Land of Toys Inc.', 'contactlastname': 'Lee', 'contactfirstname': 'Kwai', 'phone': '2125557818', 'addressline1': '897 Long Airport Avenue', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 114900.0}, {'customername': 'Toys4GrownUps.com', 'contactlastname': 'Young', 'contactfirstname': 'Julie', 'phone': '6265557265', 'addressline1': '78934 Hillside Dr.', 'city': 'Pasadena', 'state': 'CA', 'postalcode': '90003', 'country': 'USA', 'creditlimit': 90700.0}, {'customername': 'Classic Gift Ideas, Inc', 'contactlastname': 'Cervantes', 'contactfirstname': 'Francisca', 'phone': '2155554695', 'addressline1': '782 First Street', 'city': 'Philadelphia', 'state': 'PA', 'postalcode': '71270', 'country': 'USA', 'creditlimit': 81100.0}, {'customername': 'Muscle Machine Inc', 'contactlastname': 'Young', 'contactfirstname': 'Jeff', 'phone': '2125557413', 'addressline1': '4092 Furth Circle', 'city': 'NYC', 'state': 'NY', 'postalcode': '10022', 'country': 'USA', 'creditlimit': 138500.0}, {'customername': 'Super Scale Inc.', 'contactlastname': 'Murphy', 'contactfirstname': 'Leslie', 'phone': '2035559545', 'addressline1': '567 North Pendale Street', 'city': 'New Haven', 'state': 'CT', 'postalcode': '97823', 'country': 'USA', 'creditlimit': 95400.0}  ... displaying 10 of 48 total bound parameter sets ...  {'customername': 'Gift Depot Inc.', 'contactlastname': 'King', 'contactfirstname': 'Julie', 'phone': '2035552570', 'addressline1': '25593 South Bay Ln.', 'city': 'Bridgewater', 'state': 'CT', 'postalcode': '97562', 'country': 'USA', 'creditlimit': 84300.0}, {'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 15114)
[2022-06-20 12:39:55,447] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 12:39:55,520] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 12:56:58,913] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:56:58,933] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 12:56:58,934] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:56:58,934] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 12:56:58,934] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 12:56:58,955] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 12:56:58,962] {standard_task_runner.py:52} INFO - Started process 18341 to run task
[2022-06-20 12:56:58,968] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '137', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp4hx7815i', '--error-file', '/tmp/tmpt5siekyn']
[2022-06-20 12:56:58,969] {standard_task_runner.py:80} INFO - Job 137: Subtask load_DMs
[2022-06-20 12:56:59,054] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 12:56:59,163] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 12:56:59,391] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 12:56:59,412] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T155658, end_date=20220620T155659
[2022-06-20 12:56:59,461] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 12:56:59,517] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 13:00:12,078] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:00:12,102] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:00:12,102] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:00:12,102] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 13:00:12,102] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:00:12,125] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 13:00:12,134] {standard_task_runner.py:52} INFO - Started process 20244 to run task
[2022-06-20 13:00:12,141] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '156', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp9fb7xxsu', '--error-file', '/tmp/tmpx59j7nba']
[2022-06-20 13:00:12,141] {standard_task_runner.py:80} INFO - Job 156: Subtask load_DMs
[2022-06-20 13:00:12,235] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 13:00:12,357] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 13:00:12,589] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 13:00:12,612] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T160012, end_date=20220620T160012
[2022-06-20 13:00:12,673] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 13:00:12,733] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 13:45:30,687] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:45:30,712] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 13:45:30,713] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:45:30,713] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 13:45:30,713] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 13:45:30,738] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 13:45:30,749] {standard_task_runner.py:52} INFO - Started process 29637 to run task
[2022-06-20 13:45:30,753] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '175', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmplm9bpkc7', '--error-file', '/tmp/tmp0cyn0r5d']
[2022-06-20 13:45:30,754] {standard_task_runner.py:80} INFO - Job 175: Subtask load_DMs
[2022-06-20 13:45:30,836] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 13:45:30,950] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 13:45:31,182] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 13:45:31,207] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T164530, end_date=20220620T164531
[2022-06-20 13:45:31,246] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 13:45:31,306] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:08:06,162] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:08:06,186] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:08:06,186] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:08:06,186] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:08:06,187] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:08:06,208] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:08:06,220] {standard_task_runner.py:52} INFO - Started process 36900 to run task
[2022-06-20 14:08:06,226] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '209', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpmkqz22v4', '--error-file', '/tmp/tmp1yvdplx9']
[2022-06-20 14:08:06,227] {standard_task_runner.py:80} INFO - Job 209: Subtask load_DMs
[2022-06-20 14:08:06,314] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:08:06,426] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:08:06,681] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 14:08:06,706] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T170806, end_date=20220620T170806
[2022-06-20 14:08:06,759] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 14:08:06,825] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:15:28,897] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:15:28,918] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:15:28,918] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:15:28,918] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:15:28,918] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:15:28,939] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:15:28,951] {standard_task_runner.py:52} INFO - Started process 39707 to run task
[2022-06-20 14:15:28,957] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '228', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpt43jmlhn', '--error-file', '/tmp/tmp24z7qpyy']
[2022-06-20 14:15:28,958] {standard_task_runner.py:80} INFO - Job 228: Subtask load_DMs
[2022-06-20 14:15:29,046] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:15:29,157] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:15:29,386] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 14:15:29,410] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T171528, end_date=20220620T171529
[2022-06-20 14:15:29,448] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 14:15:29,517] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:16:33,310] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:16:33,329] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:16:33,329] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:16:33,329] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:16:33,329] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:16:33,348] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:16:33,359] {standard_task_runner.py:52} INFO - Started process 41206 to run task
[2022-06-20 14:16:33,363] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '246', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp0ac86v2i', '--error-file', '/tmp/tmp7mxq9yup']
[2022-06-20 14:16:33,364] {standard_task_runner.py:80} INFO - Job 246: Subtask load_DMs
[2022-06-20 14:16:33,444] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:16:33,556] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:16:33,819] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 14:16:33,857] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T171633, end_date=20220620T171633
[2022-06-20 14:16:33,897] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 14:16:33,974] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:26:58,764] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:26:58,784] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:26:58,784] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:26:58,784] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:26:58,784] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:26:58,805] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:26:58,814] {standard_task_runner.py:52} INFO - Started process 44391 to run task
[2022-06-20 14:26:58,819] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '265', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpff5mml_3', '--error-file', '/tmp/tmp6d77ds6n']
[2022-06-20 14:26:58,820] {standard_task_runner.py:80} INFO - Job 265: Subtask load_DMs
[2022-06-20 14:26:58,899] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:26:59,012] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:26:59,087] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 129, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 201, 'customername': 'UK Collectables, Ltd.', 'contactlastname': 'Devon', 'contactfirstname': 'Elizabeth', 'phone': '(171) 555-2282', 'addressline1': '12, Berkeley Gardens Blvd', 'city': 'Liverpool', 'state': None, 'postalcode': 'WX1 6LT', 'country': 'UK', 'creditlimit': 92700.0}, {'customernumber': 198, 'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customernumber': 186, 'customername': 'Toys of Finland, Co.', 'contactlastname': 'Karttunen', 'contactfirstname': 'Matti', 'phone': '90-224 8555', 'addressline1': 'Keskuskatu 45', 'city': 'Helsinki', 'state': None, 'postalcode': '21240', 'country': 'Finland', 'creditlimit': 96500.0}, {'customernumber': 462, 'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customernumber': 406, 'customername': 'Auto Canal+ Petit', 'contactlastname': 'Perrier', 'contactfirstname': 'Dominique', 'phone': '(1) 47.55.6555', 'addressline1': '25, rue Lauriston', 'city': 'Paris', 'state': None, 'postalcode': '75016', 'country': 'France', 'creditlimit': 95000.0}, {'customernumber': 249, 'customername': 'Amica Models & Co.', 'contactlastname': 'Accorti', 'contactfirstname': 'Paolo ', 'phone': '011-4988555', 'addressline1': 'Via Monte Bianco 34', 'city': 'Torino', 'state': None, 'postalcode': '10100', 'country': 'Italy', 'creditlimit': 113000.0}, {'customernumber': 480, 'customername': 'Kremlin Collectables, Co.', 'contactlastname': 'Semenov', 'contactfirstname': 'Alexander ', 'phone': '+7 812 293 0521', 'addressline1': '2 Pobedy Square', 'city': 'Saint Petersburg', 'state': None, 'postalcode': '196143', 'country': 'Russia', 'creditlimit': 0.0}, {'customernumber': 227, 'customername': 'Heintze Collectables', 'contactlastname': 'Ibsen', 'contactfirstname': 'Palle', 'phone': '86 21 3555', 'addressline1': 'Smagsloget 45', 'city': 'rhus', 'state': None, 'postalcode': '8200', 'country': 'Denmark', 'creditlimit': 120800.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}, {'customernumber': 219, 'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 14:26:59,111] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T172658, end_date=20220620T172659
[2022-06-20 14:26:59,131] {standard_task_runner.py:92} ERROR - Failed to execute job 265 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 201, 'customername': 'UK Collectables, Ltd.', 'contactlastname': 'Devon', 'contactfirstname': 'Elizabeth', 'phone': '(171) 555-2282', 'addressline1': '12, Berkeley Gardens Blvd', 'city': 'Liverpool', 'state': None, 'postalcode': 'WX1 6LT', 'country': 'UK', 'creditlimit': 92700.0}, {'customernumber': 198, 'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customernumber': 186, 'customername': 'Toys of Finland, Co.', 'contactlastname': 'Karttunen', 'contactfirstname': 'Matti', 'phone': '90-224 8555', 'addressline1': 'Keskuskatu 45', 'city': 'Helsinki', 'state': None, 'postalcode': '21240', 'country': 'Finland', 'creditlimit': 96500.0}, {'customernumber': 462, 'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customernumber': 406, 'customername': 'Auto Canal+ Petit', 'contactlastname': 'Perrier', 'contactfirstname': 'Dominique', 'phone': '(1) 47.55.6555', 'addressline1': '25, rue Lauriston', 'city': 'Paris', 'state': None, 'postalcode': '75016', 'country': 'France', 'creditlimit': 95000.0}, {'customernumber': 249, 'customername': 'Amica Models & Co.', 'contactlastname': 'Accorti', 'contactfirstname': 'Paolo ', 'phone': '011-4988555', 'addressline1': 'Via Monte Bianco 34', 'city': 'Torino', 'state': None, 'postalcode': '10100', 'country': 'Italy', 'creditlimit': 113000.0}, {'customernumber': 480, 'customername': 'Kremlin Collectables, Co.', 'contactlastname': 'Semenov', 'contactfirstname': 'Alexander ', 'phone': '+7 812 293 0521', 'addressline1': '2 Pobedy Square', 'city': 'Saint Petersburg', 'state': None, 'postalcode': '196143', 'country': 'Russia', 'creditlimit': 0.0}, {'customernumber': 227, 'customername': 'Heintze Collectables', 'contactlastname': 'Ibsen', 'contactfirstname': 'Palle', 'phone': '86 21 3555', 'addressline1': 'Smagsloget 45', 'city': 'rhus', 'state': None, 'postalcode': '8200', 'country': 'Denmark', 'creditlimit': 120800.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}, {'customernumber': 219, 'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 44391)
[2022-06-20 14:26:59,150] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:26:59,217] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:31:52,561] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:31:52,581] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:31:52,581] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:31:52,581] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:31:52,582] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:31:52,603] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:31:52,615] {standard_task_runner.py:52} INFO - Started process 46654 to run task
[2022-06-20 14:31:52,620] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '282', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpoe3np8v4', '--error-file', '/tmp/tmp7pwyklex']
[2022-06-20 14:31:52,621] {standard_task_runner.py:80} INFO - Job 282: Subtask load_DMs
[2022-06-20 14:31:52,707] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:31:52,819] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:31:52,901] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 129, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 201, 'customername': 'UK Collectables, Ltd.', 'contactlastname': 'Devon', 'contactfirstname': 'Elizabeth', 'phone': '(171) 555-2282', 'addressline1': '12, Berkeley Gardens Blvd', 'city': 'Liverpool', 'state': None, 'postalcode': 'WX1 6LT', 'country': 'UK', 'creditlimit': 92700.0}, {'customernumber': 198, 'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customernumber': 186, 'customername': 'Toys of Finland, Co.', 'contactlastname': 'Karttunen', 'contactfirstname': 'Matti', 'phone': '90-224 8555', 'addressline1': 'Keskuskatu 45', 'city': 'Helsinki', 'state': None, 'postalcode': '21240', 'country': 'Finland', 'creditlimit': 96500.0}, {'customernumber': 462, 'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customernumber': 406, 'customername': 'Auto Canal+ Petit', 'contactlastname': 'Perrier', 'contactfirstname': 'Dominique', 'phone': '(1) 47.55.6555', 'addressline1': '25, rue Lauriston', 'city': 'Paris', 'state': None, 'postalcode': '75016', 'country': 'France', 'creditlimit': 95000.0}, {'customernumber': 249, 'customername': 'Amica Models & Co.', 'contactlastname': 'Accorti', 'contactfirstname': 'Paolo ', 'phone': '011-4988555', 'addressline1': 'Via Monte Bianco 34', 'city': 'Torino', 'state': None, 'postalcode': '10100', 'country': 'Italy', 'creditlimit': 113000.0}, {'customernumber': 480, 'customername': 'Kremlin Collectables, Co.', 'contactlastname': 'Semenov', 'contactfirstname': 'Alexander ', 'phone': '+7 812 293 0521', 'addressline1': '2 Pobedy Square', 'city': 'Saint Petersburg', 'state': None, 'postalcode': '196143', 'country': 'Russia', 'creditlimit': 0.0}, {'customernumber': 227, 'customername': 'Heintze Collectables', 'contactlastname': 'Ibsen', 'contactfirstname': 'Palle', 'phone': '86 21 3555', 'addressline1': 'Smagsloget 45', 'city': 'rhus', 'state': None, 'postalcode': '8200', 'country': 'Denmark', 'creditlimit': 120800.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}, {'customernumber': 219, 'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 14:31:52,924] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T173152, end_date=20220620T173152
[2022-06-20 14:31:52,947] {standard_task_runner.py:92} ERROR - Failed to execute job 282 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 201, 'customername': 'UK Collectables, Ltd.', 'contactlastname': 'Devon', 'contactfirstname': 'Elizabeth', 'phone': '(171) 555-2282', 'addressline1': '12, Berkeley Gardens Blvd', 'city': 'Liverpool', 'state': None, 'postalcode': 'WX1 6LT', 'country': 'UK', 'creditlimit': 92700.0}, {'customernumber': 198, 'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customernumber': 186, 'customername': 'Toys of Finland, Co.', 'contactlastname': 'Karttunen', 'contactfirstname': 'Matti', 'phone': '90-224 8555', 'addressline1': 'Keskuskatu 45', 'city': 'Helsinki', 'state': None, 'postalcode': '21240', 'country': 'Finland', 'creditlimit': 96500.0}, {'customernumber': 462, 'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customernumber': 406, 'customername': 'Auto Canal+ Petit', 'contactlastname': 'Perrier', 'contactfirstname': 'Dominique', 'phone': '(1) 47.55.6555', 'addressline1': '25, rue Lauriston', 'city': 'Paris', 'state': None, 'postalcode': '75016', 'country': 'France', 'creditlimit': 95000.0}, {'customernumber': 249, 'customername': 'Amica Models & Co.', 'contactlastname': 'Accorti', 'contactfirstname': 'Paolo ', 'phone': '011-4988555', 'addressline1': 'Via Monte Bianco 34', 'city': 'Torino', 'state': None, 'postalcode': '10100', 'country': 'Italy', 'creditlimit': 113000.0}, {'customernumber': 480, 'customername': 'Kremlin Collectables, Co.', 'contactlastname': 'Semenov', 'contactfirstname': 'Alexander ', 'phone': '+7 812 293 0521', 'addressline1': '2 Pobedy Square', 'city': 'Saint Petersburg', 'state': None, 'postalcode': '196143', 'country': 'Russia', 'creditlimit': 0.0}, {'customernumber': 227, 'customername': 'Heintze Collectables', 'contactlastname': 'Ibsen', 'contactfirstname': 'Palle', 'phone': '86 21 3555', 'addressline1': 'Smagsloget 45', 'city': 'rhus', 'state': None, 'postalcode': '8200', 'country': 'Denmark', 'creditlimit': 120800.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}, {'customernumber': 219, 'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 46654)
[2022-06-20 14:31:52,992] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:31:53,058] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:34:20,642] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:34:20,662] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:34:20,662] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:34:20,662] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:34:20,662] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:34:20,684] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:34:20,695] {standard_task_runner.py:52} INFO - Started process 48448 to run task
[2022-06-20 14:34:20,701] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '298', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmps_tugmbn', '--error-file', '/tmp/tmprl02v_xz']
[2022-06-20 14:34:20,702] {standard_task_runner.py:80} INFO - Job 298: Subtask load_DMs
[2022-06-20 14:34:20,787] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:34:20,888] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:34:20,970] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 133, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 201, 'customername': 'UK Collectables, Ltd.', 'contactlastname': 'Devon', 'contactfirstname': 'Elizabeth', 'phone': '(171) 555-2282', 'addressline1': '12, Berkeley Gardens Blvd', 'city': 'Liverpool', 'state': None, 'postalcode': 'WX1 6LT', 'country': 'UK', 'creditlimit': 92700.0}, {'customernumber': 198, 'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customernumber': 186, 'customername': 'Toys of Finland, Co.', 'contactlastname': 'Karttunen', 'contactfirstname': 'Matti', 'phone': '90-224 8555', 'addressline1': 'Keskuskatu 45', 'city': 'Helsinki', 'state': None, 'postalcode': '21240', 'country': 'Finland', 'creditlimit': 96500.0}, {'customernumber': 462, 'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customernumber': 406, 'customername': 'Auto Canal+ Petit', 'contactlastname': 'Perrier', 'contactfirstname': 'Dominique', 'phone': '(1) 47.55.6555', 'addressline1': '25, rue Lauriston', 'city': 'Paris', 'state': None, 'postalcode': '75016', 'country': 'France', 'creditlimit': 95000.0}, {'customernumber': 249, 'customername': 'Amica Models & Co.', 'contactlastname': 'Accorti', 'contactfirstname': 'Paolo ', 'phone': '011-4988555', 'addressline1': 'Via Monte Bianco 34', 'city': 'Torino', 'state': None, 'postalcode': '10100', 'country': 'Italy', 'creditlimit': 113000.0}, {'customernumber': 480, 'customername': 'Kremlin Collectables, Co.', 'contactlastname': 'Semenov', 'contactfirstname': 'Alexander ', 'phone': '+7 812 293 0521', 'addressline1': '2 Pobedy Square', 'city': 'Saint Petersburg', 'state': None, 'postalcode': '196143', 'country': 'Russia', 'creditlimit': 0.0}, {'customernumber': 227, 'customername': 'Heintze Collectables', 'contactlastname': 'Ibsen', 'contactfirstname': 'Palle', 'phone': '86 21 3555', 'addressline1': 'Smagsloget 45', 'city': 'rhus', 'state': None, 'postalcode': '8200', 'country': 'Denmark', 'creditlimit': 120800.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}, {'customernumber': 219, 'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 14:34:20,994] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T173420, end_date=20220620T173420
[2022-06-20 14:34:21,015] {standard_task_runner.py:92} ERROR - Failed to execute job 298 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 201, UK Collectables, Ltd., Devon, Elizabeth, (171) 555-2282, 12, Berkeley Gardens Blvd, Liverpool, null, WX1 6LT, UK, 92700).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 201, 'customername': 'UK Collectables, Ltd.', 'contactlastname': 'Devon', 'contactfirstname': 'Elizabeth', 'phone': '(171) 555-2282', 'addressline1': '12, Berkeley Gardens Blvd', 'city': 'Liverpool', 'state': None, 'postalcode': 'WX1 6LT', 'country': 'UK', 'creditlimit': 92700.0}, {'customernumber': 198, 'customername': 'Auto-Moto Classics Inc.', 'contactlastname': 'Taylor', 'contactfirstname': 'Leslie', 'phone': '6175558428', 'addressline1': '16780 Pompton St.', 'city': 'Brickhaven', 'state': 'MA', 'postalcode': '58339', 'country': 'USA', 'creditlimit': 23000.0}, {'customernumber': 186, 'customername': 'Toys of Finland, Co.', 'contactlastname': 'Karttunen', 'contactfirstname': 'Matti', 'phone': '90-224 8555', 'addressline1': 'Keskuskatu 45', 'city': 'Helsinki', 'state': None, 'postalcode': '21240', 'country': 'Finland', 'creditlimit': 96500.0}, {'customernumber': 462, 'customername': 'FunGiftIdeas.com', 'contactlastname': 'Benitez', 'contactfirstname': 'Violeta', 'phone': '5085552555', 'addressline1': '1785 First Street', 'city': 'New Bedford', 'state': 'MA', 'postalcode': '50553', 'country': 'USA', 'creditlimit': 85800.0}, {'customernumber': 406, 'customername': 'Auto Canal+ Petit', 'contactlastname': 'Perrier', 'contactfirstname': 'Dominique', 'phone': '(1) 47.55.6555', 'addressline1': '25, rue Lauriston', 'city': 'Paris', 'state': None, 'postalcode': '75016', 'country': 'France', 'creditlimit': 95000.0}, {'customernumber': 249, 'customername': 'Amica Models & Co.', 'contactlastname': 'Accorti', 'contactfirstname': 'Paolo ', 'phone': '011-4988555', 'addressline1': 'Via Monte Bianco 34', 'city': 'Torino', 'state': None, 'postalcode': '10100', 'country': 'Italy', 'creditlimit': 113000.0}, {'customernumber': 480, 'customername': 'Kremlin Collectables, Co.', 'contactlastname': 'Semenov', 'contactfirstname': 'Alexander ', 'phone': '+7 812 293 0521', 'addressline1': '2 Pobedy Square', 'city': 'Saint Petersburg', 'state': None, 'postalcode': '196143', 'country': 'Russia', 'creditlimit': 0.0}, {'customernumber': 227, 'customername': 'Heintze Collectables', 'contactlastname': 'Ibsen', 'contactfirstname': 'Palle', 'phone': '86 21 3555', 'addressline1': 'Smagsloget 45', 'city': 'rhus', 'state': None, 'postalcode': '8200', 'country': 'Denmark', 'creditlimit': 120800.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}, {'customernumber': 219, 'customername': 'Boards & Toys Co.', 'contactlastname': 'Young', 'contactfirstname': 'Mary', 'phone': '3105552373', 'addressline1': '4097 Douglas Av.', 'city': 'Glendale', 'state': 'CA', 'postalcode': '92561', 'country': 'USA', 'creditlimit': 11000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 48448)
[2022-06-20 14:34:21,033] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:34:21,112] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:38:02,035] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:38:02,056] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:38:02,057] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:38:02,057] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:38:02,057] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:38:02,078] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:38:02,088] {standard_task_runner.py:52} INFO - Started process 51135 to run task
[2022-06-20 14:38:02,095] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '315', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpghcike16', '--error-file', '/tmp/tmpa7bgp_f8']
[2022-06-20 14:38:02,096] {standard_task_runner.py:80} INFO - Job 315: Subtask load_DMs
[2022-06-20 14:38:02,207] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:38:02,393] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:38:02,485] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 103, Atelier graphique, Schmitt, Carine , 40.32.2555, 54, rue Royale, Nantes, null, 44000, France, 21000).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 133, in load_DMs
    df_cost.to_sql('dm_customers', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 103, Atelier graphique, Schmitt, Carine , 40.32.2555, 54, rue Royale, Nantes, null, 44000, France, 21000).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 103, 'customername': 'Atelier graphique', 'contactlastname': 'Schmitt', 'contactfirstname': 'Carine ', 'phone': '40.32.2555', 'addressline1': '54, rue Royale', 'city': 'Nantes', 'state': None, 'postalcode': '44000', 'country': 'France', 'creditlimit': 21000.0}, {'customernumber': 112, 'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'contactfirstname': 'Jean', 'phone': '7025551838', 'addressline1': '8489 Strong St.', 'city': 'Las Vegas', 'state': 'NV', 'postalcode': '83030', 'country': 'USA', 'creditlimit': 71800.0}, {'customernumber': 114, 'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'contactfirstname': 'Peter', 'phone': '03 9520 4555', 'addressline1': '636 St Kilda Road', 'city': 'Melbourne', 'state': 'Victoria', 'postalcode': '3004', 'country': 'Australia', 'creditlimit': 117300.0}, {'customernumber': 119, 'customername': 'La Rochelle Gifts', 'contactlastname': 'Labrune', 'contactfirstname': 'Janine ', 'phone': '40.67.8555', 'addressline1': '67, rue des Cinquante Otages', 'city': 'Nantes', 'state': None, 'postalcode': '44000', 'country': 'France', 'creditlimit': 118200.0}, {'customernumber': 121, 'customername': 'Baane Mini Imports', 'contactlastname': 'Bergulfsen', 'contactfirstname': 'Jonas ', 'phone': '07-98 9555', 'addressline1': 'Erling Skakkes gate 78', 'city': 'Stavern', 'state': None, 'postalcode': '4110', 'country': 'Norway', 'creditlimit': 81700.0}, {'customernumber': 124, 'customername': 'Mini Gifts Distributors Ltd.', 'contactlastname': 'Nelson', 'contactfirstname': 'Susan', 'phone': '4155551450', 'addressline1': '5677 Strong St.', 'city': 'San Rafael', 'state': 'CA', 'postalcode': '97562', 'country': 'USA', 'creditlimit': 210500.0}, {'customernumber': 125, 'customername': 'Havel & Zbyszek Co', 'contactlastname': 'Piestrzeniewicz', 'contactfirstname': 'Zbyszek ', 'phone': '(26) 642-7555', 'addressline1': 'ul. Filtrowa 68', 'city': 'Warszawa', 'state': None, 'postalcode': '01-012', 'country': 'Poland', 'creditlimit': 0.0}, {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 495, 'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customernumber': 496, 'customername': 'Kellys Gift Shop', 'contactlastname': 'Snowden', 'contactfirstname': 'Tony', 'phone': '+64 9 5555500', 'addressline1': 'Arenales 1938 3A', 'city': 'Auckland  ', 'state': None, 'postalcode': None, 'country': 'New Zealand', 'creditlimit': 110000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 14:38:02,513] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T173802, end_date=20220620T173802
[2022-06-20 14:38:02,536] {standard_task_runner.py:92} ERROR - Failed to execute job 315 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "state" violates not-null constraint
DETAIL:  Failing row contains (1, 103, Atelier graphique, Schmitt, Carine , 40.32.2555, 54, rue Royale, Nantes, null, 44000, France, 21000).

[SQL: INSERT INTO dm_customers (customernumber, customername, contactlastname, contactfirstname, phone, addressline1, city, state, postalcode, country, creditlimit) VALUES (%(customernumber)s, %(customername)s, %(contactlastname)s, %(contactfirstname)s, %(phone)s, %(addressline1)s, %(city)s, %(state)s, %(postalcode)s, %(country)s, %(creditlimit)s)]
[parameters: ({'customernumber': 103, 'customername': 'Atelier graphique', 'contactlastname': 'Schmitt', 'contactfirstname': 'Carine ', 'phone': '40.32.2555', 'addressline1': '54, rue Royale', 'city': 'Nantes', 'state': None, 'postalcode': '44000', 'country': 'France', 'creditlimit': 21000.0}, {'customernumber': 112, 'customername': 'Signal Gift Stores', 'contactlastname': 'King', 'contactfirstname': 'Jean', 'phone': '7025551838', 'addressline1': '8489 Strong St.', 'city': 'Las Vegas', 'state': 'NV', 'postalcode': '83030', 'country': 'USA', 'creditlimit': 71800.0}, {'customernumber': 114, 'customername': 'Australian Collectors, Co.', 'contactlastname': 'Ferguson', 'contactfirstname': 'Peter', 'phone': '03 9520 4555', 'addressline1': '636 St Kilda Road', 'city': 'Melbourne', 'state': 'Victoria', 'postalcode': '3004', 'country': 'Australia', 'creditlimit': 117300.0}, {'customernumber': 119, 'customername': 'La Rochelle Gifts', 'contactlastname': 'Labrune', 'contactfirstname': 'Janine ', 'phone': '40.67.8555', 'addressline1': '67, rue des Cinquante Otages', 'city': 'Nantes', 'state': None, 'postalcode': '44000', 'country': 'France', 'creditlimit': 118200.0}, {'customernumber': 121, 'customername': 'Baane Mini Imports', 'contactlastname': 'Bergulfsen', 'contactfirstname': 'Jonas ', 'phone': '07-98 9555', 'addressline1': 'Erling Skakkes gate 78', 'city': 'Stavern', 'state': None, 'postalcode': '4110', 'country': 'Norway', 'creditlimit': 81700.0}, {'customernumber': 124, 'customername': 'Mini Gifts Distributors Ltd.', 'contactlastname': 'Nelson', 'contactfirstname': 'Susan', 'phone': '4155551450', 'addressline1': '5677 Strong St.', 'city': 'San Rafael', 'state': 'CA', 'postalcode': '97562', 'country': 'USA', 'creditlimit': 210500.0}, {'customernumber': 125, 'customername': 'Havel & Zbyszek Co', 'contactlastname': 'Piestrzeniewicz', 'contactfirstname': 'Zbyszek ', 'phone': '(26) 642-7555', 'addressline1': 'ul. Filtrowa 68', 'city': 'Warszawa', 'state': None, 'postalcode': '01-012', 'country': 'Poland', 'creditlimit': 0.0}, {'customernumber': 128, 'customername': 'Blauer See Auto, Co.', 'contactlastname': 'Keitel', 'contactfirstname': 'Roland', 'phone': '+49 69 66 90 2555', 'addressline1': 'Lyonerstr. 34', 'city': 'Frankfurt', 'state': None, 'postalcode': '60528', 'country': 'Germany', 'creditlimit': 59700.0}  ... displaying 10 of 122 total bound parameter sets ...  {'customernumber': 495, 'customername': 'Diecast Collectables', 'contactlastname': 'Franco', 'contactfirstname': 'Valarie', 'phone': '6175552555', 'addressline1': '6251 Ingle Ln.', 'city': 'Boston', 'state': 'MA', 'postalcode': '51003', 'country': 'USA', 'creditlimit': 85100.0}, {'customernumber': 496, 'customername': 'Kellys Gift Shop', 'contactlastname': 'Snowden', 'contactfirstname': 'Tony', 'phone': '+64 9 5555500', 'addressline1': 'Arenales 1938 3A', 'city': 'Auckland  ', 'state': None, 'postalcode': None, 'country': 'New Zealand', 'creditlimit': 110000.0})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 51135)
[2022-06-20 14:38:02,593] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 14:38:02,663] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 14:46:45,337] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:46:45,356] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 14:46:45,356] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:46:45,356] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 14:46:45,356] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 14:46:45,375] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 14:46:45,384] {standard_task_runner.py:52} INFO - Started process 54629 to run task
[2022-06-20 14:46:45,389] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '332', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp217fpljc', '--error-file', '/tmp/tmpg6v0kktk']
[2022-06-20 14:46:45,390] {standard_task_runner.py:80} INFO - Job 332: Subtask load_DMs
[2022-06-20 14:46:45,469] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 14:46:45,580] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 14:46:45,821] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 14:46:45,843] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T174645, end_date=20220620T174645
[2022-06-20 14:46:45,882] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 14:46:45,949] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:33:28,095] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:33:28,116] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:33:28,117] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:33:28,117] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:33:28,117] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:33:28,138] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:33:28,147] {standard_task_runner.py:52} INFO - Started process 61109 to run task
[2022-06-20 15:33:28,153] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '350', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpwp3lr5c_', '--error-file', '/tmp/tmpxl5aze4h']
[2022-06-20 15:33:28,153] {standard_task_runner.py:80} INFO - Job 350: Subtask load_DMs
[2022-06-20 15:33:28,239] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:33:28,349] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:33:28,464] {taskinstance.py:1890} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.NotNullViolation: null value in column "shippeddate" violates not-null constraint
DETAIL:  Failing row contains (1, 2004-06-24, 2004-07-01, null).


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/home/uiliam/airflow/dags/sales.py", line 134, in load_DMs
    df_date.to_sql('dm_time', engine, index=False, if_exists='append')
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/core/generic.py", line 2951, in to_sql
    return sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 697, in to_sql
    return pandas_sql.to_sql(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1739, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1332, in insert_records
    raise err
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 1322, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 950, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/pandas/io/sql.py", line 857, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1200, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/sql/elements.py", line 313, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1389, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1748, in _execute_context
    self._handle_dbapi_exception(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1929, in _handle_dbapi_exception
    util.raise_(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1685, in _execute_context
    self.dialect.do_executemany(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 903, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/uiliam/sandbox/lib/python3.9/site-packages/psycopg2/extras.py", line 1270, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "shippeddate" violates not-null constraint
DETAIL:  Failing row contains (1, 2004-06-24, 2004-07-01, null).

[SQL: INSERT INTO dm_time (orderdate, requireddate, shippeddate) VALUES (%(orderdate)s, %(requireddate)s, %(shippeddate)s)]
[parameters: ({'orderdate': datetime.date(2004, 6, 24), 'requireddate': datetime.date(2004, 7, 1), 'shippeddate': None}, {'orderdate': datetime.date(2003, 11, 6), 'requireddate': datetime.date(2003, 11, 15), 'shippeddate': datetime.date(2003, 11, 10)}, {'orderdate': datetime.date(2003, 11, 20), 'requireddate': datetime.date(2003, 11, 29), 'shippeddate': datetime.date(2003, 11, 25)}, {'orderdate': datetime.date(2005, 5, 9), 'requireddate': datetime.date(2005, 5, 20), 'shippeddate': datetime.date(2005, 5, 12)}, {'orderdate': datetime.date(2004, 8, 20), 'requireddate': datetime.date(2004, 8, 26), 'shippeddate': datetime.date(2004, 8, 22)}, {'orderdate': datetime.date(2004, 5, 26), 'requireddate': datetime.date(2004, 6, 4), 'shippeddate': datetime.date(2004, 5, 29)}, {'orderdate': datetime.date(2004, 12, 2), 'requireddate': datetime.date(2004, 12, 8), 'shippeddate': datetime.date(2004, 12, 5)}, {'orderdate': datetime.date(2003, 11, 18), 'requireddate': datetime.date(2003, 11, 25), 'shippeddate': datetime.date(2003, 11, 24)}  ... displaying 10 of 323 total bound parameter sets ...  {'orderdate': datetime.date(2004, 2, 20), 'requireddate': datetime.date(2004, 2, 29), 'shippeddate': datetime.date(2004, 2, 24)}, {'orderdate': datetime.date(2003, 6, 3), 'requireddate': datetime.date(2003, 6, 9), 'shippeddate': datetime.date(2003, 6, 6)})]
(Background on this error at: http://sqlalche.me/e/14/gkpj)
[2022-06-20 15:33:28,488] {taskinstance.py:1396} INFO - Marking task as FAILED. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T183328, end_date=20220620T183328
[2022-06-20 15:33:28,509] {standard_task_runner.py:92} ERROR - Failed to execute job 350 for task load_DMs ((psycopg2.errors.NotNullViolation) null value in column "shippeddate" violates not-null constraint
DETAIL:  Failing row contains (1, 2004-06-24, 2004-07-01, null).

[SQL: INSERT INTO dm_time (orderdate, requireddate, shippeddate) VALUES (%(orderdate)s, %(requireddate)s, %(shippeddate)s)]
[parameters: ({'orderdate': datetime.date(2004, 6, 24), 'requireddate': datetime.date(2004, 7, 1), 'shippeddate': None}, {'orderdate': datetime.date(2003, 11, 6), 'requireddate': datetime.date(2003, 11, 15), 'shippeddate': datetime.date(2003, 11, 10)}, {'orderdate': datetime.date(2003, 11, 20), 'requireddate': datetime.date(2003, 11, 29), 'shippeddate': datetime.date(2003, 11, 25)}, {'orderdate': datetime.date(2005, 5, 9), 'requireddate': datetime.date(2005, 5, 20), 'shippeddate': datetime.date(2005, 5, 12)}, {'orderdate': datetime.date(2004, 8, 20), 'requireddate': datetime.date(2004, 8, 26), 'shippeddate': datetime.date(2004, 8, 22)}, {'orderdate': datetime.date(2004, 5, 26), 'requireddate': datetime.date(2004, 6, 4), 'shippeddate': datetime.date(2004, 5, 29)}, {'orderdate': datetime.date(2004, 12, 2), 'requireddate': datetime.date(2004, 12, 8), 'shippeddate': datetime.date(2004, 12, 5)}, {'orderdate': datetime.date(2003, 11, 18), 'requireddate': datetime.date(2003, 11, 25), 'shippeddate': datetime.date(2003, 11, 24)}  ... displaying 10 of 323 total bound parameter sets ...  {'orderdate': datetime.date(2004, 2, 20), 'requireddate': datetime.date(2004, 2, 29), 'shippeddate': datetime.date(2004, 2, 24)}, {'orderdate': datetime.date(2003, 6, 3), 'requireddate': datetime.date(2003, 6, 9), 'shippeddate': datetime.date(2003, 6, 6)})]
(Background on this error at: http://sqlalche.me/e/14/gkpj); 61109)
[2022-06-20 15:33:28,564] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-06-20 15:33:28,635] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:35:34,285] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:35:34,307] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:35:34,307] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:35:34,307] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:35:34,307] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:35:34,329] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:35:34,339] {standard_task_runner.py:52} INFO - Started process 62747 to run task
[2022-06-20 15:35:34,346] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '366', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmph41vz6fy', '--error-file', '/tmp/tmpppnb_s0l']
[2022-06-20 15:35:34,346] {standard_task_runner.py:80} INFO - Job 366: Subtask load_DMs
[2022-06-20 15:35:34,432] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:35:34,546] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:35:34,802] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 15:35:34,826] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T183534, end_date=20220620T183534
[2022-06-20 15:35:34,878] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 15:35:34,953] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:41:57,143] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:41:57,162] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:41:57,163] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:41:57,163] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:41:57,163] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:41:57,183] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:41:57,195] {standard_task_runner.py:52} INFO - Started process 65214 to run task
[2022-06-20 15:41:57,201] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '384', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpxgay1kfo', '--error-file', '/tmp/tmpz49py8i0']
[2022-06-20 15:41:57,201] {standard_task_runner.py:80} INFO - Job 384: Subtask load_DMs
[2022-06-20 15:41:57,286] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:41:57,402] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:41:57,644] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 15:41:57,672] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T184157, end_date=20220620T184157
[2022-06-20 15:41:57,733] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 15:41:57,809] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 15:51:35,126] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:51:35,146] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 15:51:35,146] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:51:35,146] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 15:51:35,146] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 15:51:35,166] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 15:51:35,173] {standard_task_runner.py:52} INFO - Started process 67868 to run task
[2022-06-20 15:51:35,178] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '402', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp3noe99h4', '--error-file', '/tmp/tmpqxfcgu02']
[2022-06-20 15:51:35,179] {standard_task_runner.py:80} INFO - Job 402: Subtask load_DMs
[2022-06-20 15:51:35,266] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 15:51:35,378] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 15:51:35,634] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 15:51:35,659] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T185135, end_date=20220620T185135
[2022-06-20 15:51:35,712] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 15:51:35,788] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:09:31,649] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:09:31,668] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:09:31,668] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:09:31,669] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:09:31,669] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:09:31,689] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:09:31,699] {standard_task_runner.py:52} INFO - Started process 74893 to run task
[2022-06-20 16:09:31,703] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '426', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpdfx1ctin', '--error-file', '/tmp/tmpvxctal3r']
[2022-06-20 16:09:31,703] {standard_task_runner.py:80} INFO - Job 426: Subtask load_DMs
[2022-06-20 16:09:31,785] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:09:31,897] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:09:32,152] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:09:32,174] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T190931, end_date=20220620T190932
[2022-06-20 16:09:32,236] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:09:32,316] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:13:54,614] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:13:54,633] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:13:54,634] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:13:54,634] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:13:54,634] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:13:54,659] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:13:54,673] {standard_task_runner.py:52} INFO - Started process 76893 to run task
[2022-06-20 16:13:54,680] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '444', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmp05g44e8f', '--error-file', '/tmp/tmp7ours9sd']
[2022-06-20 16:13:54,680] {standard_task_runner.py:80} INFO - Job 444: Subtask load_DMs
[2022-06-20 16:13:54,766] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:13:54,884] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:13:55,160] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:13:55,182] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T191354, end_date=20220620T191355
[2022-06-20 16:13:55,252] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:13:55,317] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:16:07,681] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:16:07,703] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:16:07,703] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:16:07,703] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:16:07,703] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:16:07,724] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:16:07,736] {standard_task_runner.py:52} INFO - Started process 79282 to run task
[2022-06-20 16:16:07,742] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '471', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpqd1c7fc4', '--error-file', '/tmp/tmpfdhhk117']
[2022-06-20 16:16:07,742] {standard_task_runner.py:80} INFO - Job 471: Subtask load_DMs
[2022-06-20 16:16:07,830] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:16:07,942] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:16:08,180] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:16:08,202] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T191607, end_date=20220620T191608
[2022-06-20 16:16:08,234] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:16:08,310] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:29:44,755] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:29:44,777] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:29:44,777] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:29:44,777] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:29:44,777] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:29:44,797] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:29:44,807] {standard_task_runner.py:52} INFO - Started process 82332 to run task
[2022-06-20 16:29:44,813] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '489', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpg6_xdr3l', '--error-file', '/tmp/tmpsu4_ditc']
[2022-06-20 16:29:44,813] {standard_task_runner.py:80} INFO - Job 489: Subtask load_DMs
[2022-06-20 16:29:44,895] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:29:45,011] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:29:45,266] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:29:45,289] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T192944, end_date=20220620T192945
[2022-06-20 16:29:45,345] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:29:45,423] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-06-20 16:32:00,646] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:32:00,667] {taskinstance.py:1160} INFO - Dependencies all met for <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [queued]>
[2022-06-20 16:32:00,667] {taskinstance.py:1357} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:32:00,667] {taskinstance.py:1358} INFO - Starting attempt 1 of 1
[2022-06-20 16:32:00,667] {taskinstance.py:1359} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 16:32:00,694] {taskinstance.py:1378} INFO - Executing <Task(PythonOperator): load_DMs> on 2022-06-19 00:00:00+00:00
[2022-06-20 16:32:00,704] {standard_task_runner.py:52} INFO - Started process 84190 to run task
[2022-06-20 16:32:00,712] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales', 'load_DMs', 'scheduled__2022-06-19T00:00:00+00:00', '--job-id', '507', '--raw', '--subdir', 'DAGS_FOLDER/sales.py', '--cfg-path', '/tmp/tmpzfooghsw', '--error-file', '/tmp/tmp886kec7r']
[2022-06-20 16:32:00,713] {standard_task_runner.py:80} INFO - Job 507: Subtask load_DMs
[2022-06-20 16:32:00,811] {task_command.py:370} INFO - Running <TaskInstance: sales.load_DMs scheduled__2022-06-19T00:00:00+00:00 [running]> on host uiliam-Vostro-15-3515
[2022-06-20 16:32:00,922] {taskinstance.py:1570} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=airflow
AIRFLOW_CTX_DAG_ID=sales
AIRFLOW_CTX_TASK_ID=load_DMs
AIRFLOW_CTX_EXECUTION_DATE=2022-06-19T00:00:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-19T00:00:00+00:00
[2022-06-20 16:32:01,175] {python.py:173} INFO - Done. Returned value was: None
[2022-06-20 16:32:01,197] {taskinstance.py:1396} INFO - Marking task as SUCCESS. dag_id=sales, task_id=load_DMs, execution_date=20220619T000000, start_date=20220620T193200, end_date=20220620T193201
[2022-06-20 16:32:01,244] {local_task_job.py:156} INFO - Task exited with return code 0
[2022-06-20 16:32:01,328] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
